<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The BBS Signature Scheme</title>
<meta content="Tobias Looker" name="author">
<meta content="Vasilis Kalos" name="author">
<meta content="Andrew Whitehead" name="author">
<meta content="Mike Lodder" name="author">
<meta content="
       BBS is a digital signature scheme categorized as a form of short group signature that supports several unique properties. Notably, the scheme supports signing multiple messages whilst producing a single output digital signature. Through this capability, the possessor of a signature is able to generate proofs that selectively disclose subsets of the originally signed set of messages, whilst preserving the verifiable authenticity and integrity of the messages. Furthermore, these proofs are said to be zero-knowledge in nature as they do not reveal the underlying signature; instead, what they reveal is a proof of knowledge of the undisclosed signature. 
    " name="description">
<meta content="xml2rfc 3.18.0" name="generator">
<meta content="draft-irtf-cfrg-bbs-signatures-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.18.0
    Python 3.11.5
    ConfigArgParse 1.5.3
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 3.10.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.31.0
    setuptools 67.7.2
    six 1.16.0
    wcwidth 0.2.6
-->
<link href="draft-irtf-cfrg-bbs-signatures.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">The BBS Signature Scheme</td>
<td class="right">September 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Looker, et al.</td>
<td class="center">Expires 29 March 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CFRG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-irtf-cfrg-bbs-signatures-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-09-26" class="published">26 September 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-03-29">29 March 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Looker</div>
<div class="org">MATTR</div>
</div>
<div class="author">
      <div class="author-name">V. Kalos</div>
<div class="org">MATTR</div>
</div>
<div class="author">
      <div class="author-name">A. Whitehead</div>
<div class="org">Portage</div>
</div>
<div class="author">
      <div class="author-name">M. Lodder</div>
<div class="org">CryptID</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The BBS Signature Scheme</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">BBS is a digital signature scheme categorized as a form of short group signature that supports several unique properties. Notably, the scheme supports signing multiple messages whilst producing a single output digital signature. Through this capability, the possessor of a signature is able to generate proofs that selectively disclose subsets of the originally signed set of messages, whilst preserving the verifiable authenticity and integrity of the messages. Furthermore, these proofs are said to be zero-knowledge in nature as they do not reveal the underlying signature; instead, what they reveal is a proof of knowledge of the undisclosed signature.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/decentralized-identity/bbs-signature">https://github.com/decentralized-identity/bbs-signature</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 29 March 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-notation" class="internal xref">Notation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-document-organization" class="internal xref">Document Organization</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions" class="internal xref">Conventions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-scheme-definition" class="internal xref">Scheme Definition</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-parameters" class="internal xref">Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-considerations" class="internal xref">Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-subgroup-selection" class="internal xref">Subgroup Selection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-generators" class="internal xref">Generators</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="auto internal xref">3.2.3</a>.  <a href="#name-serializing-to-octets" class="internal xref">Serializing to Octets</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-key-generation-operations" class="internal xref">Key Generation Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-secret-key" class="internal xref">Secret Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-public-key" class="internal xref">Public Key</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-core-operations" class="internal xref">Core Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-signature-generation-sign" class="internal xref">Signature Generation (Sign)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="auto internal xref">3.4.2</a>.  <a href="#name-signature-verification-veri" class="internal xref">Signature Verification (Verify)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="auto internal xref">3.4.3</a>.  <a href="#name-proof-generation-proofgen" class="internal xref">Proof Generation (ProofGen)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.4">
                    <p id="section-toc.1-1.3.2.4.2.4.1"><a href="#section-3.4.4" class="auto internal xref">3.4.4</a>.  <a href="#name-proof-verification-proofver" class="internal xref">Proof Verification (ProofVerify)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-proof-protocol-subroutines" class="internal xref">Proof Protocol Subroutines</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="auto internal xref">3.5.1</a>.  <a href="#name-proof-initialization" class="internal xref">Proof Initialization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="auto internal xref">3.5.2</a>.  <a href="#name-proof-finalization" class="internal xref">Proof Finalization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.3">
                    <p id="section-toc.1-1.3.2.5.2.3.1"><a href="#section-3.5.3" class="auto internal xref">3.5.3</a>.  <a href="#name-proof-verification-initiali" class="internal xref">Proof Verification Initialization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.4">
                    <p id="section-toc.1-1.3.2.5.2.4.1"><a href="#section-3.5.4" class="auto internal xref">3.5.4</a>.  <a href="#name-challenge-calculation" class="internal xref">Challenge Calculation</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-utility-operations" class="internal xref">Utility Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-random-scalars" class="internal xref">Random Scalars</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-generators-calculation" class="internal xref">Generators Calculation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-hash-to-generators" class="internal xref">Hash to Generators</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-defining-new-ways-to-create" class="internal xref">Defining new ways to create generators</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-messages-to-scalars" class="internal xref">Messages to Scalars</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-map-to-scalar" class="internal xref">Map to Scalar</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="auto internal xref">4.3.2</a>.  <a href="#name-define-a-new-map-to-scalar" class="internal xref">Define a new Map to Scalar</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-hash-to-scalar" class="internal xref">Hash to Scalar</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-domain-calculation" class="internal xref">Domain Calculation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-serialization" class="internal xref">Serialization</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.1">
                    <p id="section-toc.1-1.4.2.6.2.1.1"><a href="#section-4.6.1" class="auto internal xref">4.6.1</a>.  <a href="#name-serialize" class="internal xref">Serialize</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.2">
                    <p id="section-toc.1-1.4.2.6.2.2.1"><a href="#section-4.6.2" class="auto internal xref">4.6.2</a>.  <a href="#name-signature-to-octets" class="internal xref">Signature to Octets</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.3">
                    <p id="section-toc.1-1.4.2.6.2.3.1"><a href="#section-4.6.3" class="auto internal xref">4.6.3</a>.  <a href="#name-octets-to-signature" class="internal xref">Octets to Signature</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.4">
                    <p id="section-toc.1-1.4.2.6.2.4.1"><a href="#section-4.6.4" class="auto internal xref">4.6.4</a>.  <a href="#name-proof-to-octets" class="internal xref">Proof to Octets</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.5">
                    <p id="section-toc.1-1.4.2.6.2.5.1"><a href="#section-4.6.5" class="auto internal xref">4.6.5</a>.  <a href="#name-octets-to-proof" class="internal xref">Octets to Proof</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.6">
                    <p id="section-toc.1-1.4.2.6.2.6.1"><a href="#section-4.6.6" class="auto internal xref">4.6.6</a>.  <a href="#name-octets-to-public-key" class="internal xref">Octets to Public Key</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-validating-public-keys" class="internal xref">Validating Public Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-point-deserialization" class="internal xref">Point Deserialization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-skipping-membership-checks" class="internal xref">Skipping Membership Checks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-side-channel-attacks" class="internal xref">Side Channel Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-randomness-considerations" class="internal xref">Randomness Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="auto internal xref">5.6</a>.  <a href="#name-presentation-header-selecti" class="internal xref">Presentation Header Selection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="auto internal xref">5.7</a>.  <a href="#name-implementing-hash_to_curve_" class="internal xref">Implementing hash_to_curve_g1</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a href="#section-5.8" class="auto internal xref">5.8</a>.  <a href="#name-choice-of-underlying-curve" class="internal xref">Choice of Underlying Curve</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a href="#section-5.9" class="auto internal xref">5.9</a>.  <a href="#name-proofgen-security" class="internal xref">ProofGen Security</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.10">
                <p id="section-toc.1-1.5.2.10.1"><a href="#section-5.10" class="auto internal xref">5.10</a>. <a href="#name-randomness-requirements" class="internal xref">Randomness Requirements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-ciphersuites" class="internal xref">Ciphersuites</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-ciphersuite-format" class="internal xref">Ciphersuite Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-ciphersuite-id" class="internal xref">Ciphersuite ID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-additional-parameters" class="internal xref">Additional Parameters</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-bls12-381-ciphersuites" class="internal xref">BLS12-381 Ciphersuites</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-bls12-381-shake-256" class="internal xref">BLS12-381-SHAKE-256</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="auto internal xref">6.2.2</a>.  <a href="#name-bls12-381-sha-256" class="internal xref">BLS12-381-SHA-256</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-test-vectors" class="internal xref">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-mocked-random-scalars" class="internal xref">Mocked Random Scalars</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-messages" class="internal xref">Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-bls12-381-shake-256-test-ve" class="internal xref">BLS12-381-SHAKE-256 Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="auto internal xref">7.3.1</a>.  <a href="#name-key-pair" class="internal xref">Key Pair</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="auto internal xref">7.3.2</a>.  <a href="#name-map-messages-to-scalars" class="internal xref">Map Messages to Scalars</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.3">
                    <p id="section-toc.1-1.7.2.3.2.3.1"><a href="#section-7.3.3" class="auto internal xref">7.3.3</a>.  <a href="#name-message-generators" class="internal xref">Message Generators</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.4">
                    <p id="section-toc.1-1.7.2.3.2.4.1"><a href="#section-7.3.4" class="auto internal xref">7.3.4</a>.  <a href="#name-signature-fixtures" class="internal xref">Signature Fixtures</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.5">
                    <p id="section-toc.1-1.7.2.3.2.5.1"><a href="#section-7.3.5" class="auto internal xref">7.3.5</a>.  <a href="#name-proof-fixtures" class="internal xref">Proof Fixtures</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-bls12381-sha-256-test-vecto" class="internal xref">BLS12381-SHA-256 Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.1">
                    <p id="section-toc.1-1.7.2.4.2.1.1"><a href="#section-7.4.1" class="auto internal xref">7.4.1</a>.  <a href="#name-key-pair-2" class="internal xref">Key Pair</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.2">
                    <p id="section-toc.1-1.7.2.4.2.2.1"><a href="#section-7.4.2" class="auto internal xref">7.4.2</a>.  <a href="#name-map-messages-to-scalars-2" class="internal xref">Map Messages to Scalars</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.3">
                    <p id="section-toc.1-1.7.2.4.2.3.1"><a href="#section-7.4.3" class="auto internal xref">7.4.3</a>.  <a href="#name-message-generators-2" class="internal xref">Message Generators</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.4">
                    <p id="section-toc.1-1.7.2.4.2.4.1"><a href="#section-7.4.4" class="auto internal xref">7.4.4</a>.  <a href="#name-signature-fixtures-2" class="internal xref">Signature Fixtures</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.5">
                    <p id="section-toc.1-1.7.2.4.2.5.1"><a href="#section-7.4.5" class="auto internal xref">7.4.5</a>.  <a href="#name-proof-fixtures-2" class="internal xref">Proof Fixtures</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-bls12-381-hash_to_curve-def" class="internal xref">BLS12-381 hash_to_curve Definition Using SHAKE-256</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-bls12-381-g1" class="internal xref">BLS12-381 G1</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-use-cases" class="internal xref">Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-non-correlating-security-to" class="internal xref">Non-correlating Security Token</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-improved-bearer-security-to" class="internal xref">Improved Bearer Security Token</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-selectively-disclosure-enab" class="internal xref">Selectively Disclosure Enabled Identity Credentials</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-additional-test-vectors" class="internal xref">Additional Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-bls12-381-shake-256-ciphers" class="internal xref">BLS12-381-SHAKE-256 Ciphersuite</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1.2.1">
                    <p id="section-toc.1-1.14.2.1.2.1.1"><a href="#appendix-C.1.1" class="auto internal xref">C.1.1</a>.  <a href="#name-signature-test-vectors" class="internal xref">Signature Test Vectors</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1.2.2">
                    <p id="section-toc.1-1.14.2.1.2.2.1"><a href="#appendix-C.1.2" class="auto internal xref">C.1.2</a>.  <a href="#name-proof-test-vectors" class="internal xref">Proof Test Vectors</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1.2.3">
                    <p id="section-toc.1-1.14.2.1.2.3.1"><a href="#appendix-C.1.3" class="auto internal xref">C.1.3</a>.  <a href="#name-hash-to-scalar-test-vectors" class="internal xref">Hash to Scalar Test Vectors</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-bls12-381-sha-256-ciphersui" class="internal xref">BLS12-381-SHA-256 Ciphersuite</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2.2.1">
                    <p id="section-toc.1-1.14.2.2.2.1.1"><a href="#appendix-C.2.1" class="auto internal xref">C.2.1</a>.  <a href="#name-signature-test-vectors-2" class="internal xref">Signature Test Vectors</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2.2.2">
                    <p id="section-toc.1-1.14.2.2.2.2.1"><a href="#appendix-C.2.2" class="auto internal xref">C.2.2</a>.  <a href="#name-proof-test-vectors-2" class="internal xref">Proof Test Vectors</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2.2.3">
                    <p id="section-toc.1-1.14.2.2.2.3.1"><a href="#appendix-C.2.3" class="auto internal xref">C.2.3</a>.  <a href="#name-hash-to-scalar-test-vectors-2" class="internal xref">Hash to Scalar Test Vectors</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-proof-generation-and-verifi" class="internal xref">Proof Generation and Verification Algorithmic Explanation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-E" class="auto internal xref">Appendix E</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-F" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">A digital signature scheme is a fundamental cryptographic primitive that is used to provide data integrity and verifiable authenticity in various protocols. The core premise of digital signature technology is built upon asymmetric cryptography where-by the possessor of a private key is able to sign a message, where anyone in possession of the corresponding public key matching that of the private key is able to verify the signature.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The name BBS is derived from the authors of the original academic work of Dan Boneh, Xavier Boyen, and Hovav Shacham, where the scheme was first described.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Beyond the core properties of a digital signature scheme, BBS signatures provide multiple additional unique properties, three key ones are:<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4"><strong>Selective Disclosure</strong> - The scheme allows a signer to sign multiple messages and produce a single -constant size- output signature. A holder/prover then possessing the messages and the signature can generate a proof whereby they can choose which messages to disclose, while revealing no-information about the undisclosed messages. The proof itself guarantees the integrity and authenticity of the disclosed messages (e.g. that they were originally signed by the signer).<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5"><strong>Unlinkable Proofs</strong> - The proofs generated by the scheme are known as zero-knowledge, proofs-of-knowledge of the signature, meaning a verifying party in receipt of a proof is unable to determine which signature was used to generate the proof, removing a common source of correlation. In general, each proof generated is indistinguishable from random even for two proofs generated from the same signature.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6"><strong>Proof of Possession</strong> - The proofs generated by the scheme prove to a verifier that the party who generated the proof (holder/prover) was in possession of a signature without revealing it. The scheme also supports binding a presentation header to the generated proof. The presentation header can include arbitrary information such as a cryptographic nonce, an audience/domain identifier and or time based validity information.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">Refer to the <a href="#use-cases" class="auto internal xref">Appendix B</a> for an elaboration on situations where these properties are useful<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">Below is a basic diagram describing the main entities involved in the scheme<a href="#section-1-8" class="pilcrow">¶</a></p>
<span id="name-basic-diagram-capturing-the"></span><figure id="figure-1">
        <div class="lang-ascii-art sourcecode" id="section-1-9.1">
<pre>  (1) sign                                      (3) ProofGen
   +-----                                         +-----
   |    |                                         |    |
   |    |                                         |    |
   |   \ /                                        |   \ /
+----------+                                   +-----------+
|          |                                   |           |
|          |                                   |           |
|          |                                   |           |
|  Signer  |---(2)* Send signature + msgs-----&gt;|  Holder/  |
|          |                                   |  Prover   |
|          |                                   |           |
|          |                                   |           |
+----------+                                   +-----------+
                                                     |
                                                     |
                                                     |
                                      (4)* Send proof + disclosed msgs
                                                     |
                                                     |
                                                    \ /
                                               +-----------+
                                               |           |
                                               |           |
                                               |           |
                                               | Verifier  |
                                               |           |
                                               |           |
                                               |           |
                                               +-----------+
                                                  |   / \
                                                  |    |
                                                  |    |
                                                  +-----
                                             (5) ProofVerify


</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-basic-diagram-capturing-the" class="selfRef">Basic diagram capturing the main entities involved in using the scheme</a>
        </figcaption></figure>
<p id="section-1-10"><strong>Note</strong> The protocols implied by the items annotated by an asterisk are out of scope for this specification<a href="#section-1-10" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The following terminology is used throughout this document:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-2">
          <dt id="section-1.1-2.1">SK</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.2">The secret key for the signature scheme.<a href="#section-1.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.3">PK</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.4">The public key for the signature scheme.<a href="#section-1.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.5">L</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.6">The total number of signed messages.<a href="#section-1.1-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.7">R</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.8">The number of message indexes that are disclosed (revealed) in a proof-of-knowledge of a signature.<a href="#section-1.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.9">U</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.10">The number of message indexes that are undisclosed in a proof-of-knowledge of a signature.<a href="#section-1.1-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.11">scalar</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.12">An integer between 0 and r-1, where r is the prime order of the selected groups, defined by each ciphersuite (see also <a href="#notation">Notation</a>).<a href="#section-1.1-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.13">input_message</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.14">An input message to be signed by the signature scheme. An input_message can either be either an octet string or a scalar.<a href="#section-1.1-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.15">generator</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.16">A valid point on the selected subgroup of the curve being used that is employed to commit a value.<a href="#section-1.1-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.17">signature</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.18">The digital signature output.<a href="#section-1.1-2.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.19">nonce</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.20">A cryptographic nonce<a href="#section-1.1-2.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.21">presentation_header (ph)</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.22">A payload generated and bound to the context of a specific spk.<a href="#section-1.1-2.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.23">dst</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.24">The domain separation tag.<a href="#section-1.1-2.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.25">I2OSP</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.26">An operation that transforms a non-negative integer into an octet string, defined in Section 4 of <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>. Note, the output of this operation is in big-endian order.<a href="#section-1.1-2.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.27">OS2IP</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.28">An operation that transforms a octet string into an non-negative integer, defined in Section 4 of <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>. Note, the input of this operation must be in big-endian order.<a href="#section-1.1-2.28" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.29">INVALID, ABORT</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.30">Error indicators. INVALID refers to an error encountered during the Deserialization or Procedure steps of an operation. An INVALID value can be returned by a subroutine and handled by the calling operation. ABORT indicates that one or more of the initial constraints defined by the operation are not met. In that case, the operation will stop execution. An operation calling a subroutine that aborted must also immediately abort.<a href="#section-1.1-2.30" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="notation">
<section id="section-1.2">
        <h3 id="name-notation">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-notation" class="section-name selfRef">Notation</a>
        </h3>
<p id="section-1.2-1">The following notation and primitives are used:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.2-2">
          <dt id="section-1.2-2.1">a || b</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.2">Denotes the concatenation of octet strings a and b.<a href="#section-1.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.3">I \ J</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.4">For sets I and J, denotes the difference of the two sets i.e., all the elements of I that do not appear in J, in the same order as they were in I.<a href="#section-1.2-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.5">X[a..b]</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.6">Denotes a slice of the array <code>X</code> containing all elements from and including the value at index <code>a</code> until and including the value at index <code>b</code>. Note when this syntax is applied to an octet string, each element in the array <code>X</code> is assumed to be a single byte.<a href="#section-1.2-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.7">range(a, b)</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.8">For integers a and b, with a &lt;= b, denotes the ascending ordered list of all integers between a and b inclusive (i.e., the integers "i" such that a &lt;= i &lt;= b).<a href="#section-1.2-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.9">length(input)</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.10">Takes as input either an array or an octet string. If the input is an array, returns the number of elements of the array. If the input is an octet string, returns the number of bytes of the inputted octet string.<a href="#section-1.2-2.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.2-3">Terms specific to pairing-friendly elliptic curves that are relevant to this document are restated below, originally defined in <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.2-4">
          <dt id="section-1.2-4.1">E1, E2</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.2">elliptic curve groups defined over finite fields. This document assumes that E1 has a more compact representation than E2, i.e., because E1 is defined over a smaller field than E2. For a pairing-friendly curve, this document denotes operations in E1 and E2 in additive notation, i.e., P + Q denotes point addition and x * P denotes scalar multiplication.<a href="#section-1.2-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.3">G1, G2</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.4">subgroups of E1 and E2 (respectively) having prime order r.<a href="#section-1.2-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.5">GT</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.6">a subgroup, of prime order r, of the multiplicative group of a field extension.<a href="#section-1.2-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.7">e</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.8">G1 x G2 -&gt; GT: a non-degenerate bilinear map.<a href="#section-1.2-4.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.9">r</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.10">The prime order of the G1 and G2 subgroups.<a href="#section-1.2-4.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.11">BP1, BP2</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.12">base (constant) points on the G1 and G2 subgroups respectively.<a href="#section-1.2-4.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.13">Identity_G1, Identity_G2, Identity_GT</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.14">The identity element for the G1, G2, and GT subgroups respectively.<a href="#section-1.2-4.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.15">hash_to_curve_g1(ostr, dst) -&gt; P</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.16">A cryptographic hash function that takes an arbitrary octet string as input and returns a point in G1, using the hash_to_curve operation defined in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> and the inputted dst as the domain separation tag for that operation (more specifically, the inputted dst will become the DST parameter for the hash_to_field operation, called by hash_to_curve).<a href="#section-1.2-4.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.17">point_to_octets_g1(P) -&gt; ostr, point_to_octets_g2(P) -&gt; ostr</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.18">returns the canonical representation of the point P for the respective subgroup as an octet string. This operation is also known as serialization.<a href="#section-1.2-4.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.19">octets_to_point_g1(ostr) -&gt; P, octets_to_point_g2(ostr) -&gt; P</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.20">returns the point P for the respective subgroup corresponding to the canonical representation ostr, or INVALID if ostr is not a valid output of the respective point_to_octets_g* function. This operation is also known as deserialization.<a href="#section-1.2-4.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.21">subgroup_check(P) -&gt; VALID or INVALID</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.22">returns VALID when the point P is an element of the subgroup of order r, and INVALID otherwise. This function can always be implemented by checking that r * P is equal to the identity element. In some cases, faster checks may also exist, e.g., <span>[<a href="#Bowe19" class="cite xref">Bowe19</a>]</span>.<a href="#section-1.2-4.22" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="document-organization">
<section id="section-1.3">
        <h3 id="name-document-organization">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-document-organization" class="section-name selfRef">Document Organization</a>
        </h3>
<p id="section-1.3-1">This document is organized as follows:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-2.1">
            <p id="section-1.3-2.1.1"><a href="#scheme-definition">Scheme Definition</a> defines the core operations and parameters for the BBS signature scheme.<a href="#section-1.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.2">
            <p id="section-1.3-2.2.1"><a href="#utility-operations">Utility Operations</a> defines utilities used by the BBS signature scheme.<a href="#section-1.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.3">
            <p id="section-1.3-2.3.1"><a href="#security-considerations">Security Considerations</a> describes a set of security considerations associated to the signature scheme.<a href="#section-1.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.4">
            <p id="section-1.3-2.4.1"><a href="#ciphersuites">Ciphersuites</a> defines the format of a ciphersuite, alongside a concrete ciphersuite based on the BLS12-381 curve.<a href="#section-1.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="conventions">
<section id="section-2">
      <h2 id="name-conventions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions" class="section-name selfRef">Conventions</a>
      </h2>
<p id="section-2-1">The keywords <span class="bcp14">MUST</span>, <span class="bcp14">MUST NOT</span>, <span class="bcp14">REQUIRED</span>, <span class="bcp14">SHALL</span>, <span class="bcp14">SHALL NOT</span>, <span class="bcp14">SHOULD</span>,
<span class="bcp14">SHOULD NOT</span>, <span class="bcp14">RECOMMENDED</span>, <span class="bcp14">MAY</span>, and <span class="bcp14">OPTIONAL</span>, when they appear in this
document, are to be interpreted as described in <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scheme-definition">
<section id="section-3">
      <h2 id="name-scheme-definition">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-scheme-definition" class="section-name selfRef">Scheme Definition</a>
      </h2>
<p id="section-3-1">This section defines the BBS signature scheme, including the parameters required to define a concrete ciphersuite.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="parameters">
<section id="section-3.1">
        <h3 id="name-parameters">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-parameters" class="section-name selfRef">Parameters</a>
        </h3>
<p id="section-3.1-1">The schemes operations defined in this section depend on the following parameters:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">A pairing-friendly elliptic curve, plus associated functionality given in <a href="#notation">Section 1.2</a>.<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">A hash-to-curve suite as defined in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>, using the aforementioned pairing-friendly curve. This defines the hash_to_curve and expand_message operations, used by this document.<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.3">
            <p id="section-3.1-2.3.1">get_random(n): returns a random octet string with a length of n bytes, sampled uniformly at random using a cryptographically secure pseudo-random number generator (CSPRNG) or a pseudo random function. See <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span> for recommendations and requirements on the generation of random numbers.<a href="#section-3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="considerations">
<section id="section-3.2">
        <h3 id="name-considerations">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-considerations" class="section-name selfRef">Considerations</a>
        </h3>
<div id="subgroup-selection">
<section id="section-3.2.1">
          <h4 id="name-subgroup-selection">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-subgroup-selection" class="section-name selfRef">Subgroup Selection</a>
          </h4>
<p id="section-3.2.1-1">In definition of this signature scheme there are two possible variations based upon the sub-group selection, namely where public keys are defined in G2 and signatures in G1 OR the opposite where public keys are defined in G1 and signatures in G2. Some pairing cryptography based digital signature schemes such as <span>[<a href="#I-D.irtf-cfrg-bls-signature" class="cite xref">I-D.irtf-cfrg-bls-signature</a>]</span> elect to allow for both variations, because they optimize for different things. However, in the case of this scheme, due to the operations involved in both signature and proof generation being computational in-efficient when performed in G2 and in the pursuit of simplicity, the scheme is limited to a construction where public keys are in G2 and signatures in G1.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="generators">
<section id="section-3.2.2">
          <h4 id="name-generators">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-generators" class="section-name selfRef">Generators</a>
          </h4>
<p id="section-3.2.2-1">Throughout the operations of this signature scheme, each message that is signed is paired with a specific point of G1, called a generator. Specifically, if a generator <code>H_1</code> is multiplied with <code>msg_1</code> during signing, then <code>H_1</code> MUST be multiplied with <code>msg_1</code> in all other operations (signature verification, proof generation and proof verification). As a result, the messages must be passed to the operations of the BBS scheme in the same order.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">Aside from the message generators, the scheme uses one additional generator <code>Q_1</code> to sign the signature's domain, which binds both the signature and generated proofs to a specific context and cryptographically protects any potential application-specific information (for example, messages that must always be disclosed etc.).<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="serializing-to-octets">
<section id="section-3.2.3">
          <h4 id="name-serializing-to-octets">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-serializing-to-octets" class="section-name selfRef">Serializing to Octets</a>
          </h4>
<p id="section-3.2.3-1">When serializing one or more values to produce an octet string, each element will be encoded using a specific operation determined by its type. More concretely,<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.3-2.1">Points in <code>G*</code> will be serialized using the <code>point_to_octets_g*</code> implementation for a particular ciphersuite.<a href="#section-3.2.3-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.3-2.2">Non-negative integers will be serialized using <code>I2OSP</code> with an output length of 8 bytes.<a href="#section-3.2.3-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.3-2.3">Scalars will be serialized using <code>I2OSP</code> with a constant output length defined by a particular ciphersuite.<a href="#section-3.2.3-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.3-3">We also use strings in double quotes to represent ASCII-encoded literals. For example "BBS" will be used to refer to the octet string, <code>010000100100001001010011</code>.<a href="#section-3.2.3-3" class="pilcrow">¶</a></p>
<p id="section-3.2.3-4">Those rules will be used explicitly on every operation. See also <a href="#serialize">Serialize</a>.<a href="#section-3.2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-generation-operations">
<section id="section-3.3">
        <h3 id="name-key-generation-operations">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-key-generation-operations" class="section-name selfRef">Key Generation Operations</a>
        </h3>
<div id="secret-key">
<section id="section-3.3.1">
          <h4 id="name-secret-key">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-secret-key" class="section-name selfRef">Secret Key</a>
          </h4>
<p id="section-3.3.1-1">This operation generates a secret key (SK) deterministically from a secret octet string (key_material). This operation is the RECOMMENDED way of generating a secret key, but its use is not required for compatibility, and implementations MAY use a different key generation procedure. For security, such an alternative MUST output a secret key that is statistically close to uniformly random in the range from 1 to r-1. An example of an HKDF-based alternative is the KeyGen operation defined in Section 2.3 of <span>[<a href="#I-D.irtf-cfrg-bls-signature" class="cite xref">I-D.irtf-cfrg-bls-signature</a>]</span> (with an appropriate, BBS specific, salt value, like "BBS<em>SIG</em>KEYGEN<em>SALT</em>").<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">For security, key_material MUST be random and infeasible to guess, e.g. generated by a trusted source of randomness and with enough entropy. See <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span> for suggestions on generating randomness. key_material MUST be at least 32 bytes long, but it MAY be longer.<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3">KeyGen takes an optional input, key_info. This parameter MAY be used to derive distinct keys from the same key material.<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-4">Because KeyGen is deterministic, implementations MAY choose either to store the resulting SK or to store key_material and key_info and call KeyGen to derive SK when necessary.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3.1-5">
<pre>SK = KeyGen(key_material, key_info, key_dst)

Inputs:

- key_material (REQUIRED), a secret octet string. See requirements
                           above.
- key_info (OPTIONAL), an octet string. Defaults to an empty string if
                       not supplied.
- key_dst (OPTIONAL), an octet string representing the domain separation tag.
                      Defaults to the octet string ciphersuite_id || "KEYGEN_DST_"
                      if not supplied.

Outputs:

- SK, a uniformly random integer such that 0 &lt; SK &lt; r.

Procedure:

1. if length(key_material) &lt; 32, return INVALID
2. if length(key_info) &gt; 65535, return INVALID
3. derive_input = key_material || I2OSP(length(key_info), 2) || key_info
4. SK = hash_to_scalar(derive_input, key_dst)
5. if SK is INVALID, return INVALID
6. return SK
</pre><a href="#section-3.3.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="public-key">
<section id="section-3.3.2">
          <h4 id="name-public-key">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-public-key" class="section-name selfRef">Public Key</a>
          </h4>
<p id="section-3.3.2-1">This operation takes a secret key (SK) and outputs a corresponding public key (PK).<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3.2-2">
<pre>PK = SkToPk(SK)

Inputs:

- SK (REQUIRED), a secret integer such that 0 &lt; SK &lt; r.

Outputs:

- PK, a public key encoded as an octet string.

Procedure:

1. W = SK * BP2
2. return point_to_octets_g2(W)
</pre><a href="#section-3.3.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="core-operations">
<section id="section-3.4">
        <h3 id="name-core-operations">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-core-operations" class="section-name selfRef">Core Operations</a>
        </h3>
<p id="section-3.4-1">The operations of this section make use of functions and sub-routines defined in <a href="#utility-operations">Utility Operations</a>. More specifically,<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-2.1">
            <code>hash_to_scalar</code> is defined in <a href="#hash-to-scalar" class="auto internal xref">Section 4.4</a><a href="#section-3.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.4-2.2">
            <code>messages_to_scalars</code> is defined in <a href="#messages-to-scalars" class="auto internal xref">Section 4.3</a><a href="#section-3.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.4-2.3">
            <code>calculate_domain</code> is defined in <a href="#domain-calculation" class="auto internal xref">Section 4.5</a>.<a href="#section-3.4-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.4-2.4">
            <code>serialize</code>, <code>signature_to_octets</code>, <code>octets_to_signature</code>, <code>proof_to_octets</code>, <code>octets_to_proof</code> and <code>octets_to_pubkey</code> are defined in <a href="#serialization" class="auto internal xref">Section 4.6</a><a href="#section-3.4-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.4-3">The following operations also make use of the <code>create_generators</code> operation defined in <a href="#generators-calculation" class="auto internal xref">Section 4.2</a>, to create generator points on <code>G1</code> (see <a href="#generators" class="auto internal xref">Section 3.2.2</a>). Note that the values of those points depends only on a cipheruite defined seed. As a result, the output of that operation can be cached to avoid unnecessary calls to the <code>create_generators</code> procedure. See <a href="#generators-calculation" class="auto internal xref">Section 4.2</a> for more details.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4"><strong>Note</strong> Some of the utility functions used by the core operations of this section could fail (ABORT). In that case, the calling operation MUST also immediately abort.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<div id="signature-generation-sign">
<section id="section-3.4.1">
          <h4 id="name-signature-generation-sign">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-signature-generation-sign" class="section-name selfRef">Signature Generation (Sign)</a>
          </h4>
<p id="section-3.4.1-1">This operation computes a deterministic signature from a secret key (SK) and optionally over a header and or a vector of input_messages (see <a href="#terminology">Terminology</a> for the definition of a input_message).<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4.1-2">
<pre>signature = Sign(SK, PK, header, messages)

Inputs:

- SK (REQUIRED), a secret key in the form outputted by the KeyGen
                 operation.
- PK (REQUIRED), an octet string of the form outputted by SkToPk
                 provided the above SK as input.
- header (OPTIONAL), an octet string containing context and application
                     specific information. If not supplied, it defaults
                     to an empty string.
- messages (OPTIONAL), a vector of input_messages. If not supplied, it
                       defaults to the empty array "()".

Parameters:

- P1, fixed point of G1, defined by the ciphersuite.

Outputs:

- signature, a signature encoded as an octet string.

Deserialization:

1. L = length(messages)
2. (msg_1, ..., msg_L) = messages_to_scalars(messages)

Procedure:

1. (Q_1, H_1, ..., H_L) = create_generators(L+1, PK)
2. domain = calculate_domain(PK, Q_1, (H_1, ..., H_L), header)
3. e = hash_to_scalar(serialize((SK, domain, msg_1, ..., msg_L)))
4. B = P1 + Q_1 * domain + H_1 * msg_1 + ... + H_L * msg_L
5. A = B * (1 / (SK + e))
6. return signature_to_octets(A, e)
</pre><a href="#section-3.4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.4.1-3"><strong>Note</strong> When computing step 12 of the above procedure there is an extremely small probability (around <code>2^(-r)</code>) that the condition <code>(SK + e) = 0 mod r</code> will be met. How implementations evaluate the inverse of the scalar value <code>0</code> may vary, with some returning an error and others returning <code>0</code> as a result. If the returned value from the inverse operation <code>1/(SK + e)</code> does evaluate to <code>0</code> the value of <code>A</code> will equal <code>Identity_G1</code> thus an invalid signature. Implementations MAY elect to check <code>(SK + e) = 0 mod r</code> prior to step 9, and or <code>A != Identity_G1</code> after step 9 to prevent the production of invalid signatures.<a href="#section-3.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-verification-verify">
<section id="section-3.4.2">
          <h4 id="name-signature-verification-veri">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-signature-verification-veri" class="section-name selfRef">Signature Verification (Verify)</a>
          </h4>
<p id="section-3.4.2-1">This operation checks that a signature is valid for a given header and vector of input_messages against a supplied public key (PK). The input_messages MUST be supplied in this operation in the same order they were supplied to <a href="#signature-generation-sign">Sign</a> when creating the signature.<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4.2-2">
<pre>result = Verify(PK, signature, header, messages)

Inputs:

- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation.
- signature (REQUIRED), an octet string of the form outputted by the
                        Sign operation.
- header (OPTIONAL), an octet string containing context and application
                     specific information. If not supplied, it defaults
                     to an empty string.
- messages (OPTIONAL), a vector of input_messages. If not supplied, it
                       defaults to the empty array "()".

Parameters:

- P1, fixed point of G1, defined by the ciphersuite.

Outputs:

- result, either VALID or INVALID.

Deserialization:

1. signature_result = octets_to_signature(signature)
2. if signature_result is INVALID, return INVALID
3. (A, e) = signature_result
4. W = octets_to_pubkey(PK)
5. if W is INVALID, return INVALID
6. L = length(messages)
7. (msg_1, ..., msg_L) = messages_to_scalars(messages)

Procedure:

1. (Q_1, H_1, ..., H_L) = create_generators(L+1, PK)
2. domain = calculate_domain(PK, Q_1, (H_1, ..., H_L), header)
3. B = P1 + Q_1 * domain + H_1 * msg_1 + ... + H_L * msg_L
4. if e(A, W + BP2 * e) * e(B, -BP2) != Identity_GT, return INVALID
5. return VALID
</pre><a href="#section-3.4.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="proof-generation-proofgen">
<section id="section-3.4.3">
          <h4 id="name-proof-generation-proofgen">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-proof-generation-proofgen" class="section-name selfRef">Proof Generation (ProofGen)</a>
          </h4>
<p id="section-3.4.3-1">This operation computes a zero-knowledge proof-of-knowledge of a signature, while optionally selectively disclosing from the original set of signed messages. The "prover" may also supply a presentation header, see <a href="#presentation-header-selection">Presentation header selection</a> for more details. Validating the resulting proof (using the <code>ProofVerify</code> algorithm defined in <a href="#proof-verification-proofverify" class="auto internal xref">Section 3.4.4</a>), guarantees the integrity and authenticity of the revealed messages, as well as the possession of a valid signature (for the public key <code>PK</code>) by the prover.<a href="#section-3.4.3-1" class="pilcrow">¶</a></p>
<p id="section-3.4.3-2">The <code>ProofGen</code> operation will accept that signature as an input. It is RECOMMENDED to validate that signature, using the inputted public key <code>PK</code>, with the <code>Verify</code> operation defined in <a href="#signature-verification-verify" class="auto internal xref">Section 3.4.2</a>.<a href="#section-3.4.3-2" class="pilcrow">¶</a></p>
<p id="section-3.4.3-3">The operation works by first initializing the proof using the <code>ProofInit</code> subroutine defined in <a href="#proof-initialization" class="auto internal xref">Section 3.5.1</a>. The result will be passed to the challenge calculation operation (<code>ProofChallengeCalculate</code>, defined in <a href="#challenge-calculation" class="auto internal xref">Section 3.5.4</a>). The outputted challenge, together with the initialization result, will be used by the <code>ProofFinalize</code> subroutine defined in <a href="#proof-finalization" class="auto internal xref">Section 3.5.2</a>, which will return the proof value.<a href="#section-3.4.3-3" class="pilcrow">¶</a></p>
<p id="section-3.4.3-4">The input_messages supplied in this operation MUST be in the same order as when supplied to <a href="#signature-generation-sign">Sign</a>. To specify which of those input_messages will be disclosed, the prover can supply the list of indexes (<code>disclosed_indexes</code>) that the disclosed messages have in the array of signed messages. Each element in <code>disclosed_indexes</code> MUST be a non-negative integer, in the range from 1 to <code>length(messages)</code>.<a href="#section-3.4.3-4" class="pilcrow">¶</a></p>
<p id="section-3.4.3-5">The operation calculates multiple random scalars using the <code>calculate_random_scalars</code> utility operation defined in <a href="#random-scalars" class="auto internal xref">Section 4.1</a>. See also <a href="#randomness-requirements" class="auto internal xref">Section 5.10</a> for considerations and requirements on random scalars generation.<a href="#section-3.4.3-5" class="pilcrow">¶</a></p>
<p id="section-3.4.3-6">To allow for flexibility in implementations, although ProofGen defines a specific value for <code>expand_len</code>, applications may use any value larger than <code>ceil((ceil(log2(r))+k)/8)</code> (for example, for the BLS12-381-SHAKE-256 and BLS12-381-SHA-256 ciphersuites, an implementation can elect to use a value of 64, instead of 48, as to allow for certain optimizations).<a href="#section-3.4.3-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4.3-7">
<pre>proof = ProofGen(PK, signature, header, ph, messages, disclosed_indexes)

Inputs:

- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation.
- signature (REQUIRED), an octet string of the form outputted by the
                        Sign operation.
- header (OPTIONAL), an octet string containing context and application
                     specific information. If not supplied, it defaults
                     to an empty string.
- ph (OPTIONAL), an octet string containing the presentation header. If
                 not supplied, it defaults to an empty string.
- messages (OPTIONAL), a vector of input\_messages. If not supplied, it
                       defaults to the empty array "()".
- disclosed_indexes (OPTIONAL), vector of unsigned integers in ascending
                                order. Indexes of disclosed messages. If
                                not supplied, it defaults to the empty
                                array "()".

Outputs:

- proof, an octet string; or INVALID.

Deserialization:

1.  signature_result = octets_to_signature(signature)
2.  if signature_result is INVALID, return INVALID
3.  (A, e) = signature_result
4.  L = length(messages)
5.  R = length(disclosed_indexes)
6.  if R &gt; L, return INVALID
7.  U = L - R
8.  undisclosed_indexes = range(1, L) \ disclosed_indexes
9.  (i1, ..., iR) = disclosed_indexes
10. (j1, ..., jU) = undisclosed_indexes
11. msg_scalars = messages_to_scalars(messages)
12. disclosed_messages = (msg_scalars[i1], ..., msg_scalars[iR])
13. undisclosed_messages = (msg_scalars[j1], ..., msg_scalars[jU])

Procedure:

1. random_scalars = calculate_random_scalars(3+U)
2. init_res = ProofInit(PK, signature_res, random_scalars, header,
                                       msg_scalars, undisclosed_indexes)
3. if init_res is INVALID, return INVALID
4. challenge = ProofChallengeCalculate(init_res, disclosed_indexes,
                                                 disclosed_messages, ph)
5. proof = ProofFinalize(init_res, challenge, e, random_scalars,
                                                   undisclosed_messages)
6. return proof
</pre><a href="#section-3.4.3-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="proof-verification-proofverify">
<section id="section-3.4.4">
          <h4 id="name-proof-verification-proofver">
<a href="#section-3.4.4" class="section-number selfRef">3.4.4. </a><a href="#name-proof-verification-proofver" class="section-name selfRef">Proof Verification (ProofVerify)</a>
          </h4>
<p id="section-3.4.4-1">This operation checks that a proof is valid for a header, vector of disclosed messages (along side their index corresponding to their original position when signed) and presentation header against a public key (PK).<a href="#section-3.4.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4.4-2">The operation works by first initializing the proof verification using the <code>ProofVerifyInit</code> subroutine defined in <a href="#proof-verification-initialization" class="auto internal xref">Section 3.5.3</a>. The result will be inputted to the challenge calculation operation (<code>ProofChallengeCalculate</code>, defined in <a href="#challenge-calculation" class="auto internal xref">Section 3.5.4</a>). The resulting challenge and the 2 first component of the received proof (points of G1) will be checked for correctness (steps 4 and 5 in the following procedure), to verify the proof.<a href="#section-3.4.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4.4-3">The operation accepts the messages that the prover indicated to be disclosed. Those messages MUST be in the same order as when supplied to <a href="#signature-generation-sign">Sign</a> (as a subset of the signed messages). Lastly, it also accepts the indexes that the disclosed messages had in the original array of messages supplied to <a href="#signature-generation-sign">Sign</a> (i.e., the <code>disclosed_indexes</code> list supplied to <a href="#proof-generation-proofgen">ProofGen</a>). Every element in this list MUST be a non-negative integer in the range from 1 to L, in ascending order.<a href="#section-3.4.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4.4-4">
<pre>result = ProofVerify(PK, proof, header, ph,
                     disclosed_messages,
                     disclosed_indexes)

Inputs:

- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation.
- proof (REQUIRED), an octet string of the form outputted by the
                    ProofGen operation.
- header (OPTIONAL), an optional octet string containing context and
                     application specific information. If not supplied,
                     it defaults to an empty string.
- ph (OPTIONAL), an octet string containing the presentation header. If not
                 supplied, it defaults to an empty string.
- disclosed_messages (OPTIONAL), a vector of input_messages. If not
                                 supplied, it defaults to the empty
                                 array "()".
- disclosed_indexes (OPTIONAL), vector of unsigned integers in ascending
                                order. Indexes of disclosed messages. If
                                not supplied, it defaults to the empty
                                array "()".

Parameters:

- P1, fixed point of G1, defined by the ciphersuite.

Outputs:

- result, either VALID or INVALID.

Deserialization:

1. proof_result = octets_to_proof(proof)
2. if proof_result is INVALID, return INVALID
3. (Abar, Bbar, r2^, r3^, commitments, cp) = proof_result
4. W = octets_to_pubkey(PK)
5. if W is INVALID, return INVALID
6. (i1, ..., iR) = disclosed_indexes
7. msg_scalars = messages_to_scalars(messages)

Procedure:

1. init_res = ProofVerifyInit(PK, proof_result, header, msg_scalars,
                                                      disclosed_indexes)
2. challenge = ProofChallengeCalculate(init_res, disclosed_indexes,
                                                        msg_scalars, ph)
3. if cp != challenge, return INVALID
4. if e(Abar, W) * e(Bbar, -BP2) != Identity_GT, return INVALID
5. return VALID
</pre><a href="#section-3.4.4-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="proof-protocol-subroutines">
<section id="section-3.5">
        <h3 id="name-proof-protocol-subroutines">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-proof-protocol-subroutines" class="section-name selfRef">Proof Protocol Subroutines</a>
        </h3>
<p id="section-3.5-1">This section describes the subroutines used by the ProofGen and ProVerify algorithms defined in <a href="#proof-generation-proofgen" class="auto internal xref">Section 3.4.3</a> and <a href="#proof-verification-proofverify" class="auto internal xref">Section 3.4.4</a> respectively.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<div id="proof-initialization">
<section id="section-3.5.1">
          <h4 id="name-proof-initialization">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-proof-initialization" class="section-name selfRef">Proof Initialization</a>
          </h4>
<p id="section-3.5.1-1">This operation initializes the proof and returns part of the input that will be passed to the challenge calculation operation (i.e., <code>ProofChallengeCalculate</code>, <a href="#challenge-calculation" class="auto internal xref">Section 3.5.4</a>), during the <code>ProofGen</code> operation defined in <a href="#proof-generation-proofgen" class="auto internal xref">Section 3.4.3</a>. As one of its inputs, it accepts a list of random scalars (<code>random_scalars</code>) and a list of unsigned integers, in ascending order, representing the indexes of the messages the Prover choses to disclose (<code>undisclosed_indexes</code> see <a href="#proof-generation-proofgen" class="auto internal xref">Section 3.4.3</a>). The list of random scalars MUST have exactly 3 more items than the list of undisclosed indexes (i.e., it must hold that <code>length(random_scalars) = length(undisclosed_indexes) + 3</code>).<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
<p id="section-3.5.1-2">This operation makes use of the <code>create_generators</code> function, defined in <a href="#generators-calculation" class="auto internal xref">Section 4.2</a> and the <code>calculate_domain</code> function defined in <a href="#domain-calculation" class="auto internal xref">Section 4.5</a>.<a href="#section-3.5.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.1-3">
<pre>init_res = ProofInit(PK, signature, random_scalars, header, messages,
                                                    undisclosed_indexes)

Inputs:

- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation.
- signature (REQUIRED), vector representing a BBS signature, consisting
                        of a point of G1 and a scalar, in that order.
- random_scalars (REQUIRED), vector of scalar values.
- header (OPTIONAL), octet string. If not supplied it defaults to the
                     empty octet string ("").
- messages (OPTIONAL), vector of scalar values. If not supplied, it
                       defaults to the empty array "()".
- undisclosed_indexes (OPTIONAL), vector of unsigned integers in
                                  ascending order. If not supplied, it
                                  defaults to the empty array "()".

Parameters:

- P1, fixed point of G1, defined by the ciphersuite.

Outputs:

- init_res, vector consisting of 3 points of G1 and a scalar, in that
            order; or INVALID.

Deserialization:

1. (A, e) = signature
2. L = length(messages)
3. U = length(undisclosed_indexes)
4. (j1, ..., jU) = undisclosed_indexes
5. if length(random_scalars) != U + 3, return INVALID
6. (r1, r2, r3, m~_j1, ..., m~_jU) = random_scalars
7. (msg_1, ..., msg_L) = messages

ABORT if:

1. for i in undisclosed_indexes, i &lt; 1 or i &gt; L
2. U &gt; L

Procedure:

1. (Q_1, MsgGenerators) = create_generators(L+1, PK)
2. (H_1, ..., H_L) = MsgGenerators
3. (H_j1, ..., H_jU) = (MsgGenerators[j1], ..., MsgGenerators[jU])
4. domain = calculate_domain(PK, Q_1, (H_1, ..., H_L), header)
5. B = P1 + Q_1 * domain + H_1 * msg_1 + ... + H_L * msg_L
6. Abar = A * r1
7. Bbar = B * r1 - Abar * e
8. T =  Abar * r2 + Bbar * r3 + H_j1 * m~_j1 + ... + H_jU * m~_jU
9. return (Abar, Bbar, T, domain)
</pre><a href="#section-3.5.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="proof-finalization">
<section id="section-3.5.2">
          <h4 id="name-proof-finalization">
<a href="#section-3.5.2" class="section-number selfRef">3.5.2. </a><a href="#name-proof-finalization" class="section-name selfRef">Proof Finalization</a>
          </h4>
<p id="section-3.5.2-1">This operation finalizes the proof calculation during the <code>ProofGen</code> operation defined in <a href="#proof-generation-proofgen" class="auto internal xref">Section 3.4.3</a> and returns the serialized proof value, using the <code>proof_to_octets</code> serialization operation defined in <a href="#proof-to-octets" class="auto internal xref">Section 4.6.4</a>.<a href="#section-3.5.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.2-2">
<pre>proof = ProofFinalize(init_res, challenge, e_value, random_scalars,
                                                   undisclosed_messages)

Inputs:

- init_res (REQUIRED), vector representing the value returned after
                       initializing the proof generation or verification
                       operations, consisting of 3 points of G1 and a
                       scalar value, in that order.
- challenge (REQUIRED), scalar value.
- e_value (REQUIRED), scalar value.
- random_scalars (REQUIRED), vector of scalar values.
- undisclosed_messages (OPTIONAL), vector of scalar values. If not
                                   supplied, it defaults to the empty
                                   array "()".

Outputs:

- proof, an octet string; or INVALID.

Deserialization:

1. U = length(undisclosed_messages)
2. if length(random_scalars) != U + 3, return INVALID
3. (r1, r2, r3, m~_1, ..., m~_U) = random_scalars
4. (undisclosed_1, ..., undisclosed_U) = undisclosed_messages
5. if init_res is not a set of 3 points and a scalar in that
   order, return INVALID
6. (Abar, Bbar) = (init_res[0], init_res[1])

Procedure:

1. r4 = - r1^-1 (mod r)
2. r2^ = r2 + e_value * r4 * challenge (mod r)
3. r3^ = r3 + r4 * challenge (mod r)
4. for j in (1, ..., U): m^_j = m~_j + undisclosed_j * challenge (mod r)
5. proof = (Abar, Bbar, r2^, r3^, (m^_j1, ..., m^_jU), challenge)
6. return proof_to_octets(proof)
</pre><a href="#section-3.5.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="proof-verification-initialization">
<section id="section-3.5.3">
          <h4 id="name-proof-verification-initiali">
<a href="#section-3.5.3" class="section-number selfRef">3.5.3. </a><a href="#name-proof-verification-initiali" class="section-name selfRef">Proof Verification Initialization</a>
          </h4>
<p id="section-3.5.3-1">This operation initializes the proof verification operation and returns part of the input that will be passed to the challenge calculation operation (i.e., <code>ProofChallengeCalculate</code>, <a href="#challenge-calculation" class="auto internal xref">Section 3.5.4</a>), during the <code>ProofVerify</code> operation defined in <a href="#proof-verification-proofverify" class="auto internal xref">Section 3.4.4</a>.<a href="#section-3.5.3-1" class="pilcrow">¶</a></p>
<p id="section-3.5.3-2">This operation makes use of the <code>create_generators</code> function, defined in <a href="#generators-calculation" class="auto internal xref">Section 4.2</a> and the <code>calculate_domain</code> function defined in <a href="#domain-calculation" class="auto internal xref">Section 4.5</a>.<a href="#section-3.5.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.3-3">
<pre>init_res = ProofVerifyInit(PK, proof, header, disclosed_messages,
                                                      disclosed_indexes)

Inputs:

- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation.
- proof (REQUIRED), vector representing a BBS proof, consisting of 2
                    points of G1, 2 scalars, another nested but possibly
                    empty vector of scalars and another scalar, in that
                    order.
- header (OPTIONAL), octet string. If not supplied it defaults to the
                     empty octet string ("").
- disclosed_messages (OPTIONAL), vector of scalar values. If not
                                 supplied, it defaults to the empty
                                 array "()".
- disclosed_indexes (OPTIONAL), vector of unsigned integers in ascending
                                order. If not supplied, it defaults to
                                the empty array "()".

Parameters:

- P1, fixed point of G1, defined by the ciphersuite.

Outputs:

- init_res, vector consisting of 3 points of G1 and a scalar, in that
            order.

Deserialization:

1. (Abar, Bbar, r2^, r3^, commitments, c) = proof_result
2. U = length(commitments)
3. R = length(disclosed_indexes)
4. L = R + U
5. (i1, ..., iR) = disclosed_indexes
6. (j1, ..., jU) = range(1, L) \ disclosed_indexes
7. (msg_i1, ..., msg_iR) = disclosed_messages
8. (m^_j1, ...., m^_jU) = commitments

ABORT if:

1. for i in (i1, ..., iR), i &lt; 1 or i &gt; L
2. length(disclosed_messages) != R

Procedure:

1. (Q_1, MsgGenerators) = create_generators(L+1, PK)
2. (H_1, ..., H_L) = MsgGenerators
3. (H_i1, ..., H_iR) = (MsgGenerators[i1], ..., MsgGenerators[iR])
4. (H_j1, ..., H_jU) = (MsgGenerators[j1], ..., MsgGenerators[jU])
5. domain = calculate_domain(PK, Q_1, (H_1, ..., H_L), header)
6. D = P1 + Q_1 * domain + H_i1 * msg_i1 + ... + H_iR * msg_iR
7. T =  Abar * r2^ + Bbar * r3^ + H_j1 * m^_j1 + ... +  H_jU * m^_jU
8. T = T + D * c
9. return (Abar, Bbar, T, domain)
</pre><a href="#section-3.5.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="challenge-calculation">
<section id="section-3.5.4">
          <h4 id="name-challenge-calculation">
<a href="#section-3.5.4" class="section-number selfRef">3.5.4. </a><a href="#name-challenge-calculation" class="section-name selfRef">Challenge Calculation</a>
          </h4>
<p id="section-3.5.4-1">This operation calculates the challenge scalar value, used during <a href="#proof-generation-proofgen">ProofGen</a> and <a href="#proof-verification-proofverify">ProofVerify</a>, as part of the Fiat-Shamir heuristic, for making the proof protocol non-interactive (in a interactive setting, the challenge would be a random value supplied by the verifier).<a href="#section-3.5.4-1" class="pilcrow">¶</a></p>
<p id="section-3.5.4-2">This operation makes use of the <code>serialize</code> function, defined in <a href="#serialize">Section 4.6.1</a>.<a href="#section-3.5.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.4-3">
<pre>challenge = ProofChallengeCalculate(init_res, i_array, msg_array, ph)

Inputs:
- init_res (REQUIRED), vector representing the value returned after
                       initializing the proof generation or verification
                       operations, consisting of 3 points of G1 and a
                       scalar value, in that order.
- i_array (REQUIRED), array of non-negative integers (the indexes of
                      the disclosed messages).
- msg_array (OPTIONAL), array of scalars (the disclosed messages after
                        mapped to scalars).
- ph (OPTIONAL), an octet string. If not supplied, it must default to the
                 empty octet string ("").

Outputs:

- challenge, a scalar.

Deserialization:

1. R = length(i_array)
2. (i1, ..., iR) = i_array
3. (msg_i1, ..., msg_iR) = msg_array
4. (Abar, Bbar, C, domain) = init_res

ABORT if:

1. R &gt; 2^64 - 1 or R != length(msg_array)
2. length(ph) &gt; 2^64 - 1

Procedure:

1. c_arr = (Abar, Bbar, C, R, i1, ..., iR, msg_i1, ..., msg_iR, domain)
2. c_octs = serialize(c_array)
3. return hash_to_scalar(c_octs || I2OSP(length(ph), 8) || ph)
</pre><a href="#section-3.5.4-3" class="pilcrow">¶</a>
</div>
<p id="section-3.5.4-4"><strong>Note</strong>: If the presentation header (ph) is not supplied in <code>ProofChallengeCalculate</code>, 8 bytes representing a length of 0 (i.e., <code>0x0000000000000000</code>), must still be appended after the <code>c_octs</code> value, during the concatenation step of the above procedure (step 3).<a href="#section-3.5.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="utility-operations">
<section id="section-4">
      <h2 id="name-utility-operations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-utility-operations" class="section-name selfRef">Utility Operations</a>
      </h2>
<div id="random-scalars">
<section id="section-4.1">
        <h3 id="name-random-scalars">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-random-scalars" class="section-name selfRef">Random Scalars</a>
        </h3>
<p id="section-4.1-1">This operation returns the requested number of pseudo-random scalars, using the <code>get_random</code> operation (see <a href="#parameters">Parameters</a>). The operation makes multiple calls to <code>get_random</code>. It is REQUIRED that each call will be independent from each other, as to ensure independence of the returned pseudo-random scalars.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2"><strong>Note</strong>: The security of the proof generation algorithm (<a href="#proof-generation-proofgen">ProofGen</a>) is highly dependant on the quality of the <code>get_random</code> function. Care must be taken to ensure that a cryptographically secure pseudo-random generator is chosen, and that its outputs are not leaked to an adversary. See also <a href="#randomness-requirements">Section 5.10</a> for more details.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-3">
<pre>random_scalars = calculate_random_scalars(count)

Inputs:

- count (REQUIRED), non negative integer. The number of pseudo random
                    scalars to return.

Parameters:

- get_random, a pseudo random function with extendable output, returning
              uniformly distributed pseudo random bytes.
- expand_len, defined by the ciphersuite.

Outputs:

- random_scalars, a list of pseudo random scalars,

Procedure:

1. for i in (1, ..., count):
2.     r_i = OS2IP(get_random(expand_len)) mod r
3. return (r_1, r_2, ..., r_count)
</pre><a href="#section-4.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="generators-calculation">
<section id="section-4.2">
        <h3 id="name-generators-calculation">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-generators-calculation" class="section-name selfRef">Generators Calculation</a>
        </h3>
<p id="section-4.2-1">A <code>create_generators</code> procedure defines how to create a set of randomly sampled points from the G1 subgroup, called the generators. Generators form a part of the public parameters used by the BBS Signature scheme to accomplish operations such as <a href="#signature-generation-sign">Sign</a>, <a href="#signature-verification-verify">Verify</a>, <a href="#proof-generation-proofgen">ProofGen</a> and <a href="#proof-verification-proofverify">ProofVerify</a>. A <code>create_generators</code> operation takes as input the following arguments,<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">count (REQUIRED), a non-negative integer describing the number of generator points to create, which is determined in part by the number of signed messages.<a href="#section-4.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-2.2">PK (OPTIONAL), a point of G2, representing the Signer's public key.<a href="#section-4.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-3">As a result, the create_generators operation has the following signature,<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-4">
<pre>(G_1, G_2, ..., G_count) = create_generators(count, PK)
</pre><a href="#section-4.2-4" class="pilcrow">¶</a>
</div>
<p id="section-4.2-5">Each procedure MUST define a unique <code>CREATE_GENERATORS_ID</code> to be used by the ciphersuite. This value MUST only contain ASCII encoded characters with codes between 0x21 and 0x7e (inclusive) and MUST end with an underscore (ASCII code: 0x5f), other than the last character the string MUST not contain any other underscores (ASCII code: 0x5f).<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<div id="hash-to-generators">
<section id="section-4.2.1">
          <h4 id="name-hash-to-generators">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-hash-to-generators" class="section-name selfRef">Hash to Generators</a>
          </h4>
<p id="section-4.2.1-1">The <code>hash_to_generators</code> operation makes use of the primitives defined in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> (more specifically of <code>hash_to_curve</code> and <code>expand_message</code>) to hash a predefined seed to a set of generators. Those primitives are implicitly defined by the ciphersuite, through the choice of a hash-to-curve suite (see the <code>hash_to_curve_suite</code> parameter in <a href="#ciphersuite-format" class="auto internal xref">Section 6.1</a>).<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2"><strong>NOTE</strong>: The <code>hash_to_generators</code> operation ignores the PK input, creating the same generators across different Signers and signatures. The final <code>create_generators</code> operation defined by the ciphersuites in <a href="#ciphersuites" class="auto internal xref">Section 6</a>, will be,<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-3">
<pre>create_generators(count, PK) := hash_to_generator(count)
</pre><a href="#section-4.2.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-4">Since <code>hash_to_generator</code> creates constant points, as an optimization, implementations MAY cache its result for a specific <code>count</code> (which can be arbitrarily large, depending on the application). Care must be taken, to guarantee that the generators will be fetched from the cache in the same order they had when they where created (i.e., an application should not short or in any way rearrange the cached generators).<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-5">
<pre>generators = hash_to_generators(count)

Inputs:

- count (REQUIRED), unsigned integer. Number of generators to create.

Parameters:

- hash_to_curve_g1, the hash_to_curve operation for the G1 subgroup,
                    defined by the suite specified by the
                    hash_to_curve_suite parameter of the ciphersuite.
- expand_message, the expand_message operation defined by the suite
                  specified by the hash_to_curve_suite parameter of the
                  ciphersuite.
- generator_seed, an octet string representing the seed from which the
                  generators are created, defined by the ciphersuite.

Definitions:

- seed_dst, an octet string representing the domain separation tag:
            ciphersuite_id || "SIG_GENERATOR_SEED_" where
            ciphersuite_id is defined by the ciphersuite and
            "SIG_GENERATOR_SEED_" is an ASCII string comprised of 19
            bytes.
- generator_dst, an octet string representing the domain separation tag:
                 ciphersuite_id || "SIG_GENERATOR_DST_", where
                 ciphersuite_id is defined by the ciphersuite and
                 "SIG_GENERATOR_DST_" is an ASCII string comprised of
                 18 bytes.
- expand_len, defined by the ciphersuite.

Outputs:

- generators, an array of generators.

ABORT if:

1. count &gt; 2^64 - 1

Procedure:

1. v = expand_message(generator_seed, seed_dst, expand_len)
2. for i in range(1, count):
3.    v = expand_message(v || I2OSP(i, 8), seed_dst, expand_len)
4.    generator_i = hash_to_curve_g1(v, generator_dst)
5. return (generator_1, ..., generator_count)
</pre><a href="#section-4.2.1-5" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-6">The value of <code>v</code> MAY also be cached in order to efficiently extend an existing list of cached generator points. The <code>CREATE_GENERATORS_ID</code> of the above operation is define as,<a href="#section-4.2.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-7">
<pre>CREATE_GENERATORS_ID = "H2G_"
</pre><a href="#section-4.2.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="defining-new-ways-to-create-generators">
<section id="section-4.2.2">
          <h4 id="name-defining-new-ways-to-create">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-defining-new-ways-to-create" class="section-name selfRef">Defining new ways to create generators</a>
          </h4>
<p id="section-4.2.2-1">When defining a new <code>create_generators</code> procedure, the most important property is that the returned points are pseudo-randomly chosen from the G1 group, given reasonable assumptions and cryptographic primitives. More specifically, the required properties are<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2-2.1">The returned points should be indistinguishable from <code>count</code> uniformly radom points of G1. This means that given only the points <code>H_1, ..., H_i</code> it should be infeasible to guess <code>H_(i+1)</code> (or any <code>H_j</code> with <code>j &gt; i</code>), for any <code>i</code> between 1 and <code>count</code>.<a href="#section-4.2.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.2.2-2.2">The returned points must be unique with very high probability, that would not lessen the targeted security level of the ciphersuite. Specifically, for a security level <code>k</code>, the probability of a collision should be at least <code>1/2^k</code>.<a href="#section-4.2.2-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.2.2-2.3">It should be infeasible to guess the discrete logarithm of the returned points, for any base, even with knowledge of the public parameters that were used to create those generators (like the <code>generator_seed</code> value in <a href="#hash-to-generators">Hash to Generators</a>). Note that pseudo randomness does not necessarily imply this property. For example, an implementation that repeatably hashes a public seed value to create exponents <code>r_1, r_2, ..., r_count</code> (where <code>r_1 = hash(seed), r_2 = hash(r_1), ...</code>) and then returns the points <code>H_1 = P1 * r_1, H_2 = P_1 * r_2, ..., H_count = P_1 * r_count</code> would be insecure (given knowledge of the seed), but given knowledge of only the points <code>H_1, ..., H_count</code>, the sequence would appear random.<a href="#section-4.2.2-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.2.2-2.4">The returned points must be different from the Identity point of G1 as well as the constant point <code>P1</code> defined by the ciphersuite.<a href="#section-4.2.2-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.2.2-2.5">Must be constant time for a specific <code>count</code> value.<a href="#section-4.2.2-2.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.2.2-2.6">Must be deterministic.<a href="#section-4.2.2-2.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.2.2-2.7">Must use proper domain separation for both the <code>create_generators</code> procedure, as well as all of the internally-called procedures.<a href="#section-4.2.2-2.7" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="messages-to-scalars">
<section id="section-4.3">
        <h3 id="name-messages-to-scalars">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-messages-to-scalars" class="section-name selfRef">Messages to Scalars</a>
        </h3>
<p id="section-4.3-1">The <code>messages_to_scalars</code> operation is used to map a list of input_messages (where each input_message can be either an octet string or a scalar value, as defined in <a href="#terminology">Terminology</a>) to their respective scalar values, which are required by the <a href="#signature-generation-sign">Sign</a>, <a href="#signature-verification-verify">Verify</a>, <a href="#proof-generation-proofgen">ProofGen</a> and <a href="#proof-verification-proofverify">ProofVerify</a> procedures.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">This operation uses the <code>map_to_scalar</code> sub-routine defined in <a href="#map-to-scalar" class="auto internal xref">Section 4.3.1</a>, to transform each message to a scalar value.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-3">
<pre>msg_scalar = messages_to_scalars(messages)

Inputs:

- messages (REQUIRED), a vector of input_messages.

Parameters:

- map_to_scalar, an operation that maps an input_message and its index
                 to a scalar value, defined by the ciphersuite.

Outputs:

- msg_scalars, a list of scalars.

ABORT if:

1. length(messages) &gt; 2^64 - 1

Procedure:

1. L =  length(messages)
2. for i in (1, ..., L):
3.     msg_scalar_i = map_to_scalar(messages[i], i)
4. return (msg_scalar_1, ..., msg_scalar_L)
</pre><a href="#section-4.3-3" class="pilcrow">¶</a>
</div>
<div id="map-to-scalar">
<section id="section-4.3.1">
          <h4 id="name-map-to-scalar">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-map-to-scalar" class="section-name selfRef">Map to Scalar</a>
          </h4>
<p id="section-4.3.1-1">As defined above, the <code>messages_to_scalars</code> operation works by repeatedly calling the <code>map_to_scalar</code> operation, that will be defined by the ciphersuite. The <code>map_to_scalar</code> operation accepts the following inputs,<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-2.1">message (REQUIRED), an input_message that can be either a scalar or an octet string (see <a href="#terminology">Terminology</a>).<a href="#section-4.3.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-2.2">index (OPTIONAL), a positive integer. The index the message has in the list of signed messages.<a href="#section-4.3.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.3.1-3">The signature of the operation is the following,<a href="#section-4.3.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.1-4">
<pre>msg_scalar = map_to_scalar(msg, index)
</pre><a href="#section-4.3.1-4" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1-5">Every <code>map_to_scalar</code> operation MUST define a unique <code>MAP_TO_SCALAR_ID</code> value to be used by the ciphersuite. This value MUST only contain ASCII encoded characters with codes between 0x21 and 0x7e (inclusive) and MUST end with an underscore (ASCII code: 0x5f), other than the last character the string MUST not contain any other underscores (ASCII code: 0x5f).<a href="#section-4.3.1-5" class="pilcrow">¶</a></p>
<div id="map-to-scalar-as-hash">
<section id="section-4.3.1.1">
            <h5 id="name-map-to-scalar-as-hash">
<a href="#section-4.3.1.1" class="section-number selfRef">4.3.1.1. </a><a href="#name-map-to-scalar-as-hash" class="section-name selfRef">Map to Scalar as Hash</a>
            </h5>
<p id="section-4.3.1.1-1">This document specifies the following <code>map_to_scalar</code> operation, called <code>map_to_scalar_as_hash</code>, that uses <code>hash_to_scalar</code> as defined in <a href="#hash-to-scalar" class="auto internal xref">Section 4.4</a>. Although for extendability reasons, the <code>map_to_scalar</code> operation accepts messages that can be either an octet string or a scalar value (as to support protocol specific preprocessing of a message), the <code>map_to_scalar_as_hash</code> operation used by this document only maps octet string to scalars and will abort if it gets an <code>input_message</code> that is already a scalar value. Additionally, the resulting scalar does not depend on the <code>index</code> of the message.<a href="#section-4.3.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.1.1-2">
<pre>scalar = map_to_scalar_as_hash(msg)

Inputs:

- msg (REQUIRED), an input_message

Parameters:

- dst = ciphersuite_id || "MAP_MSG_TO_SCALAR_AS_HASH_", where
        ciphersuite_id is defined by the ciphersuite.

Outputs:

- scalar, a scalar value.

ABORT if:

1. msg not an octet string

Procedure:

1. return hash_to_scalar(msg, dst)
</pre><a href="#section-4.3.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1.1-3">The <code>map_to_scalar</code> operation that will be defined by the ciphersuites of this document will be,<a href="#section-4.3.1.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.1.1-4">
<pre>map_to_scalar(msg, index) := map_to_scalar_as_hash(msg)
</pre><a href="#section-4.3.1.1-4" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1.1-5">The <code>MAP_TO_SCALAR_ID</code> of the <code>map_to_scalar_as_hash</code> operation is defines as,<a href="#section-4.3.1.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.1.1-6">
<pre>MAP_TO_SCALAR_ID = "HM2S_"
</pre><a href="#section-4.3.1.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="define-a-new-map-to-scalar">
<section id="section-4.3.2">
          <h4 id="name-define-a-new-map-to-scalar">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-define-a-new-map-to-scalar" class="section-name selfRef">Define a new Map to Scalar</a>
          </h4>
<p id="section-4.3.2-1">To define different ways with which messages can be mapped to scalars, an application can define a new <code>map_to_scalar</code> operation, as part of a new ciphersuite. A new <code>map_to_scalar</code> function is REQUIRED to adhere to the following security rules:<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2-2">
<li id="section-4.3.2-2.1">It MUST return unique values for different <code>msg</code> inputs. More specifically, the probability of a collision under reasonable cryptographic assumptions MUST be at most <code>1/2^k</code>, where <code>k</code> the security level of the targeted ciphersuite.<a href="#section-4.3.2-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.3.2-2.2">Different outputs MUST be independent. More specifically, knowledge of the <code>scalar_1 = map_to_scalar(msg_1, idx_1)</code>, should not give any information on the value of <code>scalar_2 = map_to_scalar(msg_2, idx_2)</code>, for any other <code>(msg_2, idx_2)</code> input pair.<a href="#section-4.3.2-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.3.2-2.3">It MUST be deterministic.<a href="#section-4.3.2-2.3" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="hash-to-scalar">
<section id="section-4.4">
        <h3 id="name-hash-to-scalar">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-hash-to-scalar" class="section-name selfRef">Hash to Scalar</a>
        </h3>
<p id="section-4.4-1">This operation describes how to hash an arbitrary octet string to <code>n</code> scalar values in the multiplicative group of integers mod r (i.e., values in the range [1, r-1]).  This procedure acts as a helper function, used internally in various places within the operations described in the spec. To hash a message to a scalar that would be passed as input to the <a href="#sisignature-generation-signgn">Sign</a>, <a href="#signature-verification-verify">Verify</a>, <a href="#proof-generation-proofgen">ProofGen</a> and <a href="#proof-verification-proofverify">ProofVerify</a> functions, one must use <a href="#mapmessagetoscalar">MapMessageToScalarAsHash</a> instead.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">The operation takes as input an octet string representing the message to hash (msg), the number of the scalars to return (count) as well as an optional domain separation tag (dst). The length of the dst MUST be less than 255 octets. See section 5.3.3 of <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> for guidance on using larger dst values. If a dst is not supplied, its value MUST default to the octet string returned from ciphersuite_id || "H2S_", where ciphersuite_id is the octet string representing the unique ID of the ciphersuite and "H2S_" is an ASCII string comprised of 4 bytes.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3"><strong>Note</strong> This operation makes use of <code>expand_message</code> defined in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>. The operation <code>expand_message</code> may fail (abort). In that case, <code>hash_to_scalar</code> MUST also ABORT.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-4">
<pre>hashed_scalar = hash_to_scalar(msg_octets, dst)

Inputs:

- msg_octets (REQUIRED), an octet string. The message to be hashed.
- dst (OPTIONAL), an octet string representing a domain separation tag.
                  If not supplied, it defaults to the octet string given
                  by ciphersuite_id || "H2S_", where ciphersuite_id is
                  defined by the ciphersuite.

Parameters:

- hash_to_curve_suite, the hash to curve suite id defined by the
                       ciphersuite.
- expand_message, the expand_message operation defined by the suite
                  specified by the hash_to_curve_suite parameter.
- expand_len, defined by the ciphersuite.

Outputs:

- hashed_scalar, a scalar.

ABORT if:

- length(dst) &gt; 255

Procedure:

1. uniform_bytes = expand_message(msg_octets, dst, expand_len)
2. return OS2IP(uniform_bytes) mod r
</pre><a href="#section-4.4-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="domain-calculation">
<section id="section-4.5">
        <h3 id="name-domain-calculation">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-domain-calculation" class="section-name selfRef">Domain Calculation</a>
        </h3>
<p id="section-4.5-1">This operation calculates the domain value, a scalar representing the distillation of all essential contextual information for a signature. The same domain value must be calculated by all parties (the signer, the prover, and the verifier) for both the signature and proofs to be validated.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">The input to the domain value includes an octet string called the header, chosen by the signer and meant to encode any information that is required to be revealed by the prover (such as an expiration date, or an identifier for the target audience). This is in contrast to the signed message values, which may be withheld during a proof.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">When a signature is calculated, the domain value is combined with a specific generator point (<code>Q_1</code>, see <a href="#signature-generation-sign">Sign</a>) to protect the integrity of the public parameters and the header.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">This operation makes use of the <code>serialize</code> function, defined in <a href="#serialize">Section 4.6.1</a>.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-5">
<pre>domain = calculate_domain(PK, Q_1, H_Points, header)

Inputs:

- PK (REQUIRED), an octet string, representing the public key of the
                 Signer of the form outputted by the SkToPk operation.
- Q_1 (REQUIRED), point of G1 (the first point returned from
                  create_generators).
- H_Points (REQUIRED), array of points of G1.
- header (OPTIONAL), an octet string. If not supplied, it must default
                     to the empty octet string ("").

Parameters:

- ciphersuite_id, an octet string. The unique ID of the ciphersuite.

Outputs:

- domain, a scalar.

Deserialization:

1. L = length(H_Points)
2. (H_1, ..., H_L) = H_Points

ABORT if:

1. length(header) &gt; 2^64 - 1 or L &gt; 2^64 - 1

Procedure:

1. dom_array = (L, Q_1, H_1, ..., H_L)
2. dom_octs = serialize(dom_array) || ciphersuite_id
3. dom_input = PK || dom_octs || I2OSP(length(header), 8) || header
4. return hash_to_scalar(dom_input)
</pre><a href="#section-4.5-5" class="pilcrow">¶</a>
</div>
<p id="section-4.5-6"><strong>Note</strong>: If the header is not supplied in <code>calculate_domain</code>, it defaults to the empty octet string (""). This means that in the concatenation step of the above procedure (step 3), 8 bytes representing a length of 0 (i.e., <code>0x0000000000000000</code>), will still need to be appended at the end, even though a header value is not provided.<a href="#section-4.5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="serialization">
<section id="section-4.6">
        <h3 id="name-serialization">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-serialization" class="section-name selfRef">Serialization</a>
        </h3>
<div id="serialize">
<section id="section-4.6.1">
          <h4 id="name-serialize">
<a href="#section-4.6.1" class="section-number selfRef">4.6.1. </a><a href="#name-serialize" class="section-name selfRef">Serialize</a>
          </h4>
<p id="section-4.6.1-1">This operation describes how to transform multiple elements of different types (i.e., elements that are not already in a octet string format) to a single octet string (see <a href="#serializing-to-octets" class="auto internal xref">Section 3.2.3</a>). The inputted elements can be points, scalars (see <a href="#terminology">Terminology</a>) or integers between 0 and 2^64-1. The resulting octet string will then either be used as an input to a hash function (i.e., in <a href="#signature-generation-sign">Sign</a>, <a href="#proof-generation-proofgen">ProofGen</a> etc.), or to serialize a signature or proof (see <a href="#signaturetooctets">SignatureToOctets</a> and <a href="#prooftooctets">ProofToOctets</a>).<a href="#section-4.6.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.6.1-2">
<pre>octets_result = serialize(input_array)

Inputs:

- input_array (REQUIRED), an array of elements to be serialized. Each
                          element must be either a point of G1 or G2, a
                          scalar, an ASCII string or an integer value
                          between 0 and 2^64 - 1.

Parameters:

- octet_scalar_length, non-negative integer. The length of a scalar
                       octet representation, defined by the ciphersuite.
- r, the prime order of the subgroups G1 and G2, defined by the
     ciphersuite.
- point_to_octets_g*, operations that serialize a point of G1 or G2 to
                      an octet string of fixed length, defined by the
                      ciphersuite.

Outputs:

- octets_result, a scalar value or INVALID.

Procedure:

1.  let octets_result be an empty octet string.
2.  for el in input_array:
3.      if el is a point of G1: el_octs = point_to_octets_g1(el)
4.      else if el is a point of G2: el_octs = point_to_octets_g2(el)
5.      else if el is a scalar: el_octs = I2OSP(el, octet_scalar_length)
6.      else if el is an integer between 0 and 2^64 - 1:
7.          el_octs = I2OSP(el, 8)
8.      else: return INVALID
9.      octets_result = octets_result || el_octs
10. return octets_result
</pre><a href="#section-4.6.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="signature-to-octets">
<section id="section-4.6.2">
          <h4 id="name-signature-to-octets">
<a href="#section-4.6.2" class="section-number selfRef">4.6.2. </a><a href="#name-signature-to-octets" class="section-name selfRef">Signature to Octets</a>
          </h4>
<p id="section-4.6.2-1">This operation describes how to encode a signature to an octet string.<a href="#section-4.6.2-1" class="pilcrow">¶</a></p>
<p id="section-4.6.2-2"><em>Note</em> this operation deliberately does not perform the relevant checks on the inputs <code>A</code> and <code>e</code>
because its assumed these are done prior to its invocation, e.g as is the case with the <a href="#signature-generation-sign">Sign</a> operation.<a href="#section-4.6.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.6.2-3">
<pre>signature_octets = signature_to_octets(signature)

Inputs:

- signature (REQUIRED), a valid signature, in the form (A, e), where
                        A is a point in G1 and e is a non-zero scalar mod r.

Outputs:

- signature_octets, an octet string or INVALID.

Procedure:

1. (A, e) = signature
2. return serialize((A, e))
</pre><a href="#section-4.6.2-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="octets-to-signature">
<section id="section-4.6.3">
          <h4 id="name-octets-to-signature">
<a href="#section-4.6.3" class="section-number selfRef">4.6.3. </a><a href="#name-octets-to-signature" class="section-name selfRef">Octets to Signature</a>
          </h4>
<p id="section-4.6.3-1">This operation describes how to decode an octet string, validate it and return the underlying components that make up the signature.<a href="#section-4.6.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.6.3-2">
<pre>signature = octets_to_signature(signature_octets)

Inputs:

- signature_octets (REQUIRED), an octet string of the form output from
                               signature_to_octets operation.

Outputs:

signature, a signature in the form (A, e), where A is a point in G1
           and e is a non-zero scalar mod r.

Procedure:

1.  expected_len = octet_point_length + octet_scalar_length
2.  if length(signature_octets) != expected_len, return INVALID
3.  A_octets = signature_octets[0..(octet_point_length - 1)]
4.  A = octets_to_point_g1(A_octets)
5.  if A is INVALID, return INVALID
6.  if A == Identity_G1, return INVALID
7.  index = octet_point_length
8.  end_index = index + octet_scalar_length - 1
9.  e = OS2IP(signature_octets[index..end_index])
10. if e = 0 OR e &gt;= r, return INVALID
11. return (A, e)
</pre><a href="#section-4.6.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="proof-to-octets">
<section id="section-4.6.4">
          <h4 id="name-proof-to-octets">
<a href="#section-4.6.4" class="section-number selfRef">4.6.4. </a><a href="#name-proof-to-octets" class="section-name selfRef">Proof to Octets</a>
          </h4>
<p id="section-4.6.4-1">This operation describes how to encode a proof, as computed at step 25 in <a href="#proof-generation-proofgen">ProofGen</a>, to an octet string. The input to the operation MUST be a valid proof.<a href="#section-4.6.4-1" class="pilcrow">¶</a></p>
<p id="section-4.6.4-2">The inputted proof value must consist of the following components, in that order:<a href="#section-4.6.4-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.6.4-3">
<li id="section-4.6.4-3.1">Two (2) valid points of the G1 subgroup, different from the identity point of G1 (i.e., <code>Abar, Bbar</code>, in ProofGen)<a href="#section-4.6.4-3.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.6.4-3.2">Three (3) integers representing scalars in the range of 1 to r-1 inclusive (i.e., <code>c, r2^, r3^</code>, in ProofGen).<a href="#section-4.6.4-3.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.6.4-3.3">A number of integers representing scalars in the range of 1 to r-1 inclusive, corresponding to the undisclosed from the proof messages (i.e., <code>m^_j1, ..., m^_jU</code>, in ProofGen, where U the number of undisclosed messages).<a href="#section-4.6.4-3.3" class="pilcrow">¶</a>
</li>
          </ol>
<div class="alignLeft art-text artwork" id="section-4.6.4-4">
<pre>proof_octets = proof_to_octets(proof)

Inputs:

- proof (REQUIRED), a BBS proof in the form calculated by ProofGen in
                    step 27 (see above).

Parameters:

- octet_scalar_length (REQUIRED), non-negative integer. The length of
                                  a scalar octet representation, defined
                                  by the ciphersuite.

Outputs:

- proof_octets, an octet string or INVALID.

Procedure:

1. (Abar, Bbar, r2^, r3^, (m^_1, ..., m^_U), c) = proof
2. return serialize((Abar, Bbar, r2^, r3^, m^_1, ..., m^_U, c))
</pre><a href="#section-4.6.4-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="octets-to-proof">
<section id="section-4.6.5">
          <h4 id="name-octets-to-proof">
<a href="#section-4.6.5" class="section-number selfRef">4.6.5. </a><a href="#name-octets-to-proof" class="section-name selfRef">Octets to Proof</a>
          </h4>
<p id="section-4.6.5-1">This operation describes how to decode an octet string representing a proof, validate it and return the underlying components that make up the proof value.<a href="#section-4.6.5-1" class="pilcrow">¶</a></p>
<p id="section-4.6.5-2">The proof value outputted by this operation consists of the following components, in that order:<a href="#section-4.6.5-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.6.5-3">
<li id="section-4.6.5-3.1">Two (2) valid points of the G1 subgroup, each of which must not equal the identity point.<a href="#section-4.6.5-3.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.6.5-3.2">Two (2) integers representing scalars in the range of 1 to r-1 inclusive.<a href="#section-4.6.5-3.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.6.5-3.3">A set of integers representing scalars in the range of 1 to r-1 inclusive, corresponding to the undisclosed from the proof message commitments. This set can be empty (i.e., "()").<a href="#section-4.6.5-3.3" class="pilcrow">¶</a>
</li>
            <li id="section-4.6.5-3.4">One (1) integer representing a scalar in the range of 1 to r-1 inclusive, corresponding to the proof's challenge (<code>c</code>).<a href="#section-4.6.5-3.4" class="pilcrow">¶</a>
</li>
          </ol>
<div class="alignLeft art-text artwork" id="section-4.6.5-4">
<pre>proof = octets_to_proof(proof_octets)

Inputs:

- proof_octets (REQUIRED), an octet string of the form outputted from the
                           proof_to_octets operation.

Parameters:

- r (REQUIRED), non-negative integer. The prime order of the G1 and
                G2 groups, defined by the ciphersuite.
- octet_scalar_length (REQUIRED), non-negative integer. The length of
                                  a scalar octet representation, defined
                                  by the ciphersuite.
- octet_point_length (REQUIRED), non-negative integer. The length of
                                 a point in G1 octet representation,
                                 defined by the ciphersuite.

Outputs:

- proof, a proof value in the form described above or INVALID

Procedure:

1.  proof_len_floor = 2 * octet_point_length + 3 * octet_scalar_length
2.  if length(proof_octets) &lt; proof_len_floor, return INVALID

// Points (i.e., (Abar, Bbar) in ProofGen) de-serialization.
3.  index = 0
4.  for i in range(0, 1):
5.      end_index = index + octet_point_length - 1
6.      A_i = octets_to_point_g1(proof_octets[index..end_index])
7.      if A_i is INVALID or Identity_G1, return INVALID
8.      index += octet_point_length

// Scalars (i.e., (r2^, r3^, m^_j1, ..., m^_jU, c) in
// ProofGen) de-serialization.
9.  j = 0
10. while index &lt; length(proof_octets):
11.     end_index = index + octet_scalar_length - 1
12.     s_j = OS2IP(proof_octets[index..end_index])
13.     if s_j = 0 or if s_j &gt;= r, return INVALID
14.     index += octet_scalar_length
15.     j += 1

16. if index != length(proof_octets), return INVALID
17. msg_commitments = ()
18. If j &gt; 3, set msg_commitments = (s_2, ..., s_(j-2))
19. return (A_0, A_1, s_0, s_1, msg_commitments, s_(j-1))
</pre><a href="#section-4.6.5-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="octets-to-public-key">
<section id="section-4.6.6">
          <h4 id="name-octets-to-public-key">
<a href="#section-4.6.6" class="section-number selfRef">4.6.6. </a><a href="#name-octets-to-public-key" class="section-name selfRef">Octets to Public Key</a>
          </h4>
<p id="section-4.6.6-1">This operation describes how to decode an octet string representing a public key, validates it and returns the corresponding point in G2. Steps 2 to 5 check if the public key is valid. As an optimization, implementations MAY cache the result of those steps, to avoid unnecessarily repeating validation for known public keys.<a href="#section-4.6.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.6.6-2">
<pre>W = octets_to_pubkey(PK)

Inputs:

- PK, an octet string. A public key in the form outputted by the SkToPK
      operation

Outputs:

- W, a valid point in G2 or INVALID

Procedure:

1. W = octets_to_point_g2(PK)
2. If W is INVALID, return INVALID
3. if subgroup_check(W) is INVALID, return INVALID
4. If W == Identity_G2, return INVALID
5. return W
</pre><a href="#section-4.6.6-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="validating-public-keys">
<section id="section-5.1">
        <h3 id="name-validating-public-keys">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-validating-public-keys" class="section-name selfRef">Validating Public Keys</a>
        </h3>
<p id="section-5.1-1">It is RECOMENDED for any operation in <a href="#core-operations">Core Operations</a> involving public keys, that they deserialize the public key first using the <a href="#octetstopublickey">OctetsToPublicKey</a> operation, even if they only require the octet-string representation of the public key. If the <code>octets_to_pubkey</code> procedure (see the <a href="#octetstopublickey">OctetsToPublicKey</a> section) returns INVALID, the calling operation should also return INVALID and abort. An example of where this recommendation applies is the <a href="#sign">Sign</a> operation. An example of where an explicit invocation to the <code>octets_to_pubkey</code> operation is already defined and therefore required is the <a href="#signature-verification-verify">Verify</a> operation.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="point-deserialization">
<section id="section-5.2">
        <h3 id="name-point-deserialization">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-point-deserialization" class="section-name selfRef">Point Deserialization</a>
        </h3>
<p id="section-5.2-1">This document makes use of <code>octet_to_point_g*</code> to parse octet strings to elliptic curve points (either in G1 or G2). It is assumed (even if not explicitly described) that the result of this operation will not be INVALID. If <code>octet_to_point_g*</code> returns INVALID, then the calling operation should immediately return INVALID as well and abort the operation. Note that the only place where the output is assumed to be VALID implicitly is in the <a href="#encodingforhash">EncodingForHash</a> section.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="skipping-membership-checks">
<section id="section-5.3">
        <h3 id="name-skipping-membership-checks">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-skipping-membership-checks" class="section-name selfRef">Skipping Membership Checks</a>
        </h3>
<p id="section-5.3-1">Some existing implementations skip the subgroup_check invocation in <a href="#signature-verification-verify">Verify</a>, whose purpose is ensuring that the signature is an element of a prime-order subgroup.  This check is REQUIRED of conforming implementations, for two reasons.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3-2">
<li id="section-5.3-2.1">
            <p id="section-5.3-2.1.1">For most pairing-friendly elliptic curves used in practice, the pairing operation e <a href="#notation" class="auto internal xref">Section 1.2</a> is undefined when its input points are not in the prime-order subgroups of E1 and E2. The resulting behavior is unpredictable, and may enable forgeries.<a href="#section-5.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.3-2.2">
            <p id="section-5.3-2.2.1">Even if the pairing operation behaves properly on inputs that are outside the correct subgroups, skipping the subgroup check breaks the strong unforgeability property <span>[<a href="#ADR02" class="cite xref">ADR02</a>]</span>.<a href="#section-5.3-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="side-channel-attacks">
<section id="section-5.4">
        <h3 id="name-side-channel-attacks">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-side-channel-attacks" class="section-name selfRef">Side Channel Attacks</a>
        </h3>
<p id="section-5.4-1">Implementations of the signing algorithm SHOULD protect the secret key from side-channel attacks.  One method for protecting against certain side-channel attacks is ensuring that the implementation executes exactly the same sequence of instructions and performs exactly the same memory accesses, for any value of the secret key. In other words, implementations on the underlying pairing-friendly elliptic curve SHOULD run in constant time.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="randomness-considerations">
<section id="section-5.5">
        <h3 id="name-randomness-considerations">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-randomness-considerations" class="section-name selfRef">Randomness Considerations</a>
        </h3>
<p id="section-5.5-1">The IKM input to KeyGen MUST be infeasible to guess and MUST be kept secret. One possibility is to generate IKM from a trusted source of randomness.  Guidelines on constructing such a source are outside the scope of this document.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">Secret keys MAY be generated using other methods; in this case they MUST be infeasible to guess and MUST be indistinguishable from uniformly random modulo r.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<p id="section-5.5-3">BBS proofs are nondeterministic, meaning care must be taken against attacks arising from using bad randomness, for example, the nonce reuse attack on ECDSA <span>[<a href="#HDWH12" class="cite xref">HDWH12</a>]</span>. It is RECOMMENDED that the presentation header used in this specification contain a nonce chosen at random from a trusted source of randomness, see the <a href="#presentation-header-selection" class="auto internal xref">Section 5.6</a> for additional considerations.<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<p id="section-5.5-4">When a trusted source of randomness is used, signatures and proofs are much harder to forge or break due to the use of multiple nonces.<a href="#section-5.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation-header-selection">
<section id="section-5.6">
        <h3 id="name-presentation-header-selecti">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-presentation-header-selecti" class="section-name selfRef">Presentation Header Selection</a>
        </h3>
<p id="section-5.6-1">The signature proofs of knowledge generated in this specification are created using a specified presentation header. A verifier-specified cryptographically random value (e.g., a nonce) featuring in the presentation header provides strong protections against replay attacks, and is RECOMMENDED in most use cases. In some settings, proofs can be generated in a non-interactive fashion, in which case verifiers MUST be able to verify the uniqueness of the presentation header values.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementing-hash-to-curve-g1">
<section id="section-5.7">
        <h3 id="name-implementing-hash_to_curve_">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-implementing-hash_to_curve_" class="section-name selfRef">Implementing hash_to_curve_g1</a>
        </h3>
<p id="section-5.7-1">The security analysis models hash_to_curve_g1 as random oracles.  It is crucial that these functions are implemented using a cryptographically secure hash function.  For this purpose, implementations MUST meet the requirements of <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<p id="section-5.7-2">In addition, ciphersuites MUST specify unique domain separation tags for hash_to_curve.  Some guidance around defining this can be found in <a href="#ciphersuites" class="auto internal xref">Section 6</a>.<a href="#section-5.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="choice-of-underlying-curve">
<section id="section-5.8">
        <h3 id="name-choice-of-underlying-curve">
<a href="#section-5.8" class="section-number selfRef">5.8. </a><a href="#name-choice-of-underlying-curve" class="section-name selfRef">Choice of Underlying Curve</a>
        </h3>
<p id="section-5.8-1">BBS signatures can be implemented on any pairing-friendly curve. However care MUST be taken when selecting one that is appropriate, this specification defines a ciphersuite for using the BLS12-381 curve in <a href="#ciphersuites" class="auto internal xref">Section 6</a> which as a curve achieves around 117 bits of security according to a recent NCC ZCash cryptography review <span>[<a href="#ZCASH-REVIEW" class="cite xref">ZCASH-REVIEW</a>]</span>.<a href="#section-5.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="proofgen-security">
<section id="section-5.9">
        <h3 id="name-proofgen-security">
<a href="#section-5.9" class="section-number selfRef">5.9. </a><a href="#name-proofgen-security" class="section-name selfRef">ProofGen Security</a>
        </h3>
<p id="section-5.9-1">The proof, as returned by ProofGen, is a zero-knowledge proof-of-knowledge <span>[<a href="#CDL16" class="cite xref">CDL16</a>]</span>. This guarantees that no information will be revealed about the signature itself or the undisclosed messages, from the output of ProofGen. Note that the security proofs in <span>[<a href="#CDL16" class="cite xref">CDL16</a>]</span> work on type 3 pairing setting. This means that G1 should be different from G2 and with no efficient isomorphism between them.<a href="#section-5.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="randomness-requirements">
<section id="section-5.10">
        <h3 id="name-randomness-requirements">
<a href="#section-5.10" class="section-number selfRef">5.10. </a><a href="#name-randomness-requirements" class="section-name selfRef">Randomness Requirements</a>
        </h3>
<p id="section-5.10-1"><a href="#proof-generation-proofgen">ProofGen</a> is by its nature a randomized algorithm, requiring the generation of multiple uniformly distributed, pseudo random scalars. This makes ProofGen vulnerable to bad entropy in certain applications. As an example of such application, consider systems that need to monitor and potentially restrict outbound traffic, in order to minimize data leakage during a breach. In such cases, the attacker could manipulate couple of bits in the output of the <code>get_random</code> function to create an undetected chanel out of the system. Although the applicability of such attacks is limited for most of the targeted use cases of the BBS scheme, some applications may want to take measures towards mitigating them. To that end, it is RECOMMENDED to use a deterministic RNG (like a ChaCha20 based deterministic RNG), seeded with a unique, uniformly random, single seed <span>[<a href="#DRBG" class="cite xref">DRBG</a>]</span>. This will limit the amount of bits the attacker can manipulate (note that some randomness is always needed).<a href="#section-5.10-1" class="pilcrow">¶</a></p>
<p id="section-5.10-2">In any case, the randomness used in ProofGen MUST be unique in each call and MUST have a distribution that is indistinguishable from uniform. If the random scalars are re-used, are created from "bad randomness" (for example with a known relationship to each other) or are in any way predictable, an adversary will be able to unveil the undisclosed from the proof messages or the hidden signature value. Naturally, a cryptographically secure pseudorandom number generator or pseudo random function is REQUIRED to implement the <code>get_random</code> functionality. See also <span>[<a href="#RFC8937" class="cite xref">RFC8937</a>]</span>, for recommendations on generating good randomness in cases where the Prover has direct or in-direct access to a secret key.<a href="#section-5.10-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ciphersuites">
<section id="section-6">
      <h2 id="name-ciphersuites">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-ciphersuites" class="section-name selfRef">Ciphersuites</a>
      </h2>
<p id="section-6-1">This section defines the format for a BBS ciphersuite. It also gives concrete ciphersuites based on the BLS12-381 pairing-friendly elliptic curve <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="ciphersuite-format">
<section id="section-6.1">
        <h3 id="name-ciphersuite-format">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-ciphersuite-format" class="section-name selfRef">Ciphersuite Format</a>
        </h3>
<div id="ciphersuite-id">
<section id="section-6.1.1">
          <h4 id="name-ciphersuite-id">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-ciphersuite-id" class="section-name selfRef">Ciphersuite ID</a>
          </h4>
<p id="section-6.1.1-1">The following section defines the format of the unique identifier for the ciphersuite denoted <code>ciphersuite_id</code>, which will be represented as an ASCII encoded octet string. The REQUIRED format for this string is<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.1-2">
<pre>  "BBS_" || H2C_SUITE_ID || CG_ID || MESSAGES_TO_SCALARS_ID || ADD_INFO
</pre><a href="#section-6.1.1-2" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-6.1.1-3.1">
              <p id="section-6.1.1-3.1.1">H2C_SUITE_ID is the suite ID of the hash-to-curve suite used to define the hash<em>to</em>curve function.<a href="#section-6.1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.1-3.2">
              <p id="section-6.1.1-3.2.1">CG_ID is the ID of the create generators used, i.e., <code>CREATE_GENERATORS_ID</code> as defined in the <a href="#generators-calculation" class="auto internal xref">Section 4.2</a> section.<a href="#section-6.1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.1-3.3">
              <p id="section-6.1.1-3.3.1">MAP_TO_SCALAR_ID is the ID of the map_to_scalar operation, as defined in <a href="#map-to-scalar" class="auto internal xref">Section 4.3.1</a>.<a href="#section-6.1.1-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.1-3.4">
              <p id="section-6.1.1-3.4.1">ADD_INFO is an optional octet string indicating any additional information used to uniquely qualify the ciphersuite. When present this value MUST only contain ASCII encoded characters with codes between 0x21 and 0x7e (inclusive) and MUST end with an underscore (ASCII code: 0x5f), other than the last character the string MUST not contain any other underscores (ASCII code: 0x5f).<a href="#section-6.1.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="additional-parameters">
<section id="section-6.1.2">
          <h4 id="name-additional-parameters">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-additional-parameters" class="section-name selfRef">Additional Parameters</a>
          </h4>
<p id="section-6.1.2-1">The parameters that each ciphersuite needs to define are generally divided into three main categories; the basic parameters (a hash function etc.,), the serialization operations (point_to_octets_g1 etc.,) and the generator parameters. See below for more details.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2"><strong>Basic parameters</strong>:<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-3.1">
              <p id="section-6.1.2-3.1.1">hash: a cryptographic hash function.<a href="#section-6.1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-3.2">
              <p id="section-6.1.2-3.2.1">octet_scalar_length: Number of bytes to represent a scalar value, in the multiplicative group of integers mod r, encoded as an octet string. It is RECOMMENDED this value be set to <code>ceil(log2(r)/8)</code>.<a href="#section-6.1.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-3.3">
              <p id="section-6.1.2-3.3.1">octet_point_length: Number of bytes to represent a point encoded as an octet string outputted by the <code>point_to_octets_g*</code> function. It is RECOMMENDED that this value is set to <code>ceil(log2(p)/8)</code>.<a href="#section-6.1.2-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-3.4">
              <p id="section-6.1.2-3.4.1">hash_to_curve_suite: The hash-to-curve ciphersuite id, in the form defined in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>. This defines the hash_to_curve_g1 (the hash_to_curve operation for the G1 subgroup, see the <a href="#notation">Notation</a> section) and the expand_message (either expand_message_xmd or expand_message_xof) operations used in this document.<a href="#section-6.1.2-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-3.5">
              <p id="section-6.1.2-3.5.1">expand_len: Must be defined to be at least <code>ceil((ceil(log2(r))+k)/8)</code>, where <code>log2(r)</code> and <code>k</code> are defined by each ciphersuite (see Section 5 in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> for a more detailed explanation of this definition).<a href="#section-6.1.2-3.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-3.6">
              <p id="section-6.1.2-3.6.1">P1: A fixed point in the G1 subgroup, different from the point BP1 (i.e., the base point of G1, see <a href="#terminology" class="auto internal xref">Section 1.1</a>). This leaves the base point "free", to be used with other protocols, like key commitment and proof of possession schemes (for example, like the one described in Section 3.3 of <span>[<a href="#I-D.irtf-cfrg-bls-signature" class="cite xref">I-D.irtf-cfrg-bls-signature</a>]</span>).<a href="#section-6.1.2-3.6.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.1.2-4"><strong>Serialization functions</strong>:<a href="#section-6.1.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-5.1">
              <p id="section-6.1.2-5.1.1">point_to_octets_g1:
a function that returns the canonical representation of the point P for the G1 subgroup as an octet string.<a href="#section-6.1.2-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-5.2">
              <p id="section-6.1.2-5.2.1">point_to_octets_g2:
a function that returns the canonical representation of the point P for the G2 subgroup as an octet string.<a href="#section-6.1.2-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-5.3">
              <p id="section-6.1.2-5.3.1">octets_to_point_g1:
a function that returns the point P in the subgroup G1 corresponding to the canonical representation ostr, or INVALID if ostr is not a valid output of <code>point_to_octets_g1</code>.<a href="#section-6.1.2-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-5.4">
              <p id="section-6.1.2-5.4.1">octets_to_point_g2:
a function that returns the point P in the subgroup G2 corresponding to the canonical representation ostr, or INVALID if ostr is not a valid output of <code>point_to_octets_g2</code>.<a href="#section-6.1.2-5.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.1.2-6"><strong>Generator parameters</strong>:<a href="#section-6.1.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-7.1">create_generators: the operation with which to create a set of generators. See <a href="#generators-calculation" class="auto internal xref">Section 4.2</a>.<a href="#section-6.1.2-7.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.1.2-8"><strong>Map to Scalar function</strong><a href="#section-6.1.2-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-9.1">map_to_scalars:
a function that maps a message to a scalars value, as defined in <a href="#map-to-scalar" class="auto internal xref">Section 4.3.1</a>.<a href="#section-6.1.2-9.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="bls12-381-ciphersuites">
<section id="section-6.2">
        <h3 id="name-bls12-381-ciphersuites">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-bls12-381-ciphersuites" class="section-name selfRef">BLS12-381 Ciphersuites</a>
        </h3>
<p id="section-6.2-1">The following two ciphersuites are based on the BLS12-381 elliptic curves defined in Section 4.2.1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>. The targeted security level of both suites in bits is <code>k = 128</code>. The number of bits of the order <code>r</code>, of the G1 and G2 subgroups, is <code>log2(r) = 255</code>. The base points <code>BP1</code> and <code>BP2</code> of G1 and G2 are the points <code>BP</code> and <code>BP'</code> correspondingly, as defined in Section 4.2.1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The first ciphersuite makes use of an extendable output function, and most specifically of SHAKE-256, as defined in Section 6.2 of <span>[<a href="#SHA3" class="cite xref">SHA3</a>]</span>. It also uses the hash-to-curve suite defined by this document in <a href="#bls12-381-hash_to_curve-def">Appendix A.1</a>, which also makes use of the SHAKE-256 function.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">The second ciphersuite uses SHA-256, as defined in Section 6.2 of <span>[<a href="#SHA2" class="cite xref">SHA2</a>]</span> and the BLS12-381 G1 hash-to-curve suite defined in Section 8.8.1 of the <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> document.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">Note that these two ciphersuites differ only in the hash function (SHAKE-256 vs SHA-256) and in the hash-to-curve suites used. The hash-to-curve suites differ in the <code>expand_message</code> variant and underlying hash function. More concretely, the <a href="#bls12-381-shake-256">BLS12-381-SHAKE-256</a> ciphersuite makes use of <code>expand_message_xof</code> with SHAKE-256, while <a href="#bls12-381-sha-256">BLS12-381-SHA-256</a> makes use of <code>expand_message_xmd</code> with SHA-256. Curve parameters are common between the two ciphersuites.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<div id="bls12-381-shake-256">
<section id="section-6.2.1">
          <h4 id="name-bls12-381-shake-256">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-bls12-381-shake-256" class="section-name selfRef">BLS12-381-SHAKE-256</a>
          </h4>
<p id="section-6.2.1-1"><strong>Basic parameters</strong>:<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-2.1">
              <p id="section-6.2.1-2.1.1">ciphersuite_id: "BBS_BLS12381G1_XOF:SHAKE-256_SSWU_RO_H2G_HM2S_"<a href="#section-6.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-2.2">
              <p id="section-6.2.1-2.2.1">hash: SHAKE-256 as defined in <span>[<a href="#SHA3" class="cite xref">SHA3</a>]</span>.<a href="#section-6.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-2.3">
              <p id="section-6.2.1-2.3.1">octet_scalar_length: 32, based on the RECOMMENDED approach of <code>ceil(log2(r)/8)</code>.<a href="#section-6.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-2.4">
              <p id="section-6.2.1-2.4.1">octet_point_length: 48, based on the RECOMMENDED approach of <code>ceil(log2(p)/8)</code>.<a href="#section-6.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-2.5">
              <p id="section-6.2.1-2.5.1">hash_to_curve_suite: "BLS12381G1_XOF:SHAKE-256_SSWU_RO_" as defined in <a href="#bls12-381-hash-to-curve-definition-using-shake-256">Appendix A.1</a> for the G1 subgroup.<a href="#section-6.2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-2.6">
              <p id="section-6.2.1-2.6.1">expand_len: 48 ( <code>= ceil((ceil(log2(r))+k)/8)</code>)<a href="#section-6.2.1-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-2.7">
              <p id="section-6.2.1-2.7.1">P1: The G1 point returned from the <code>hash_to_generators</code> procedure (<a href="#hash-to-generators" class="auto internal xref">Section 4.2.1</a>), with <code>count = 1</code> and generator_seed = ciphersuite_id || "BP_MESSAGE_GENERATOR_SEED". More specifically,<a href="#section-6.2.1-2.7.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.1-2.7.2">
<pre>P1 = "8929dfbc7e6642c4ed9cba0856e493f8b9d7d5fcb0c31ef8fdcd34d50648a56c795e106
e9eada6e0bda386b414150755"
</pre><a href="#section-6.2.1-2.7.2" class="pilcrow">¶</a>
</div>
</li>
          </ul>
<p id="section-6.2.1-3"><strong>Serialization functions</strong>:<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-4.1">
              <p id="section-6.2.1-4.1.1">point_to_octets_g1: follows the format documented in Appendix C section 1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the G1 subgroup, using compression (i.e., setting C_bit = 1).<a href="#section-6.2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-4.2">
              <p id="section-6.2.1-4.2.1">point_to_octets_g2: follows the format documented in Appendix C section 1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the G2 subgroup, using compression (i.e., setting C_bit = 1).<a href="#section-6.2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-4.3">
              <p id="section-6.2.1-4.3.1">octets_to_point_g1: follows the format documented in Appendix C section 2 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the G1 subgroup.<a href="#section-6.2.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-4.4">
              <p id="section-6.2.1-4.4.1">octets_to_point_g2: follows the format documented in Appendix C section 2 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the G2 subgroup.<a href="#section-6.2.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.2.1-5"><strong>Generator parameters</strong>:<a href="#section-6.2.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-6.1">
              <p id="section-6.2.1-6.1.1">create_generators: the operation is using hash_to_generators as defined in <a href="#hash-to-generators" class="auto internal xref">Section 4.2.1</a>, with generator_seed = ciphersuite_id || "MESSAGE_GENERATOR_SEED" and the expand_message and hash_to_curve_g1 defined by the hash_to_curve_suite,<a href="#section-6.2.1-6.1.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.1-6.1.2">
<pre>create_generators(count, PK) := hash_to_generators(count)
</pre><a href="#section-6.2.1-6.1.2" class="pilcrow">¶</a>
</div>
</li>
          </ul>
<p id="section-6.2.1-7"><strong>Map to Scalar function</strong>:<a href="#section-6.2.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-8.1">map_to_scalar: map_to_scalar_as_hash (<a href="#map-to-scalar-as-hash" class="auto internal xref">Section 4.3.1.1</a>)<a href="#section-6.2.1-8.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="bls12-381-sha-256">
<section id="section-6.2.2">
          <h4 id="name-bls12-381-sha-256">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-bls12-381-sha-256" class="section-name selfRef">BLS12-381-SHA-256</a>
          </h4>
<p id="section-6.2.2-1"><strong>Basic parameters</strong>:<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.2-2.1">
              <p id="section-6.2.2-2.1.1">Ciphersuite_ID: "BBS_BLS12381G1_XMD:SHA-256_SSWU_RO_H2G_HM2S_"<a href="#section-6.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-2.2">
              <p id="section-6.2.2-2.2.1">hash: SHA-256 as defined in <span>[<a href="#SHA2" class="cite xref">SHA2</a>]</span>.<a href="#section-6.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-2.3">
              <p id="section-6.2.2-2.3.1">octet_scalar_length: 32, based on the RECOMMENDED approach of <code>ceil(log2(r)/8)</code>.<a href="#section-6.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-2.4">
              <p id="section-6.2.2-2.4.1">octet_point_length: 48, based on the RECOMMENDED approach of <code>ceil(log2(p)/8)</code>.<a href="#section-6.2.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-2.5">
              <p id="section-6.2.2-2.5.1">hash_to_curve_suite: "BLS12381G1_XMD:SHA-256_SSWU_RO_" as defined in Section 8.8.1 of the <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> for the G1 subgroup.<a href="#section-6.2.2-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-2.6">
              <p id="section-6.2.2-2.6.1">expand_len: 48 ( <code>= ceil((ceil(log2(r))+k)/8)</code>)<a href="#section-6.2.2-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-2.7">
              <p id="section-6.2.2-2.7.1">P1: The G1 point returned from the <code>hash_to_generators</code> procedure, with <code>count = 1</code> and generator_seed = ciphersuite_id || "BP_MESSAGE_GENERATOR_SEED". More specifically,<a href="#section-6.2.2-2.7.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.2-2.7.2">
<pre>P1 = "a8ce256102840821a3e94ea9025e4662b205762f9776b3a766c872b948f1fd225e7c596
98588e70d11406d161b4e28c9"
</pre><a href="#section-6.2.2-2.7.2" class="pilcrow">¶</a>
</div>
</li>
          </ul>
<p id="section-6.2.2-3"><strong>Serialization functions</strong>:<a href="#section-6.2.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.2-4.1">
              <p id="section-6.2.2-4.1.1">point_to_octets_g1: follows the format documented in Appendix C section 1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the G1 subgroup, using compression (i.e., setting C_bit = 1).<a href="#section-6.2.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-4.2">
              <p id="section-6.2.2-4.2.1">point_to_octets_g2: follows the format documented in Appendix C section 1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the G2 subgroup, using compression (i.e., setting C_bit = 1).<a href="#section-6.2.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-4.3">
              <p id="section-6.2.2-4.3.1">octets_to_point_g1: follows the format documented in Appendix C section 2 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the G1 subgroup.<a href="#section-6.2.2-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-4.4">
              <p id="section-6.2.2-4.4.1">octets_to_point_g2: follows the format documented in Appendix C section 2 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the G2 subgroup.<a href="#section-6.2.2-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.2.2-5"><strong>Generator parameters</strong>:<a href="#section-6.2.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.2-6.1">
              <p id="section-6.2.2-6.1.1">create_generators: the operation is using hash_to_generators as defined in <a href="#hash-to-generators" class="auto internal xref">Section 4.2.1</a>, with generator_seed = ciphersuite_id || "MESSAGE_GENERATOR_SEED" and the expand_message and hash_to_curve_g1 defined by the hash_to_curve_suite,<a href="#section-6.2.2-6.1.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.2-6.1.2">
<pre>create_generators(count, PK) := hash_to_generators(count)
</pre><a href="#section-6.2.2-6.1.2" class="pilcrow">¶</a>
</div>
</li>
          </ul>
<p id="section-6.2.2-7"><strong>Map to Scalar function</strong>:<a href="#section-6.2.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.2-8.1">map_to_scalar: map_to_scalar_as_hash (<a href="#map-to-scalar-as-hash" class="auto internal xref">Section 4.3.1.1</a>)<a href="#section-6.2.2-8.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="test-vectors">
<section id="section-7">
      <h2 id="name-test-vectors">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="section-7-1">The following section details a basic set of test vectors that can be used to confirm an implementations correctness<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2"><strong>NOTE</strong> All binary data below is represented as octet strings in big endian order, encoded in hexadecimal format.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3"><strong>NOTE</strong> These fixtures are a work in progress and subject to change.<a href="#section-7-3" class="pilcrow">¶</a></p>
<div id="mocked-random-scalars">
<section id="section-7.1">
        <h3 id="name-mocked-random-scalars">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-mocked-random-scalars" class="section-name selfRef">Mocked Random Scalars</a>
        </h3>
<p id="section-7.1-1">For the purpose of presenting fixtures for the <a href="#proof-generation-proofgen">ProofGen</a> operation we describe here a way to mock the <code>calculate_random_scalars</code> operation (<a href="#random-scalars">Random scalars computation</a>), used by <code>ProofGen</code> to create all the necessary random scalars.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">To that end, the <code>seeded_random_scalars(SEED)</code> operation is defined, which will deterministically calculate <code>count</code> random-looking scalars from a single <code>SEED</code>. The proof test vector will then define a <code>SEED</code> (as a nothing-up-my-sleeve value) and set<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.1-3">
<pre>mocked_calculate_random_scalars(count) :=
                             seeded_random_scalars(SEED, count)
</pre><a href="#section-7.1-3" class="pilcrow">¶</a>
</div>
<p id="section-7.1-4">The <code>mocked_calculate_random_scalars</code> operation will then be used in place of <code>calculate_random_scalars</code> during the <a href="#proof-generation-proofgen">ProofGen</a> operation's procedure.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5"><strong>Note</strong> For the <a href="#bls12-381-sha-256">BLS12-381-SHA-256</a> ciphersuite if more than 170 mocked random scalars are required, the operation will return INVALID. Similarly, for the <a href="#bls12-381-shake-256">BLS12-381-SHAKE-256</a> ciphersuite, if more than 1365 mocked random scalars are required, the operation will return INVALID. For the purpose of describing <a href="#proof-generation-proofgen">ProofGen</a> test vectors, those limits are inconsequential.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.1-6">
<pre>seeded_scalars = seeded_random_scalars(SEED, count)

Inputs:

- count (REQUIRED), non negative integer. The number of scalars to
                    return.
- SEED (REQUIRED), an octet string. The random seed from which to generate
                   the scalars.

Parameters:

- expand_message, the expand_message operation defined by the
                  ciphersuite.
- expand_len, defined by the ciphersuite.
- dst = ciphersuite_id || "MOCK_RANDOM_SCALARS_DST_", where
        ciphersuite_id is defined by the ciphersuite.

Outputs:

- mocked_random_scalars, a list of "count" pseudo random scalars

ABORT if:

1. count * expand_len &gt; 65535

Procedure:

1. out_len = expand_len * count
2. v = expand_message(SEED, dst, out_len)
3. if v is INVALID, return INVALID

4. for i in (1, ..., count):
5.     start_idx = (i-1) * expand_len
6.     end_idx = i * expand_len - 1
7.     r_i = OS2IP(v[start_idx..end_idx]) mod r
8. return (r_1, ...., r_count)
</pre><a href="#section-7.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="messages">
<section id="section-7.2">
        <h3 id="name-messages">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-messages" class="section-name selfRef">Messages</a>
        </h3>
<p id="section-7.2-1">The following messages are used by the test vectors of both ciphersuites (unless otherwise stated). All the listed messages represent hex-encoded octet strings.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2-2">
<pre>"9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"

"c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"

"7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"

"77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"

"496694774c5604ab1b2544eababcf0f53278ff50"

"515ae153e22aae04ad16f759e07237b4"

"d183ddc6e2665aa4e2f088af"

"ac55fb33a75909ed"

"96012096"

""
</pre><a href="#section-7.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="bls12-381-shake-256-test-vectors">
<section id="section-7.3">
        <h3 id="name-bls12-381-shake-256-test-ve">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-bls12-381-shake-256-test-ve" class="section-name selfRef">BLS12-381-SHAKE-256 Test Vectors</a>
        </h3>
<p id="section-7.3-1">Test vectors of the <a href="#bls12-381-shake-256-ciphersuite">BLS12-381-SHAKE-256</a> ciphersuite. Further fixtures are available in <a href="#additional-bls12-381-shake-256-ciphersuite-test-vectors">additional BLS12-381-SHAKE-256 test vectors</a>.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<div id="key-pair">
<section id="section-7.3.1">
          <h4 id="name-key-pair">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-key-pair" class="section-name selfRef">Key Pair</a>
          </h4>
<p id="section-7.3.1-1">The following key pair will be used for the test vectors of the <a href="#bls12-381-shake-256-ciphersuite">BLS12-381-SHAKE-256</a> ciphersuite.<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<p id="section-7.3.1-2">Following the procedure defined in <a href="#secret-key" class="auto internal xref">Section 3.3.1</a> with an input <code>key_material</code> value as follows<a href="#section-7.3.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.1-3">
<pre>"746869732d49532d6a7573742d616e2d546573742d494b4d2d746f2d67656e657261746
52d246528724074232d6b6579"
</pre><a href="#section-7.3.1-3" class="pilcrow">¶</a>
</div>
<p id="section-7.3.1-4">and the following <code>key_info</code> value<a href="#section-7.3.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.1-5">
<pre>"746869732d49532d736f6d652d6b65792d6d657461646174612d746f2d62652d7573656
42d696e2d746573742d6b65792d67656e"
</pre><a href="#section-7.3.1-5" class="pilcrow">¶</a>
</div>
<p id="section-7.3.1-6">Outputs the following SK value<a href="#section-7.3.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.1-7">
<pre>"2eee0f60a8a3a8bec0ee942bfd46cbdae9a0738ee68f5a64e7238311cf09a079"
</pre><a href="#section-7.3.1-7" class="pilcrow">¶</a>
</div>
<p id="section-7.3.1-8">Following the procedure defined in <a href="#public-key" class="auto internal xref">Section 3.3.2</a> with an input SK value as above produces the following PK value<a href="#section-7.3.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.1-9">
<pre>"92d37d1d6cd38fea3a873953333eab23a4c0377e3e049974eb62bd45949cdeb18fb0490
edcd4429adff56e65cbce42cf188b31bddbd619e419b99c2c41b38179eb001963bc3deca
ae0d9f702c7a8c004f207f46c734a5eae2e8e82833f3e7ea5"
</pre><a href="#section-7.3.1-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="map-messages-to-scalars">
<section id="section-7.3.2">
          <h4 id="name-map-messages-to-scalars">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-map-messages-to-scalars" class="section-name selfRef">Map Messages to Scalars</a>
          </h4>
<p id="section-7.3.2-1">The messages in <a href="#messages" class="auto internal xref">Section 7.2</a> are mapped to scalars during the Sign, Verify, ProofGen and ProofVerify operations. Presented below, are the output scalar values of the messages_to_scalars operation (<a href="#messages-to-scalars" class="auto internal xref">Section 4.3</a>), on input the messages defined in <a href="#messages" class="auto internal xref">Section 7.2</a>, using the map_to_scalar_as_hash operation (<a href="#map-to-scalar-as-hash" class="auto internal xref">Section 4.3.1.1</a>) as defined by the <a href="#bls12-381-shake-256-ciphersuite">BLS12-381-SHAKE-256</a> ciphersuite. Each output scalar value is encoded to octets using I2OSP and represented in big endian order,<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.2-2">
<pre>"1e0dea6c9ea8543731d331a0ab5f64954c188542b33c5bbc8ae5b3a830f2d99f"

"3918a40fb277b4c796805d1371931e08a314a8bf8200a92463c06054d2c56a9f"

"6642b981edf862adf34214d933c5d042bfa8f7ef343165c325131e2ffa32fa94"

"33c021236956a2006f547e22ff8790c9d2d40c11770c18cce6037786c6f23512"

"52b249313abbe323e7d84230550f448d99edfb6529dec8c4e783dbd6dd2a8471"

"2a50bdcbe7299e47e1046100aadffe35b4247bf3f059d525f921537484dd54fc"

"0e92550915e275f8cfd6da5e08e334d8ef46797ee28fa29de40a1ebccd9d95d3"

"4c28f612e6c6f82f51f95e1e4faaf597547f93f6689827a6dcda3cb94971d356"

"1db51bedc825b85efe1dab3e3ab0274fa82bbd39732be3459525faf70f197650"

"27878da72f7775e709bb693d81b819dc4e9fa60711f4ea927740e40073489e78"
</pre><a href="#section-7.3.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="message-generators">
<section id="section-7.3.3">
          <h4 id="name-message-generators">
<a href="#section-7.3.3" class="section-number selfRef">7.3.3. </a><a href="#name-message-generators" class="section-name selfRef">Message Generators</a>
          </h4>
<p id="section-7.3.3-1">Following the procedure defined in <a href="#generators-calculation" class="auto internal xref">Section 4.2</a> with an input count value of 11, for the <a href="#bls12-381-shake-256">BLS12-381-SHAKE-256</a> suite, outputs the following values (note that the first one corresponds to <code>Q_1</code>, while the next 10, to the message generators <code>H_1, ..., H_10</code>).<a href="#section-7.3.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.3-2">
<pre>"a9d40131066399fd41af51d883f4473b0dcd7d028d3d34ef17f3241d204e28507d7ecae
032afa1d5490849b7678ec1f8"

"903c7ca0b7e78a2017d0baf74103bd00ca8ff9bf429f834f071c75ffe6bfdec6d6dca15
417e4ac08ca4ae1e78b7adc0e"

"84321f5855bfb6b001f0dfcb47ac9b5cc68f1a4edd20f0ec850e0563b27d2accee6edff
1a26b357762fb24e8ddbb6fcb"

"b3060dff0d12a32819e08da00e61810676cc9185fdd750e5ef82b1a9798c7d76d63de3b
6225d6c9a479d6c21a7c8bf93"

"8f1093d1e553cdead3c70ce55b6d664e5d1912cc9edfdd37bf1dad11ca396a0a8bb0620
92d391ebf8790ea5722413f68"

"990824e00b48a68c3d9a308e8c52a57b1bc84d1cf5d3c0f8c6fb6b1230e4e5b8eb752fb
374da0b1ef687040024868140"

"b86d1c6ab8ce22bc53f625d1ce9796657f18060fcb1893ce8931156ef992fe56856199f
8fa6c998e5d855a354a26b0dd"

"b4cdd98c5c1e64cb324e0c57954f719d5c5f9e8d991fd8e159b31c8d079c76a67321a30
311975c706578d3a0ddc313b7"

"8311492d43ec9182a5fc44a75419b09547e311251fe38b6864dc1e706e29446cb3ea4d5
01634eb13327245fd8a574f77"

"ac00b493f92d17837a28d1f5b07991ca5ab9f370ae40d4f9b9f2711749ca200110ce651
7dc28400d4ea25dddc146cacc"

"965a6c62451d4be6cb175dec39727dc665762673ee42bf0ac13a37a74784fbd61e84e09
15277a6f59863b2bb4f5f6005"
</pre><a href="#section-7.3.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="signature-fixtures">
<section id="section-7.3.4">
          <h4 id="name-signature-fixtures">
<a href="#section-7.3.4" class="section-number selfRef">7.3.4. </a><a href="#name-signature-fixtures" class="section-name selfRef">Signature Fixtures</a>
          </h4>
<div id="valid-single-message-signature">
<section id="section-7.3.4.1">
            <h5 id="name-valid-single-message-signat">
<a href="#section-7.3.4.1" class="section-number selfRef">7.3.4.1. </a><a href="#name-valid-single-message-signat" class="section-name selfRef">Valid Single Message Signature</a>
            </h5>
<p id="section-7.3.4.1-1">Using the following header<a href="#section-7.3.4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.4.1-2">
<pre>"11223344556677889900aabbccddeeff"
</pre><a href="#section-7.3.4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-7.3.4.1-3">And the following message (the first message defined in <a href="#messages" class="auto internal xref">Section 7.2</a>)<a href="#section-7.3.4.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.4.1-4">
<pre>"9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
</pre><a href="#section-7.3.4.1-4" class="pilcrow">¶</a>
</div>
<p id="section-7.3.4.1-5">Along with the SK value as defined in <a href="#key-pair" class="auto internal xref">Section 7.3.1</a> as inputs into the Sign operations, yields the following output signature<a href="#section-7.3.4.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.4.1-6">
<pre>"98eb37fceb31115bf647f2983aef578ad895e55f7451b1add02fa738224cb89a31b148e
ace4d20d001be31d162c58d12574f30e68665b6403956a83b23a16f1daceacce8c5fde25
d3defd52d6d5ff2e1"
</pre><a href="#section-7.3.4.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="valid-multi-message-signature">
<section id="section-7.3.4.2">
            <h5 id="name-valid-multi-message-signatu">
<a href="#section-7.3.4.2" class="section-number selfRef">7.3.4.2. </a><a href="#name-valid-multi-message-signatu" class="section-name selfRef">Valid Multi-Message Signature</a>
            </h5>
<p id="section-7.3.4.2-1">Using the following header<a href="#section-7.3.4.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.4.2-2">
<pre>"11223344556677889900aabbccddeeff"
</pre><a href="#section-7.3.4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-7.3.4.2-3">And the messages defined in <a href="#messages" class="auto internal xref">Section 7.2</a> (<strong>Note</strong> the ordering of the messages MUST be preserved), along with the SK value as defined in <a href="#key-pair" class="auto internal xref">Section 7.3.1</a> as inputs into the Sign operations, yields the following output signature<a href="#section-7.3.4.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.4.2-4">
<pre>"97a296c83ed3626fe254d26021c5e9a087b580f1e8bc91bb51efb04420bfdaca215fe37
6a0bc12440bcc52224fb33c696cca9239b9f28dcddb7bd850aae9cd1a9c3e9f3639953fe
789dbba53b8f0dd6f"
</pre><a href="#section-7.3.4.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="proof-fixtures">
<section id="section-7.3.5">
          <h4 id="name-proof-fixtures">
<a href="#section-7.3.5" class="section-number selfRef">7.3.5. </a><a href="#name-proof-fixtures" class="section-name selfRef">Proof Fixtures</a>
          </h4>
<p id="section-7.3.5-1">For the generation of the following fixtures the <code>mocked_calculate_random_scalars</code> defined in <a href="#mocked-random-scalars">Mocked Random Scalars</a> is used, in place of the <code>calculate_random_scalars</code> operation, with the following seed value (hex encoding of the ASCII-encoded 30 first digits of pi)<a href="#section-7.3.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.5-2">
<pre>SEED = "332e313431353932363533353839373933323338343632363433333833323739"
</pre><a href="#section-7.3.5-2" class="pilcrow">¶</a>
</div>
<p id="section-7.3.5-3">Given the above seed the first 10 scalars returned by the <code>mocked_calculate_random_scalars</code> operation will be,<a href="#section-7.3.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.5-4">
<pre>"1004262112c3eaa95941b2b0d1311c09c845db0099a50e67eda628ad26b43083"
"6da7f145a94c1fa7f116b2482d59e4d466fe49c955ae8726e79453065156a9a4"
"05017919b3607e78c51e8ec34329955d49c8c90e4488079c43e74824e98f1306"
"4d451dad519b6a226bba79e11b44c441f1a74800eecfec6a2e2d79ea65b9d32d"
"5e7e4894e6dbe68023bc92ef15c410b01f3828109fc72b3b5ab159fc427b3f51"
"646e3014f49accb375253d268eb6c7f3289a1510f1e9452b612dd73a06ec5dd4"
"363ecc4c1f9d6d9144374de8f1f7991405e3345a3ec49dd485a39982753c11a4"
"12e592fe28d91d7b92a198c29afaa9d5329a4dcfdaf8b08557807412faeb4ac6"
"513325acdcdec7ea572360587b350a8b095ca19bdd8258c5c69d375e8706141a"
"6474fceba35e7e17365dde1a0284170180e446ae96c82943290d7baa3a6ed429"
</pre><a href="#section-7.3.5-4" class="pilcrow">¶</a>
</div>
<div id="valid-single-message-proof">
<section id="section-7.3.5.1">
            <h5 id="name-valid-single-message-proof">
<a href="#section-7.3.5.1" class="section-number selfRef">7.3.5.1. </a><a href="#name-valid-single-message-proof" class="section-name selfRef">Valid Single Message Proof</a>
            </h5>
<p id="section-7.3.5.1-1">Using the header, message and signature used in <a href="#valid-single-message-signature">Valid Single Message Signature</a> to create a proof disclosing the message, with the following presentation header<a href="#section-7.3.5.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.5.1-2">
<pre>"bed231d880675ed101ead304512e043ade9958dd0241ea70b4b3957fba941501"
</pre><a href="#section-7.3.5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-7.3.5.1-3">will result to the following proof value<a href="#section-7.3.5.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.5.1-4">
<pre>"85c250f9a52faeb883ad9598aed05d31fe5861478d9f33b8de2deed1d92de5c0b0ef344
58e6cf8bad8caa0724fd3d3ca854abee98db3384e81a406d976643e239df0a924576eaf8
f4eec2885e9c688af7a52e4a752bef2c6f07d0a45611db3795d83d9cd71dfe8a62e3ad99
2e6327413baaea14c1de798c8929f9c6b1524bab54d0494dd5354d5a0770b79d2911bb65
91ce293e03a0d083bb81fc5bed8a44ff67386c0c33ddaaebf7d046849428fc6cf4d08815
fa39c94144c79ac50e86a0f5d"
</pre><a href="#section-7.3.5.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="valid-multi-message-all-messages-disclosed-proof">
<section id="section-7.3.5.2">
            <h5 id="name-valid-multi-message-all-mes">
<a href="#section-7.3.5.2" class="section-number selfRef">7.3.5.2. </a><a href="#name-valid-multi-message-all-mes" class="section-name selfRef">Valid Multi-Message, All Messages Disclosed Proof</a>
            </h5>
<p id="section-7.3.5.2-1">Using the header, messages and signature used in <a href="#valid-multi-message-signature">Valid Multi Message Signature</a> to create a proof disclosing all the messages, with the following presentation header<a href="#section-7.3.5.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.5.2-2">
<pre>"bed231d880675ed101ead304512e043ade9958dd0241ea70b4b3957fba941501"
</pre><a href="#section-7.3.5.2-2" class="pilcrow">¶</a>
</div>
<p id="section-7.3.5.2-3">will result to the following proof value<a href="#section-7.3.5.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.5.2-4">
<pre>"94dfa4e26276f0ccf319b0ade65317e0bac41867aaebc73c7edc38673776cc6321dadd7
21920f5bd33f14be6dd101ec0b48f82f7ce8a8eb1d7cba2b93b66206bb7c3b5340e358be
39380c7a9f17083fa1bcdf9c4e5ba5927edfd01519189b7b33fa2b5bbb5baf963598694e
9f9c0c12e7aee29395e61a16129b43edaef245d5732bbc6e2e626ce241b8fdc60aea5532
f829ace9ed443a679b3e6ffd712ce67681537982406ba09ff6a1c6dee258fd22b3f9aa1f
28e19a83bbd1141f24171f380"
</pre><a href="#section-7.3.5.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="valid-multi-message-half-of-messages-disclosed-proof">
<section id="section-7.3.5.3">
            <h5 id="name-valid-multi-message-half-of">
<a href="#section-7.3.5.3" class="section-number selfRef">7.3.5.3. </a><a href="#name-valid-multi-message-half-of" class="section-name selfRef">Valid Multi-Message, Half of Messages Disclosed Proof</a>
            </h5>
<p id="section-7.3.5.3-1">Using the same header, messages and signature as in <a href="#valid-multi-message-all-messages-disclosed-proof">Multi-Message, All Messages Disclosed Proof</a> but this time with only every other messages disclosed (messages in index 0, 2, 4 and 6, in that order), with the following presentation header<a href="#section-7.3.5.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.5.3-2">
<pre>"bed231d880675ed101ead304512e043ade9958dd0241ea70b4b3957fba941501"
</pre><a href="#section-7.3.5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-7.3.5.3-3">will result to the following proof value<a href="#section-7.3.5.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.5.3-4">
<pre>"ac0424b2a984c55d0061aa61df105f2c882d393494f3f4205d1e73f93c9c76b30664bae
b3dc87f23fbf4035fb0a8e76b851dd39cecce8843e747ccf540f0850a30e1317f8897a56
c2d85bfc1e0b4dba1b0e0322d89aad4feb8b21c414a384a0128d65da028243bdab954c1d
6b4f3874ccafe69bb0900c0b8528d56dd9bd1d78b0c328022210ff9fe95276f79d232789
56a0898d974932bd90e6c79f7e970de6b637c7e6326540699080d39bd076a50095e031e9
80e68068e3e34a982ff4678c656db3c3b49df591ade6db848d7c2ddadf7e7d1db858848a
948f858f7fd59068c6b816607e5abd4f039bf2d1904fd7f89a1917023a1fc4862dbe8848
041da2e36271d76ad8b5e357ea3fd71ebc3617427a064256febf122773528023e4df1d25
900dc1ab19a563587c74a82495c59115263c51dcea106baa5f7f82c0b50e7756370f0470
cb4630d2a188309f28e1e0582c47a9ec76f864363835812984432a5253f079b3ede1b244
a809807ae2088deff841b93d0bca442e346b33d6b8aff8961"
</pre><a href="#section-7.3.5.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="bls12381-sha-256-test-vectors">
<section id="section-7.4">
        <h3 id="name-bls12381-sha-256-test-vecto">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-bls12381-sha-256-test-vecto" class="section-name selfRef">BLS12381-SHA-256 Test Vectors</a>
        </h3>
<p id="section-7.4-1">Test vectors of the <a href="#bls12-381-sha-256-ciphersuite">BLS12-381-SHA-256</a> ciphersuite. Further fixtures are available in <a href="#additional-bls12-381-sha-256-ciphersuite-test-vectors">additional BLS12-381-SHA-256 test vectors</a>.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<div id="key-pair-1">
<section id="section-7.4.1">
          <h4 id="name-key-pair-2">
<a href="#section-7.4.1" class="section-number selfRef">7.4.1. </a><a href="#name-key-pair-2" class="section-name selfRef">Key Pair</a>
          </h4>
<p id="section-7.4.1-1">The following key pair will be used for the test vectors of the <a href="#bls12-381-sha-256-ciphersuite">BLS12-381-SHA-256</a> ciphersuite.<a href="#section-7.4.1-1" class="pilcrow">¶</a></p>
<p id="section-7.4.1-2">Following the procedure defined in <a href="#secret-key" class="auto internal xref">Section 3.3.1</a> with an input <code>key_material</code> value as follows<a href="#section-7.4.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.1-3">
<pre>"746869732d49532d6a7573742d616e2d546573742d494b4d2d746f2d67656e657261746
52d246528724074232d6b6579"
</pre><a href="#section-7.4.1-3" class="pilcrow">¶</a>
</div>
<p id="section-7.4.1-4">and the following <code>key_info</code> value<a href="#section-7.4.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.1-5">
<pre>"746869732d49532d736f6d652d6b65792d6d657461646174612d746f2d62652d7573656
42d696e2d746573742d6b65792d67656e"
</pre><a href="#section-7.4.1-5" class="pilcrow">¶</a>
</div>
<p id="section-7.4.1-6">Outputs the following SK value<a href="#section-7.4.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.1-7">
<pre>"60e55110f76883a13d030b2f6bd11883422d5abde717569fc0731f51237169fc"
</pre><a href="#section-7.4.1-7" class="pilcrow">¶</a>
</div>
<p id="section-7.4.1-8">Following the procedure defined in <a href="#public-key" class="auto internal xref">Section 3.3.2</a> with an input SK value as above produces the following PK value<a href="#section-7.4.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.1-9">
<pre>"a820f230f6ae38503b86c70dc50b61c58a77e45c39ab25c0652bbaa8fa136f2851bd478
1c9dcde39fc9d1d52c9e60268061e7d7632171d91aa8d460acee0e96f1e7c4cfb12d3ff9
ab5d5dc91c277db75c845d649ef3c4f63aebc364cd55ded0c"
</pre><a href="#section-7.4.1-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="map-messages-to-scalars-1">
<section id="section-7.4.2">
          <h4 id="name-map-messages-to-scalars-2">
<a href="#section-7.4.2" class="section-number selfRef">7.4.2. </a><a href="#name-map-messages-to-scalars-2" class="section-name selfRef">Map Messages to Scalars</a>
          </h4>
<p id="section-7.4.2-1">The messages in <a href="#messages" class="auto internal xref">Section 7.2</a> are mapped to scalars during the Sign, Verify, ProofGen and ProofVerify operations. Presented below, are the output scalar values of the messages_to_scalars operation (<a href="#messages-to-scalars" class="auto internal xref">Section 4.3</a>), on input the messages defined in <a href="#messages" class="auto internal xref">Section 7.2</a>, using the map_to_scalar_as_hash operation (<a href="#map-to-scalar-as-hash" class="auto internal xref">Section 4.3.1.1</a>) as defined by the <a href="#bls12-381-sha-256-ciphersuite">BLS12-381-SHA-256</a> ciphersuite. Each output scalar value is encoded to octets using I2OSP and represented in big endian order,<a href="#section-7.4.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.2-2">
<pre>"4242535f424c53313233383147315f584d443a5348412d3235365f535357555f524f5f4
832475f484d32535f4d41505f4d53475f544f5f5343414c41525f41535f484153485f"
</pre><a href="#section-7.4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-7.4.2-3">The output scalars, encoded to octets using I2OSP and represented in big endian order, are the following,<a href="#section-7.4.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.2-4">
<pre>"1cb5bb86114b34dc438a911617655a1db595abafac92f47c5001799cf624b430"

"154249d503c093ac2df516d4bb88b510d54fd97e8d7121aede420a25d9521952"

"0c7c4c85cdab32e6fdb0de267b16fa3212733d4e3a3f0d0f751657578b26fe22"

"4a196deafee5c23f630156ae13be3e46e53b7e39094d22877b8cba7f14640888"

"34c5ea4f2ba49117015a02c711bb173c11b06b3f1571b88a2952b93d0ed4cf7e"

"4045b39b83055cd57a4d0203e1660800fabe434004dbdc8730c21ce3f0048b08"

"064621da4377b6b1d05ecc37cf3b9dfc94b9498d7013dc5c4a82bf3bb1750743"

"34ac9196ace0a37e147e32319ea9b3d8cc7d21870d3c3ba071246859cca49b02"

"57eb93f417c43200e9784fa5ea5a59168d3dbc38df707a13bb597c871b2a5f74"

"08e3afeb2b4f2b5f907924ef42856616e6f2d5f1fb373736db1cca32707a7d16"
</pre><a href="#section-7.4.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="message-generators-1">
<section id="section-7.4.3">
          <h4 id="name-message-generators-2">
<a href="#section-7.4.3" class="section-number selfRef">7.4.3. </a><a href="#name-message-generators-2" class="section-name selfRef">Message Generators</a>
          </h4>
<p id="section-7.4.3-1">Following the procedure defined in <a href="#generators-calculation" class="auto internal xref">Section 4.2</a> with an input count value of 11, for the <a href="#bls12-381-sha-256">BLS12-381-SHA-256</a> suite, outputs the following values (note that the first one corresponds to <code>Q_1</code>, while the next 10, to the message generators <code>H_1, ..., H_10</code>).<a href="#section-7.4.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.3-2">
<pre>"a9ec65b70a7fbe40c874c9eb041c2cb0a7af36ccec1bea48fa2ba4c2eb67ef7f9ecb17e
d27d38d27cdeddff44c8137be"

"98cd5313283aaf5db1b3ba8611fe6070d19e605de4078c38df36019fbaad0bd28dd090f
d24ed27f7f4d22d5ff5dea7d4"

"a31fbe20c5c135bcaa8d9fc4e4ac665cc6db0226f35e737507e803044093f37697a9d45
2490a970eea6f9ad6c3dcaa3a"

"b479263445f4d2108965a9086f9d1fdc8cde77d14a91c856769521ad3344754cc5ce90d
9bc4c696dffbc9ef1d6ad1b62"

"ac0401766d2128d4791d922557c7b4d1ae9a9b508ce266575244a8d6f32110d7b0b7557
b77604869633bb49afbe20035"

"b95d2898370ebc542857746a316ce32fa5151c31f9b57915e308ee9d1de7db69127d919
e984ea0747f5223821b596335"

"8f19359ae6ee508157492c06765b7df09e2e5ad591115742f2de9c08572bb2845cbf03f
d7e23b7f031ed9c7564e52f39"

"abc914abe2926324b2c848e8a411a2b6df18cbe7758db8644145fefb0bf0a2d558a8c99
46bd35e00c69d167aadf304c1"

"80755b3eb0dd4249cbefd20f177cee88e0761c066b71794825c9997b551f24051c35256
7ba6c01e57ac75dff763eaa17"

"82701eb98070728e1769525e73abff1783cedc364adb20c05c897a62f2ab2927f86f118
dcb7819a7b218d8f3fee4bd7f"

"a1f229540474f4d6f1134761b92b788128c7ac8dc9b0c52d59493132679673032ac7db3
fb3d79b46b13c1c41ee495bca"
</pre><a href="#section-7.4.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="signature-fixtures-1">
<section id="section-7.4.4">
          <h4 id="name-signature-fixtures-2">
<a href="#section-7.4.4" class="section-number selfRef">7.4.4. </a><a href="#name-signature-fixtures-2" class="section-name selfRef">Signature Fixtures</a>
          </h4>
<div id="valid-single-message-signature-1">
<section id="section-7.4.4.1">
            <h5 id="name-valid-single-message-signatu">
<a href="#section-7.4.4.1" class="section-number selfRef">7.4.4.1. </a><a href="#name-valid-single-message-signatu" class="section-name selfRef">Valid Single Message Signature</a>
            </h5>
<p id="section-7.4.4.1-1">Using the following header<a href="#section-7.4.4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.4.1-2">
<pre>"11223344556677889900aabbccddeeff"
</pre><a href="#section-7.4.4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-7.4.4.1-3">And the following message (the first message defined in <a href="#messages" class="auto internal xref">Section 7.2</a>)<a href="#section-7.4.4.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.4.1-4">
<pre>"9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
</pre><a href="#section-7.4.4.1-4" class="pilcrow">¶</a>
</div>
<p id="section-7.4.4.1-5">Along with the SK value as defined in <a href="#key-pair" class="auto internal xref">Section 7.3.1</a> as inputs into the Sign operations, yields the following output signature<a href="#section-7.4.4.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.4.1-6">
<pre>"88c0eb3bc1d97610c3a66d8a3a73f260f95a3028bccf7fff7d9851e2acd9f3f32fdf58a
5b34d12df8177adf37aa318a20f72be7d37a8e8d8441d1bc0bc75543c681bf061ce7e7f6
091fe78c1cb8af103"
</pre><a href="#section-7.4.4.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="valid-multi-message-signature-1">
<section id="section-7.4.4.2">
            <h5 id="name-valid-multi-message-signatur">
<a href="#section-7.4.4.2" class="section-number selfRef">7.4.4.2. </a><a href="#name-valid-multi-message-signatur" class="section-name selfRef">Valid Multi-Message Signature</a>
            </h5>
<p id="section-7.4.4.2-1">Using the following header<a href="#section-7.4.4.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.4.2-2">
<pre>"11223344556677889900aabbccddeeff"
</pre><a href="#section-7.4.4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-7.4.4.2-3">And the messages defined in <a href="#messages" class="auto internal xref">Section 7.2</a> (<strong>Note</strong> the ordering of the messages MUST be preserved), along with the SK value as defined in <a href="#key-pair" class="auto internal xref">Section 7.3.1</a> as inputs into the Sign operations, yields the following output signature<a href="#section-7.4.4.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.4.2-4">
<pre>"895cd9c0ccb9aca4de913218655346d718711472f2bf1f3e68916de106a0d93cf2f4720
0819b45920bbda541db2d91480665df253fedab2843055bdc02535d83baddbbb2803ec38
08e074f71f199751e"
</pre><a href="#section-7.4.4.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="proof-fixtures-1">
<section id="section-7.4.5">
          <h4 id="name-proof-fixtures-2">
<a href="#section-7.4.5" class="section-number selfRef">7.4.5. </a><a href="#name-proof-fixtures-2" class="section-name selfRef">Proof Fixtures</a>
          </h4>
<p id="section-7.4.5-1">Similarly to the proof fixtures for the BLS12381-SHA-256 ciphersuite, the generation of the following fixtures uses the <code>mocked_calculate_random_scalars</code> defined in <a href="#mocked-random-scalars">Mocked Random Scalars</a>, in place of the <code>calculate_random_scalars</code> operation, with the following seed value (hex encoding of the ASCII-encoded 30 first digits of pi).<a href="#section-7.4.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.5-2">
<pre>SEED = "332e313431353932363533353839373933323338343632363433333833323739"

</pre><a href="#section-7.4.5-2" class="pilcrow">¶</a>
</div>
<p id="section-7.4.5-3">Given the above seed the first 10 scalars returned by the <code>mocked_calculate_random_scalars</code> operation will be,<a href="#section-7.4.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.5-4">
<pre>"04f8e2518993c4383957ad14eb13a023c4ad0c67d01ec86eeb902e732ed6df3f"
"5d87c1ba64c320ad601d227a1b74188a41a100325cecf00223729863966392b1"
"0444607600ac70482e9c983b4b063214080b9e808300aa4cc02a91b3a92858fe"
"548cd11eae4318e88cda10b4cd31ae29d41c3a0b057196ee9cf3a69d471e4e94"
"2264b06a08638b69b4627756a62f08e0dc4d8240c1b974c9c7db779a769892f4"
"4d99352986a9f8978b93485d21525244b21b396cf61f1d71f7c48e3fbc970a42"
"5ed8be91662386243a6771fbdd2c627de31a44220e8d6f745bad5d99821a4880"
"62ff1734b939ddd87beeb37a7bbcafa0a274cbc1b07384198f0e88398272208d"
"05c2a0af016df58e844db8944082dcaf434de1b1e2e7136ec8a99b939b716223"
"485e2adab17b76f5334c95bf36c03ccf91cef77dcfcdc6b8a69e2090b3156663"
</pre><a href="#section-7.4.5-4" class="pilcrow">¶</a>
</div>
<div id="valid-single-message-proof-1">
<section id="section-7.4.5.1">
            <h5 id="name-valid-single-message-proof-2">
<a href="#section-7.4.5.1" class="section-number selfRef">7.4.5.1. </a><a href="#name-valid-single-message-proof-2" class="section-name selfRef">Valid Single Message Proof</a>
            </h5>
<p id="section-7.4.5.1-1">Using the header, message and signature used in <a href="#valid-single-message-signature-1">Valid Single Message Signature</a> to create a proof disclosing the message, with the following presentation header<a href="#section-7.4.5.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.5.1-2">
<pre>"bed231d880675ed101ead304512e043ade9958dd0241ea70b4b3957fba941501"
</pre><a href="#section-7.4.5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-7.4.5.1-3">will result to the following proof value<a href="#section-7.4.5.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.5.1-4">
<pre>"8e9bc91d68151e4b105ec0d46ca95fe1526672bed27b26541a648ec990b3b11b8905e67
1fb981f1b9cd1ed64167a7ba18b7697d9bd6f3cac02f75551f2db95bf2707e3790c10d81
5346a96198327cc7048f220bdc7d6fc5ec41c6d9f89d607ff6ef2eef19447b3e34a14660
eedb8b4f6189f202a4fef22e60dd23041e2761a9f18701019b520ed3ccf07a298e349222
ab059e7ebd84c65e3a2127ec42f5f357c27d5601b2193b697a576fd9bd896c25a75004f6
604a98707741916769c49175f"
</pre><a href="#section-7.4.5.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="valid-multi-message-all-messages-disclosed-proof-1">
<section id="section-7.4.5.2">
            <h5 id="name-valid-multi-message-all-mess">
<a href="#section-7.4.5.2" class="section-number selfRef">7.4.5.2. </a><a href="#name-valid-multi-message-all-mess" class="section-name selfRef">Valid Multi-Message, All Messages Disclosed Proof</a>
            </h5>
<p id="section-7.4.5.2-1">Using the header, messages and signature used in <a href="#valid-multi-message-signature-1">Valid Multi Message Signature</a> to create a proof disclosing all the messages, with the following presentation header<a href="#section-7.4.5.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.5.2-2">
<pre>"bed231d880675ed101ead304512e043ade9958dd0241ea70b4b3957fba941501"
</pre><a href="#section-7.4.5.2-2" class="pilcrow">¶</a>
</div>
<p id="section-7.4.5.2-3">will result to the following proof value<a href="#section-7.4.5.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.5.2-4">
<pre>"89910f223320044fe6342b8dabfeac786f35cc98bb64c95ecb39348281d5a8c84e97558
1b5f37ec45c8bc4cda486d5e2a20e007d0dd0fba77f846dfe3458fc01ff94a49c0585506
84638e1b88b61e8d69a1453652477af005d42cdb2d57e86b03a2cf88bc0bac5a3d12a1c0
717b9ea8d42ecdb746f522edfc15910574b289faa0438d6516504a7a66ce180b2271101d
87519cad823f03f266f66649b388e680a58a6e7ae4982ae797890d5d0b574fa73a7ae702
3d4dd9f8a9b3a11f208256d7c"
</pre><a href="#section-7.4.5.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="valid-multi-message-half-of-messages-disclosed-proof-1">
<section id="section-7.4.5.3">
            <h5 id="name-valid-multi-message-half-of-">
<a href="#section-7.4.5.3" class="section-number selfRef">7.4.5.3. </a><a href="#name-valid-multi-message-half-of-" class="section-name selfRef">Valid Multi-Message, Half of Messages Disclosed Proof</a>
            </h5>
<p id="section-7.4.5.3-1">Using the same header, messages and signature as in <a href="#valid-multi-message-all-messages-disclosed-proof-1">Multi-Message, All Messages Disclosed Proof</a> but this time with only every other messages disclosed (messages in index 0, 2, 4 and 6, in that order), with the following presentation header<a href="#section-7.4.5.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.5.3-2">
<pre>"bed231d880675ed101ead304512e043ade9958dd0241ea70b4b3957fba941501"
</pre><a href="#section-7.4.5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-7.4.5.3-3">will result to the following proof value<a href="#section-7.4.5.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.5.3-4">
<pre>"812a204f66c9084feed7383894d910f2c17399b3c4b4bed05660921de8539f5042318c3
56609496a6ca0a26626661be78ca723b7182ccd314924b93a3997654fcd77e29e3847dc8
81f422a751017705173ec094d2997221e134710d4fff1bd33111a4b4fc79a2201d18b5cc
63fab1252def0d4f020129c7e022f56f505aa977a7240da430bc60a2d4d17897b4222805
4a2fb4f780fb710268ebea24c9fb0e15e2ac415b99a232b13bfd215af3fb35f5518953ea
ccc200555eaa69ae434eb623f0a83bb57a8a8e70ba37761ffaeb756d9115c1177ce929f0
4be23b5636120c7ac0a73546f177a3c3be2d233b3253f31c3468260723c1afa2d0febd38
161e16ed0147369bda8b05ec3f6183239c6ecb9fb54b0989160e8cdf8b9f0cf4a46a2150
232d96c466fad2d60ff067492c52cc6af1d16e62364ed6d3dc19feaf1fcf9c12750301c2
de6541c0edce5ede7425f75e01fd94a7e6137ebf23460bf3f1afec9f21767c467fdd882e
b038492a390ee5d0c0f72f50f2ac5cedb705fc465f7bc093b"
</pre><a href="#section-7.4.5.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document does not make any requests of IANA.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgements">
<section id="section-9">
      <h2 id="name-acknowledgements">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-9-1">The authors would like to acknowledge the significant amount of academic work that preceeded the development of this document. In particular the original work of <span>[<a href="#BBS04" class="cite xref">BBS04</a>]</span> which was subsequently developed in <span>[<a href="#ASM06" class="cite xref">ASM06</a>]</span> and in <span>[<a href="#CDL16" class="cite xref">CDL16</a>]</span>. This last academic work is the one mostly used by this document.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">The current state of this document is the product of the work of the Decentralized Identity Foundation Applied Cryptography Working group, which includes numerous active participants. In particular, the following individuals contributed ideas, feedback and wording that influenced this specification:<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">Orie Steele, Christian Paquin, Alessandro Guggino, Tomislav Markovski and Greg Bernstein.<a href="#section-9-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-normative-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="DRBG">[DRBG]</dt>
      <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Recommendation for Random Number Generation Using Deterministic Random Bit Generators"</span>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-hash-to-curve">[I-D.irtf-cfrg-hash-to-curve]</dt>
      <dd>
<span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Scott, S.</span>, <span class="refAuthor">Sullivan, N.</span>, <span class="refAuthor">Wahby, R. S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hashing to Elliptic Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-hash-to-curve-16</span>, <time datetime="2022-06-15" class="refDate">15 June 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-pairing-friendly-curves">[I-D.irtf-cfrg-pairing-friendly-curves]</dt>
      <dd>
<span class="refAuthor">Sakemi, Y.</span>, <span class="refAuthor">Kobayashi, T.</span>, <span class="refAuthor">Saito, T.</span>, and <span class="refAuthor">R. S. Wahby</span>, <span class="refTitle">"Pairing-Friendly Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-pairing-friendly-curves-11</span>, <time datetime="2022-11-06" class="refDate">6 November 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-pairing-friendly-curves-11">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-pairing-friendly-curves-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
      <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
      <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8937">[RFC8937]</dt>
      <dd>
<span class="refAuthor">Cremers, C.</span>, <span class="refAuthor">Garratt, L.</span>, <span class="refAuthor">Smyshlyaev, S.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Randomness Improvements for Security Protocols"</span>, <span class="seriesInfo">RFC 8937</span>, <span class="seriesInfo">DOI 10.17487/RFC8937</span>, <time datetime="2020-10" class="refDate">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8937">https://www.rfc-editor.org/info/rfc8937</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHA2">[SHA2]</dt>
      <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Secure Hash Standard (SHS)"</span>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHA3">[SHA3]</dt>
    <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions"</span>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11">
      <h2 id="name-informative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="ADR02">[ADR02]</dt>
      <dd>
<span class="refAuthor">An, J. H.</span>, <span class="refAuthor">Dodis, Y.</span>, and <span class="refAuthor">T. Rabin</span>, <span class="refTitle">"On the Security of Joint Signature and Encryption"</span>, <span class="seriesInfo">pages 83-107</span>, <time datetime="2002-04" class="refDate">April 2002</time>, <span>&lt;<a href="https://doi.org/10.1007/3-540-46035-7_6">https://doi.org/10.1007/3-540-46035-7_6</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ASM06">[ASM06]</dt>
      <dd>
<span class="refAuthor">Au, M. H.</span>, <span class="refAuthor">Susilo, W.</span>, and <span class="refAuthor">Y. Mu</span>, <span class="refTitle">"Constant-Size Dynamic k-TAA"</span>, <span class="seriesInfo">Springer, Berlin, Heidelberg</span>, <time datetime="2006" class="refDate">2006</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/11832072_8">https://link.springer.com/chapter/10.1007/11832072_8</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BBS04">[BBS04]</dt>
      <dd>
<span class="refAuthor">Boneh, D.</span>, <span class="refAuthor">Boyen, X.</span>, and <span class="refAuthor">H. Shacham</span>, <span class="refTitle">"Short Group Signatures"</span>, <span class="seriesInfo">pages 41-55</span>, <time datetime="2004" class="refDate">2004</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/978-3-540-28628-8_3">https://link.springer.com/chapter/10.1007/978-3-540-28628-8_3</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Bowe19">[Bowe19]</dt>
      <dd>
<span class="refAuthor">Bowe, S.</span>, <span class="refTitle">"Faster subgroup checks for BLS12-381"</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://eprint.iacr.org/2019/814">https://eprint.iacr.org/2019/814</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CDL16">[CDL16]</dt>
      <dd>
<span class="refAuthor">Camenisch, J.</span>, <span class="refAuthor">Drijvers, M.</span>, and <span class="refAuthor">A. Lehmann</span>, <span class="refTitle">"Anonymous Attestation Using the Strong Diffie Hellman Assumption Revisited"</span>, <span class="seriesInfo">Springer, Cham</span>, <time datetime="2016" class="refDate">2016</time>, <span>&lt;<a href="https://eprint.iacr.org/2016/663.pdf">https://eprint.iacr.org/2016/663.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HDWH12">[HDWH12]</dt>
      <dd>
<span class="refAuthor">Heninger, N.</span>, <span class="refAuthor">Durumeric, Z.</span>, <span class="refAuthor">Wustrow, E.</span>, and <span class="refAuthor">J.A. Halderman</span>, <span class="refTitle">"Mining your Ps and Qs: Detection of widespread weak keys in network devices"</span>, <span class="seriesInfo">pages 205-220</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final228.pdf">https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final228.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-bls-signature">[I-D.irtf-cfrg-bls-signature]</dt>
      <dd>
<span class="refAuthor">Boneh, D.</span>, <span class="refAuthor">Gorbunov, S.</span>, <span class="refAuthor">Wahby, R. S.</span>, <span class="refAuthor">Wee, H.</span>, <span class="refAuthor">Wood, C. A.</span>, and <span class="refAuthor">Z. Zhang</span>, <span class="refTitle">"BLS Signatures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-bls-signature-05</span>, <time datetime="2022-06-16" class="refDate">16 June 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bls-signature-05">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bls-signature-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ZCASH-REVIEW">[ZCASH-REVIEW]</dt>
    <dd>
<span class="refAuthor">NCC Group</span>, <span class="refTitle">"Zcash Overwinter Consensus and Sapling Cryptography Review"</span>, <span>&lt;<a href="https://research.nccgroup.com/wp-content/uploads/2020/07/NCC_Group_Zcash2018_Public_Report_2019-01-30_v1.3.pdf">https://research.nccgroup.com/wp-content/uploads/2020/07/NCC_Group_Zcash2018_Public_Report_2019-01-30_v1.3.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="bls12-381-hash-to-curve-definition-using-shake-256">
<section id="appendix-A">
      <h2 id="name-bls12-381-hash_to_curve-def">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-bls12-381-hash_to_curve-def" class="section-name selfRef">BLS12-381 hash_to_curve Definition Using SHAKE-256</a>
      </h2>
<p id="appendix-A-1">The following defines a hash_to_curve suite <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> for the BLS12-381 curve for both the G1 and G2 subgroups using the extendable output function (xof) of SHAKE-256 as per the guidance defined in section 8.9 of <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">Note the notation used in the below definitions is sourced from <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div id="bls12-381-g1">
<section id="appendix-A.1">
        <h3 id="name-bls12-381-g1">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-bls12-381-g1" class="section-name selfRef">BLS12-381 G1</a>
        </h3>
<p id="appendix-A.1-1">The suite of <code>BLS12381G1_XOF:SHAKE-256_SSWU_RO_</code> is defined as follows:<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-2">
<pre>* encoding type: hash_to_curve (Section 3 of
                 [@!I-D.irtf-cfrg-hash-to-curve])

* E: y^2 = x^3 + 4

* p: 0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f624
     1eabfffeb153ffffb9feffffffffaaab

* r: 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001

* m: 1

* k: 128

* expand_message: expand_message_xof (Section 5.3.2 of
                  [@!I-D.irtf-cfrg-hash-to-curve])

* hash: SHAKE-256

* L: 64

* f: Simplified SWU for AB == 0 (Section 6.6.3 of
     [@!I-D.irtf-cfrg-hash-to-curve])

* Z: 11

*  E': y'^2 = x'^3 + A' * x' + B', where

      -  A' = 0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aef
                d881ac98936f8da0e0f97f5cf428082d584c1d

      -  B' = 0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14f
                cef35ef55a23215a316ceaa5d1cc48e98e172be0

*  iso_map: the 11-isogeny map from E' to E given in Appendix E.2 of
            [@!I-D.irtf-cfrg-hash-to-curve]

*  h_eff: 0xd201000000010001
</pre><a href="#appendix-A.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-3">Note that the h_eff values for this suite are copied from that defined for the <code>BLS12381G1_XMD:SHA-256_SSWU_RO_</code> suite defined in section 8.8.1 of <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<p id="appendix-A.1-4">An optimized example implementation of the Simplified SWU mapping to the curve E' isogenous to BLS12-381 G1 is given in Appendix F.2 <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="use-cases">
<section id="appendix-B">
      <h2 id="name-use-cases">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
      </h2>
<div id="non-correlating-security-token">
<section id="appendix-B.1">
        <h3 id="name-non-correlating-security-to">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-non-correlating-security-to" class="section-name selfRef">Non-correlating Security Token</a>
        </h3>
<p id="appendix-B.1-1">In the most general sense BBS signatures can be used in any application where a cryptographically secured token is required but correlation caused by usage of the token is un-desirable.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">For example in protocols like OAuth2.0 the most commonly used form of the access token leverages the JWT format alongside conventional cryptographic primitives such as traditional digital signatures or HMACs. These access tokens are then used by a relying party to prove authority to a resource server during a request. However, because the access token is most commonly sent by value as it was issued by the authorization server (e.g in a bearer style scheme), the access token can act as a source of strong correlation for the relying party. Relevant prior art can be found <a href="https://www.ietf.org/archive/id/draft-private-access-tokens-01.html">here</a>.<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
<p id="appendix-B.1-3">BBS Signatures due to their unique properties removes this source of correlation but maintains the same set of guarantees required by a resource server to validate an access token back to its relevant authority (note that an approach to signing JSON tokens with BBS that may be of relevance is the <a href="https://json-web-proofs.github.io/json-web-proofs/draft-jmiller-json-web-proof.html">JWP</a> format and serialization). In the context of a protocol like OAuth2.0 the access token issued by the authorization server would feature a BBS Signature, however instead of the relying party providing this access token as issued, in their request to a resource server, they generate a unique proof from the original access token and include that in the request instead, thus removing this vector of correlation.<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="improved-bearer-security-token">
<section id="appendix-B.2">
        <h3 id="name-improved-bearer-security-to">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-improved-bearer-security-to" class="section-name selfRef">Improved Bearer Security Token</a>
        </h3>
<p id="appendix-B.2-1">Bearer based security tokens such as JWT based access tokens used in the OAuth2.0 protocol are a highly popular format for expressing authorization grants. However their usage has several security limitations. Notably a bearer based authorization scheme often has to rely on a secure transport between the authorized party (client) and the resource server to mitigate the potential for a MITM attack or a malicious interception of the access token. The scheme also has to assume a degree of trust in the resource server it is presenting an access token to, particularly when the access token grants more than just access to the target resource server, because in a bearer based authorization scheme, anyone who possesses the access token has authority to what it grants. Bearer based access tokens also suffer from the threat of replay attacks.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">Improved schemes around authorization protocols often involve adding a layer of proof of cryptographic key possession to the presentation of an access token, which mitigates the deficiencies highlighted above as well as providing a way to detect a replay attack. However, approaches that involve proof of cryptographic key possession such as DPoP (<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-dpop-04">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-dpop-04</a>) suffer from an increase in protocol complexity. A party requesting authorization must pre-generate appropriate key material, share the public portion of this with the authorization server alongside proving possession of the private portion of the key material. The authorization server must also be-able to accommodate receiving this information and validating it.<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
<p id="appendix-B.2-3">BBS Signatures ofter an alternative model that solves the same problems that proof of cryptographic key possession schemes do for bearer based schemes, but in a way that doesn't introduce new up-front protocol complexity. In the context of a protocol like OAuth2.0 the access token issued by the authorization server would feature a BBS Signature, however instead of the client providing this access token as issued, in their request to a resource server, they generate a unique proof from the original access token and include that in the request instead. Because the access token is not shared in a request to a resource server, attacks such as MITM are mitigated. A resource server also obtains the ability to detect a replay attack by ensuring the proof presented is unique.<a href="#appendix-B.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="selectively-disclosure-enabled-identity-credentials">
<section id="appendix-B.3">
        <h3 id="name-selectively-disclosure-enab">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-selectively-disclosure-enab" class="section-name selfRef">Selectively Disclosure Enabled Identity Credentials</a>
        </h3>
<p id="appendix-B.3-1">BBS signatures when applied to the problem space of identity credentials can help to enhance user privacy. For example a digital drivers license that is cryptographically signed with a BBS signature, allows the holder or subject of the license to disclose different claims from their drivers license to different parties. Furthermore, the unlinkable presentations property of proofs generated by the scheme remove an important possible source of correlation for the holder across multiple presentations.<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="additional-test-vectors">
<section id="appendix-C">
      <h2 id="name-additional-test-vectors">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-additional-test-vectors" class="section-name selfRef">Additional Test Vectors</a>
      </h2>
<p id="appendix-C-1"><strong>NOTE</strong> These fixtures are a work in progress and subject to change<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div id="bls12-381-shake-256-ciphersuite">
<section id="appendix-C.1">
        <h3 id="name-bls12-381-shake-256-ciphers">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-bls12-381-shake-256-ciphers" class="section-name selfRef">BLS12-381-SHAKE-256 Ciphersuite</a>
        </h3>
<div id="signature-test-vectors">
<section id="appendix-C.1.1">
          <h4 id="name-signature-test-vectors">
<a href="#appendix-C.1.1" class="section-number selfRef">C.1.1. </a><a href="#name-signature-test-vectors" class="section-name selfRef">Signature Test Vectors</a>
          </h4>
<div id="no-header-valid-signature">
<section id="appendix-C.1.1.1">
            <h5 id="name-no-header-valid-signature">
<a href="#appendix-C.1.1.1" class="section-number selfRef">C.1.1.1. </a><a href="#name-no-header-valid-signature" class="section-name selfRef">No Header Valid Signature</a>
            </h5>
<p id="appendix-C.1.1.1-1">Using the messages defined in <a href="#messages" class="auto internal xref">Section 7.2</a>, with no header, along with the SK and PK values defined in <a href="#key-pair" class="auto internal xref">Section 7.3.1</a> results in the following signature value<a href="#appendix-C.1.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.1-2">
<pre>"abfa513cdb323e47214b7c182fb623197a0681b753f897545a73d82ee133a8ecf69db9a
a09fe425df4e7687d99d779db5c66199c0dc9d2a442d331c43f56e060edc69a69ed2f13d
e3813b98ce6b05737"
</pre><a href="#appendix-C.1.1.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="modified-message-signature">
<section id="appendix-C.1.1.2">
            <h5 id="name-modified-message-signature">
<a href="#appendix-C.1.1.2" class="section-number selfRef">C.1.1.2. </a><a href="#name-modified-message-signature" class="section-name selfRef">Modified Message Signature</a>
            </h5>
<p id="appendix-C.1.1.2-1">Using the following header<a href="#appendix-C.1.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.2-2">
<pre>"11223344556677889900aabbccddeeff"
</pre><a href="#appendix-C.1.1.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.1.2-3">And the following message (the first message defined in <a href="#messages" class="auto internal xref">Section 7.2</a>)<a href="#appendix-C.1.1.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.2-4">
<pre>""
</pre><a href="#appendix-C.1.1.2-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.1.2-5">With the following signature<a href="#appendix-C.1.1.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.2-6">
<pre>"98eb37fceb31115bf647f2983aef578ad895e55f7451b1add02fa738224cb89a31b148e
ace4d20d001be31d162c58d12574f30e68665b6403956a83b23a16f1daceacce8c5fde25
d3defd52d6d5ff2e1"
</pre><a href="#appendix-C.1.1.2-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.1.2-7">Along with the PK value as defined in <a href="#key-pair" class="auto internal xref">Section 7.3.1</a> as inputs into the Verify operation should fail signature validation due to the message value being different from what was signed<a href="#appendix-C.1.1.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="extra-unsigned-message-signature">
<section id="appendix-C.1.1.3">
            <h5 id="name-extra-unsigned-message-sign">
<a href="#appendix-C.1.1.3" class="section-number selfRef">C.1.1.3. </a><a href="#name-extra-unsigned-message-sign" class="section-name selfRef">Extra Unsigned Message Signature</a>
            </h5>
<p id="appendix-C.1.1.3-1">Using the following header<a href="#appendix-C.1.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.3-2">
<pre>"11223344556677889900aabbccddeeff"
</pre><a href="#appendix-C.1.1.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.1.3-3">And the following messages (the two first messages defined in <a href="#messages" class="auto internal xref">Section 7.2</a>)<a href="#appendix-C.1.1.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.3-4">
<pre>"9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"

"c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
</pre><a href="#appendix-C.1.1.3-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.1.3-5">With the following signature (which is a signature to only the first of the above two messages)<a href="#appendix-C.1.1.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.3-6">
<pre>"98eb37fceb31115bf647f2983aef578ad895e55f7451b1add02fa738224cb89a31b148e
ace4d20d001be31d162c58d12574f30e68665b6403956a83b23a16f1daceacce8c5fde25
d3defd52d6d5ff2e1"
</pre><a href="#appendix-C.1.1.3-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.1.3-7">Along with the PK value as defined in <a href="#key-pair" class="auto internal xref">Section 7.3.1</a> as inputs into the Verify operation should fail signature validation due to an additional message being supplied that was not signed.<a href="#appendix-C.1.1.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="missing-message-signature">
<section id="appendix-C.1.1.4">
            <h5 id="name-missing-message-signature">
<a href="#appendix-C.1.1.4" class="section-number selfRef">C.1.1.4. </a><a href="#name-missing-message-signature" class="section-name selfRef">Missing Message Signature</a>
            </h5>
<p id="appendix-C.1.1.4-1">Using the following header<a href="#appendix-C.1.1.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.4-2">
<pre>"11223344556677889900aabbccddeeff"
</pre><a href="#appendix-C.1.1.4-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.1.4-3">And the following messages (the two first messages defined in <a href="#messages" class="auto internal xref">Section 7.2</a>)<a href="#appendix-C.1.1.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.4-4">
<pre>"9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"

"c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
</pre><a href="#appendix-C.1.1.4-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.1.4-5">With the following signature (which is a signature on all the messages defined in <a href="#messages" class="auto internal xref">Section 7.2</a>)<a href="#appendix-C.1.1.4-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.4-6">
<pre>"97a296c83ed3626fe254d26021c5e9a087b580f1e8bc91bb51efb04420bfdaca215fe37
6a0bc12440bcc52224fb33c696cca9239b9f28dcddb7bd850aae9cd1a9c3e9f3639953fe
789dbba53b8f0dd6f"
</pre><a href="#appendix-C.1.1.4-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.1.4-7">Along with the PK value as defined in <a href="#key-pair" class="auto internal xref">Section 7.3.1</a> as inputs into the Verify operation should fail signature validation due to missing messages that were originally present during the signing.<a href="#appendix-C.1.1.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reordered-message-signature">
<section id="appendix-C.1.1.5">
            <h5 id="name-reordered-message-signature">
<a href="#appendix-C.1.1.5" class="section-number selfRef">C.1.1.5. </a><a href="#name-reordered-message-signature" class="section-name selfRef">Reordered Message Signature</a>
            </h5>
<p id="appendix-C.1.1.5-1">Using the following header<a href="#appendix-C.1.1.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.5-2">
<pre>"11223344556677889900aabbccddeeff"
</pre><a href="#appendix-C.1.1.5-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.1.5-3">And the following messages (re-ordering of the messages defined in <a href="#messages" class="auto internal xref">Section 7.2</a>)<a href="#appendix-C.1.1.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.5-4">
<pre>""

"96012096"

"ac55fb33a75909ed"

"d183ddc6e2665aa4e2f088af"

"515ae153e22aae04ad16f759e07237b4"

"496694774c5604ab1b2544eababcf0f53278ff50"

"77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"

"7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"

"c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"

"9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
</pre><a href="#appendix-C.1.1.5-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.1.5-5">With the following signature<a href="#appendix-C.1.1.5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.5-6">
<pre>"97a296c83ed3626fe254d26021c5e9a087b580f1e8bc91bb51efb04420bfdaca215fe37
6a0bc12440bcc52224fb33c696cca9239b9f28dcddb7bd850aae9cd1a9c3e9f3639953fe
789dbba53b8f0dd6f"
</pre><a href="#appendix-C.1.1.5-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.1.5-7">Along with the PK value as defined in <a href="#key-pair" class="auto internal xref">Section 7.3.1</a> as inputs into the Verify operation should fail signature validation due to messages being re-ordered from the order in which they were signed<a href="#appendix-C.1.1.5-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wrong-public-key-signature">
<section id="appendix-C.1.1.6">
            <h5 id="name-wrong-public-key-signature">
<a href="#appendix-C.1.1.6" class="section-number selfRef">C.1.1.6. </a><a href="#name-wrong-public-key-signature" class="section-name selfRef">Wrong Public Key Signature</a>
            </h5>
<p id="appendix-C.1.1.6-1">Using the following header<a href="#appendix-C.1.1.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.6-2">
<pre>"11223344556677889900aabbccddeeff"
</pre><a href="#appendix-C.1.1.6-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.1.6-3">And the messages as defined in <a href="#messages" class="auto internal xref">Section 7.2</a>, mapped to the scalars in <a href="#map-messages-to-scalars" class="auto internal xref">Section 7.3.2</a> and with the following signature<a href="#appendix-C.1.1.6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.6-4">
<pre>"97a296c83ed3626fe254d26021c5e9a087b580f1e8bc91bb51efb04420bfdaca215fe37
6a0bc12440bcc52224fb33c696cca9239b9f28dcddb7bd850aae9cd1a9c3e9f3639953fe
789dbba53b8f0dd6f"
</pre><a href="#appendix-C.1.1.6-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.1.6-5">Along with the PK value as defined in <a href="#key-pair" class="auto internal xref">Section 7.3.1</a> as inputs into the Verify operation should fail signature validation due to public key used to verify is in-correct<a href="#appendix-C.1.1.6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wrong-header-signature">
<section id="appendix-C.1.1.7">
            <h5 id="name-wrong-header-signature">
<a href="#appendix-C.1.1.7" class="section-number selfRef">C.1.1.7. </a><a href="#name-wrong-header-signature" class="section-name selfRef">Wrong Header Signature</a>
            </h5>
<p id="appendix-C.1.1.7-1">Using the following header<a href="#appendix-C.1.1.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.7-2">
<pre>"ffeeddccbbaa00998877665544332211"
</pre><a href="#appendix-C.1.1.7-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.1.7-3">And the messages as defined in <a href="#messages" class="auto internal xref">Section 7.2</a> and with the following signature<a href="#appendix-C.1.1.7-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.1.7-4">
<pre>"97a296c83ed3626fe254d26021c5e9a087b580f1e8bc91bb51efb04420bfdaca215fe37
6a0bc12440bcc52224fb33c696cca9239b9f28dcddb7bd850aae9cd1a9c3e9f3639953fe
789dbba53b8f0dd6f"
</pre><a href="#appendix-C.1.1.7-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.1.7-5">Along with the PK value as defined in <a href="#key-pair" class="auto internal xref">Section 7.3.1</a> as inputs into the Verify operation should fail signature validation due to header value being modified from what was originally signed<a href="#appendix-C.1.1.7-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="proof-test-vectors">
<section id="appendix-C.1.2">
          <h4 id="name-proof-test-vectors">
<a href="#appendix-C.1.2" class="section-number selfRef">C.1.2. </a><a href="#name-proof-test-vectors" class="section-name selfRef">Proof Test Vectors</a>
          </h4>
<div id="no-header-valid-proof">
<section id="appendix-C.1.2.1">
            <h5 id="name-no-header-valid-proof">
<a href="#appendix-C.1.2.1" class="section-number selfRef">C.1.2.1. </a><a href="#name-no-header-valid-proof" class="section-name selfRef">No Header Valid Proof</a>
            </h5>
<p id="appendix-C.1.2.1-1">Using messages, PK and signature as in <a href="#no-header-valid-signature">No Header Valid Signature</a>, with only every other messages disclosed (messages in index 0, 2, 4 and 6, in that order), with no header and the following presentation header<a href="#appendix-C.1.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.2.1-2">
<pre>"bed231d880675ed101ead304512e043ade9958dd0241ea70b4b3957fba941501"
</pre><a href="#appendix-C.1.2.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.2.1-3">while using the mocked rng defined in <a href="#mocked-random-scalars" class="auto internal xref">Section 7.1</a>, will result to the following proof value<a href="#appendix-C.1.2.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.2.1-4">
<pre>"ae46046037ed58bfa5771c603895b26b42748a3071a1dc9f8a272a4bc030bc3cda7cfa8
686a6dc8382d728ad96e8d8ceb6ad6b76b99242514e520c43dd7d1a0728ce709d977c4dd
200874e4acffa5b4cc0cbbd37c00d979d8688c636770cc8b428ea9f05ed60cd85fdbd4c2
fd73092e8bfc167c244d6e285ace1deade4fe8ce74fe2993a041e84004fe7d3dd170db76
5f7811a91043c4e75e9231804d577bfa533ec7a44bb6e49eb85089d8df1dc1acfb00ea0c
7bdce5609595099e3cf7559c1715df6ec6982c5d9fffd317955ec3387a9055de28691e39
9b5af14722ae044a506d622e0e6ff0de8d1e4d4f3e9e5fdb01c4dbab02826ac38cb40eb8
0afe7b9d661dc27c94b146fedea19353b70310714932674c1f4bc1edc2c17605749e0bbb
60a77ac62a606d31081ff5a52e1485be257b2c0afa4b676438b0eaa0bd483c66828bc660
32b91fbe8a309408e595e085a1b55e2dd12789e6f522ef5682ac46deb628e03e4eb0303a
f7162f36a119313c3396fe6bca6082238fe396e8c08e607c4"
</pre><a href="#appendix-C.1.2.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="no-presentation-header-valid-proof">
<section id="appendix-C.1.2.2">
            <h5 id="name-no-presentation-header-vali">
<a href="#appendix-C.1.2.2" class="section-number selfRef">C.1.2.2. </a><a href="#name-no-presentation-header-vali" class="section-name selfRef">No Presentation Header Valid Proof</a>
            </h5>
<p id="appendix-C.1.2.2-1">Using the same header, PK, messages and signature as in <a href="#valid-multi-message-all-messages-disclosed-proof">Multi-Message, All Messages Disclosed Proof</a>, with every other message disclosed (messages in index 0, 2, 4 and 6, in that order), with no presentation header, while using the mocked rng defined in <a href="#mocked-random-scalars" class="auto internal xref">Section 7.1</a>, will result to the following proof value<a href="#appendix-C.1.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.2.2-2">
<pre>"ac0424b2a984c55d0061aa61df105f2c882d393494f3f4205d1e73f93c9c76b30664bae
b3dc87f23fbf4035fb0a8e76b851dd39cecce8843e747ccf540f0850a30e1317f8897a56
c2d85bfc1e0b4dba1b0e0322d89aad4feb8b21c414a384a015238f4643b9d075bc6638ec
42d0e285f73c6ca9830be2a5bb48955ddb094751026493147def3cfe2a37bbd89a4536bd
ff6548d891d5206ac6b69c22c6fa8624512caeb80c56dbd79b7a4c8050bc9e782232f959
4087561b10d7f4b0bef708458096637a34962399e918d5adb496faf7c38ded94fe79c3bf
dc53c81f0dcb0da3f1bed0dbfdb6f0310d71d50a63b265e1992dd7d12315bf11da69a889
7d8e33be36f116d58eff998f80e23ad0aad544e93615a5f10f169a3aed7c4d6266191a21
412f4f4d8eb5096a05243b809c4c53a8d237817dfa15a403d8943b968d1216c753fb988f
bcfe9280232c25cac1570873a66d3f4a7e713fb19723f5b99338f053f08fae9f905b10e0
526451968e25569e3779f642a4d2b6bcc1e00be28e2711d1a"
</pre><a href="#appendix-C.1.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="hash-to-scalar-test-vectors">
<section id="appendix-C.1.3">
          <h4 id="name-hash-to-scalar-test-vectors">
<a href="#appendix-C.1.3" class="section-number selfRef">C.1.3. </a><a href="#name-hash-to-scalar-test-vectors" class="section-name selfRef">Hash to Scalar Test Vectors</a>
          </h4>
<p id="appendix-C.1.3-1">Using the following input message,<a href="#appendix-C.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.3-2">
<pre>"9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
</pre><a href="#appendix-C.1.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.3-3">And the default dst defined in <a href="#hash-to-scalar">hash_to_scalar</a>, i.e.,<a href="#appendix-C.1.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.3-4">
<pre>"4242535f424c53313233383147315f584f463a5348414b452d3235365f535357555f524
f5f4832475f484d32535f4832535f"
</pre><a href="#appendix-C.1.3-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1.3-5">We get the following scalar, encoded with I2OSP and represented in big endian order,<a href="#appendix-C.1.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1.3-6">
<pre>"0500031f786fde5326aa9370dd7ffe9535ec7a52cf2b8f432cad5d9acfb73cd3"
</pre><a href="#appendix-C.1.3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="bls12-381-sha-256-ciphersuite">
<section id="appendix-C.2">
        <h3 id="name-bls12-381-sha-256-ciphersui">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-bls12-381-sha-256-ciphersui" class="section-name selfRef">BLS12-381-SHA-256 Ciphersuite</a>
        </h3>
<div id="signature-test-vectors-1">
<section id="appendix-C.2.1">
          <h4 id="name-signature-test-vectors-2">
<a href="#appendix-C.2.1" class="section-number selfRef">C.2.1. </a><a href="#name-signature-test-vectors-2" class="section-name selfRef">Signature Test Vectors</a>
          </h4>
<div id="no-header-valid-signature-1">
<section id="appendix-C.2.1.1">
            <h5 id="name-no-header-valid-signature-2">
<a href="#appendix-C.2.1.1" class="section-number selfRef">C.2.1.1. </a><a href="#name-no-header-valid-signature-2" class="section-name selfRef">No Header Valid Signature</a>
            </h5>
<p id="appendix-C.2.1.1-1">Using the messages defined in <a href="#messages" class="auto internal xref">Section 7.2</a>, with no header, along with the SK and PK values defined in <a href="#key-pair-1" class="auto internal xref">Section 7.4.1</a> results in the following signature value<a href="#appendix-C.2.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.1-2">
<pre>"ae0b1807865598b3884e3e9b110e8faec662050dc9b4d95309d957fd30f6fc24161f6f8
b5680f1f5d1b547be221547915ca665c7b3087a336d5e0c5fcfea62576afd13e563b730e
f6d6d81f9944ab95b"
</pre><a href="#appendix-C.2.1.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="modified-message-signature-1">
<section id="appendix-C.2.1.2">
            <h5 id="name-modified-message-signature-2">
<a href="#appendix-C.2.1.2" class="section-number selfRef">C.2.1.2. </a><a href="#name-modified-message-signature-2" class="section-name selfRef">Modified Message Signature</a>
            </h5>
<p id="appendix-C.2.1.2-1">Using the following header<a href="#appendix-C.2.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.2-2">
<pre>"11223344556677889900aabbccddeeff"
</pre><a href="#appendix-C.2.1.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.1.2-3">And the following message (the first message defined in <a href="#messages" class="auto internal xref">Section 7.2</a>)<a href="#appendix-C.2.1.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.2-4">
<pre>""
</pre><a href="#appendix-C.2.1.2-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.1.2-5">With the following signature<a href="#appendix-C.2.1.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.2-6">
<pre>"88c0eb3bc1d97610c3a66d8a3a73f260f95a3028bccf7fff7d9851e2acd9f3f32fdf58a
5b34d12df8177adf37aa318a20f72be7d37a8e8d8441d1bc0bc75543c681bf061ce7e7f6
091fe78c1cb8af103"
</pre><a href="#appendix-C.2.1.2-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.1.2-7">Along with the PK value as defined in <a href="#key-pair-1" class="auto internal xref">Section 7.4.1</a> as inputs into the Verify operation should fail signature validation due to the message value being different from what was signed.<a href="#appendix-C.2.1.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="extra-unsigned-message-signature-1">
<section id="appendix-C.2.1.3">
            <h5 id="name-extra-unsigned-message-signa">
<a href="#appendix-C.2.1.3" class="section-number selfRef">C.2.1.3. </a><a href="#name-extra-unsigned-message-signa" class="section-name selfRef">Extra Unsigned Message Signature</a>
            </h5>
<p id="appendix-C.2.1.3-1">Using the following header<a href="#appendix-C.2.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.3-2">
<pre>"11223344556677889900aabbccddeeff"
</pre><a href="#appendix-C.2.1.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.1.3-3">And the following messages (the two first messages defined in <a href="#messages" class="auto internal xref">Section 7.2</a>)<a href="#appendix-C.2.1.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.3-4">
<pre>"9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"

"c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
</pre><a href="#appendix-C.2.1.3-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.1.3-5">With the following signature (which is a signature to only the first of the above two messages)<a href="#appendix-C.2.1.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.3-6">
<pre>"88c0eb3bc1d97610c3a66d8a3a73f260f95a3028bccf7fff7d9851e2acd9f3f32fdf58a
5b34d12df8177adf37aa318a20f72be7d37a8e8d8441d1bc0bc75543c681bf061ce7e7f6
091fe78c1cb8af103"
</pre><a href="#appendix-C.2.1.3-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.1.3-7">Along with the PK value as defined in <a href="#key-pair-1" class="auto internal xref">Section 7.4.1</a> as inputs into the Verify operation should fail signature validation due to an additional message being supplied that was not signed.<a href="#appendix-C.2.1.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="missing-message-signature-1">
<section id="appendix-C.2.1.4">
            <h5 id="name-missing-message-signature-2">
<a href="#appendix-C.2.1.4" class="section-number selfRef">C.2.1.4. </a><a href="#name-missing-message-signature-2" class="section-name selfRef">Missing Message Signature</a>
            </h5>
<p id="appendix-C.2.1.4-1">Using the following header<a href="#appendix-C.2.1.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.4-2">
<pre>"11223344556677889900aabbccddeeff"
</pre><a href="#appendix-C.2.1.4-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.1.4-3">And the following messages (the two first messages defined in <a href="#messages" class="auto internal xref">Section 7.2</a>)<a href="#appendix-C.2.1.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.4-4">
<pre>"9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"

"c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
</pre><a href="#appendix-C.2.1.4-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.1.4-5">With the following signature (which is a signature on all the messages defined in <a href="#messages" class="auto internal xref">Section 7.2</a>)<a href="#appendix-C.2.1.4-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.4-6">
<pre>"895cd9c0ccb9aca4de913218655346d718711472f2bf1f3e68916de106a0d93cf2f4720
0819b45920bbda541db2d91480665df253fedab2843055bdc02535d83baddbbb2803ec38
08e074f71f199751e"
</pre><a href="#appendix-C.2.1.4-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.1.4-7">Along with the PK value as defined in <a href="#key-pair-1" class="auto internal xref">Section 7.4.1</a> as inputs into the Verify operation should fail signature validation due to missing messages that were originally present during the signing.<a href="#appendix-C.2.1.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reordered-message-signature-1">
<section id="appendix-C.2.1.5">
            <h5 id="name-reordered-message-signature-2">
<a href="#appendix-C.2.1.5" class="section-number selfRef">C.2.1.5. </a><a href="#name-reordered-message-signature-2" class="section-name selfRef">Reordered Message Signature</a>
            </h5>
<p id="appendix-C.2.1.5-1">Using the following header<a href="#appendix-C.2.1.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.5-2">
<pre>"11223344556677889900aabbccddeeff"
</pre><a href="#appendix-C.2.1.5-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.1.5-3">And the following messages (re-ordering of the messages defined in <a href="#messages" class="auto internal xref">Section 7.2</a>)<a href="#appendix-C.2.1.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.5-4">
<pre>""

"96012096"

"ac55fb33a75909ed"

"d183ddc6e2665aa4e2f088af"

"515ae153e22aae04ad16f759e07237b4"

"496694774c5604ab1b2544eababcf0f53278ff50"

"77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"

"7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"

"c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"

"9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
</pre><a href="#appendix-C.2.1.5-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.1.5-5">With the following signature<a href="#appendix-C.2.1.5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.5-6">
<pre>"895cd9c0ccb9aca4de913218655346d718711472f2bf1f3e68916de106a0d93cf2f4720
0819b45920bbda541db2d91480665df253fedab2843055bdc02535d83baddbbb2803ec38
08e074f71f199751e"
</pre><a href="#appendix-C.2.1.5-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.1.5-7">Along with the PK value as defined in <a href="#key-pair-1" class="auto internal xref">Section 7.4.1</a> as inputs into the Verify operation should fail signature validation due to messages being re-ordered from the order in which they were signed.<a href="#appendix-C.2.1.5-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wrong-public-key-signature-1">
<section id="appendix-C.2.1.6">
            <h5 id="name-wrong-public-key-signature-2">
<a href="#appendix-C.2.1.6" class="section-number selfRef">C.2.1.6. </a><a href="#name-wrong-public-key-signature-2" class="section-name selfRef">Wrong Public Key Signature</a>
            </h5>
<p id="appendix-C.2.1.6-1">Using the following header<a href="#appendix-C.2.1.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.6-2">
<pre>"11223344556677889900aabbccddeeff"
</pre><a href="#appendix-C.2.1.6-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.1.6-3">And the messages as defined in <a href="#messages" class="auto internal xref">Section 7.2</a> and with the following signature<a href="#appendix-C.2.1.6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.6-4">
<pre>"895cd9c0ccb9aca4de913218655346d718711472f2bf1f3e68916de106a0d93cf2f4720
0819b45920bbda541db2d91480665df253fedab2843055bdc02535d83baddbbb2803ec38
08e074f71f199751e"
</pre><a href="#appendix-C.2.1.6-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.1.6-5">Along with the PK value as defined in <a href="#key-pair-1" class="auto internal xref">Section 7.4.1</a> as inputs into the Verify operation should fail signature validation due to public key used to verify is in-correct.<a href="#appendix-C.2.1.6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wrong-header-signature-1">
<section id="appendix-C.2.1.7">
            <h5 id="name-wrong-header-signature-2">
<a href="#appendix-C.2.1.7" class="section-number selfRef">C.2.1.7. </a><a href="#name-wrong-header-signature-2" class="section-name selfRef">Wrong Header Signature</a>
            </h5>
<p id="appendix-C.2.1.7-1">Using the following header<a href="#appendix-C.2.1.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.7-2">
<pre>"ffeeddccbbaa00998877665544332211"
</pre><a href="#appendix-C.2.1.7-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.1.7-3">And the messages as defined in <a href="#messages" class="auto internal xref">Section 7.2</a> and with the following signature<a href="#appendix-C.2.1.7-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.1.7-4">
<pre>"895cd9c0ccb9aca4de913218655346d718711472f2bf1f3e68916de106a0d93cf2f4720
0819b45920bbda541db2d91480665df253fedab2843055bdc02535d83baddbbb2803ec38
08e074f71f199751e"
</pre><a href="#appendix-C.2.1.7-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.1.7-5">Along with the PK value as defined in <a href="#key-pair-1" class="auto internal xref">Section 7.4.1</a> as inputs into the Verify operation should fail signature validation due to header value being modified from what was originally signed.<a href="#appendix-C.2.1.7-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="proof-test-vectors-1">
<section id="appendix-C.2.2">
          <h4 id="name-proof-test-vectors-2">
<a href="#appendix-C.2.2" class="section-number selfRef">C.2.2. </a><a href="#name-proof-test-vectors-2" class="section-name selfRef">Proof Test Vectors</a>
          </h4>
<div id="no-header-valid-proof-1">
<section id="appendix-C.2.2.1">
            <h5 id="name-no-header-valid-proof-2">
<a href="#appendix-C.2.2.1" class="section-number selfRef">C.2.2.1. </a><a href="#name-no-header-valid-proof-2" class="section-name selfRef">No Header Valid Proof</a>
            </h5>
<p id="appendix-C.2.2.1-1">Using messages, PK and signature as in <a href="#no-header-valid-signature-1">No Header Valid Signature</a>, with only every other messages disclosed (messages in index 0, 2, 4 and 6, in that order), with no header and the following presentation header<a href="#appendix-C.2.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.2.1-2">
<pre>"bed231d880675ed101ead304512e043ade9958dd0241ea70b4b3957fba941501"
</pre><a href="#appendix-C.2.2.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.2.1-3">while using the mocked rng defined in <a href="#mocked-random-scalars" class="auto internal xref">Section 7.1</a>, will result to the following proof value<a href="#appendix-C.2.2.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.2.1-4">
<pre>"89cefce40c3dc7adcc8bcd07d92767d0f0397d0e120511b58b8403b531fa573987003fd
235bdfe6fb5e9da937774c7799397bc951cd4030a78f8dae7820bfa150a243d74c3aa34d
af6299dc0baaf7796705e952e2c8ac7d37c69e91db85012d61f3387f096a022361972d6a
fd2c095eeb4adc95f72cfb739539f27f1917c7cc80fba233fd9eef52196cc31183d7c416
8e6b87a66b249225398c31e2950e3e24420d3af3eeee3308933a343310cf822287dc95b8
6eb5716e8ff23cc52c980d41218bdaeff521a242e5330daee27a1a499ac1a20b0c39477c
ebf4936d0ec2b95e0384b80bba24febc527b0b640481df2125b58f85708590838ee32789
ce1c755a6150ce6bf0650bff3dfff61eae16e88916f9869d75c7884554ea517f8dec320c
011d211b1ec05073238d7949fe6d9ff6f729c475bbfc5a21c6fa6d35df92f79d43c3f78b
cd3cb4c6e6de2ac27108316bd8d751fb445c5f6b4e6e104b227362efe3f5f2904b6100e0
1b6cf94d9d6c5501fbbfd2e5e57c2dcb1cf117c41eedcda57"
</pre><a href="#appendix-C.2.2.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="no-presentation-header-valid-proof-1">
<section id="appendix-C.2.2.2">
            <h5 id="name-no-presentation-header-valid">
<a href="#appendix-C.2.2.2" class="section-number selfRef">C.2.2.2. </a><a href="#name-no-presentation-header-valid" class="section-name selfRef">No Presentation Header Valid Proof</a>
            </h5>
<p id="appendix-C.2.2.2-1">Using the same header, PK, messages and signature as in <a href="#valid-multi-message-all-messages-disclosed-proof-1">Multi-Message, All Messages Disclosed Proof</a>, with every other message disclosed (messages in index 0, 2, 4 and 6, in that order), with no presentation header, while using the mocked rng defined in <a href="#mocked-random-scalars" class="auto internal xref">Section 7.1</a>, will result to the following proof value<a href="#appendix-C.2.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.2.2-2">
<pre>"812a204f66c9084feed7383894d910f2c17399b3c4b4bed05660921de8539f5042318c3
56609496a6ca0a26626661be78ca723b7182ccd314924b93a3997654fcd77e29e3847dc8
81f422a751017705173ec094d2997221e134710d4fff1bd332fd2f270e96b6b8de89b2ff
f1294dcd5bd0e1eb314b199f7fb7f5702839f409e167c6a78eb3a57a08a7996330f83ac1
67d51c57f4ebabea87ad8e08b4b3875926d9d2427df59abd2e2befe32774b03668a5080c
54412f81c4cbf47571b15a35c4f93bd38805c3224ca6c4d2f387c28288e8fffb0ab0c43c
db860f31c739b3091192268789d3da05b97d277ab91699a209c97e9057a6cf66c9d4d311
ea09c680d4aa2485bfdbaa7ee954a2e0b4f6ea542eda44a1adf2b19f63332b9de00f46c5
33f1c696bc8b4aea5cc56b0cf12ecdba434b36324d754eabf1734e6c3301f300435797ed
cb007eae6ef75bc5d5500a1ce74ba8f4e0c5c8836f42371c2c469265909585f44695f088
ea39bda2317224f47208c7f77570deae84efea007c14f18ef"
</pre><a href="#appendix-C.2.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="hash-to-scalar-test-vectors-1">
<section id="appendix-C.2.3">
          <h4 id="name-hash-to-scalar-test-vectors-2">
<a href="#appendix-C.2.3" class="section-number selfRef">C.2.3. </a><a href="#name-hash-to-scalar-test-vectors-2" class="section-name selfRef">Hash to Scalar Test Vectors</a>
          </h4>
<p id="appendix-C.2.3-1">Using the following input message,<a href="#appendix-C.2.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.3-2">
<pre>"9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
</pre><a href="#appendix-C.2.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.3-3">And the default dst defined in <a href="#hash-to-scalar">hash_to_scalar</a>, i.e.,<a href="#appendix-C.2.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.3-4">
<pre>"4242535f424c53313233383147315f584d443a5348412d3235365f535357555f524f5f4
832475f484d32535f4832535f"
</pre><a href="#appendix-C.2.3-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2.3-5">We get the following scalar, encoded with I2OSP and represented in big endian order,<a href="#appendix-C.2.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2.3-6">
<pre>"0f90cbee27beb214e6545becb8404640d3612da5d6758dffeccd77ed7169807c"
</pre><a href="#appendix-C.2.3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="proof-generation-and-verification-algorithmic-explanation">
<section id="appendix-D">
      <h2 id="name-proof-generation-and-verifi">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-proof-generation-and-verifi" class="section-name selfRef">Proof Generation and Verification Algorithmic Explanation</a>
      </h2>
<p id="appendix-D-1">The following section provides a high level explanation of how the ProofGen and ProofVerify operations work. ProofGen can be categorized as a generic non-interactive zero-knowledge proof-of-knowledge (<code>nizk</code>). A <code>nizk</code> works as follows; Assume the group points <code>J_0</code>, <code>J_1</code>, ..., <code>J_n</code> and the exponents <code>e_0</code>, <code>e_1</code>, ..., <code>e_n</code>. Assume also that all the group point are publicly known, while only the exponent <code>e_0</code> is known to the verifier and the exponents <code>e_1</code>, ..., <code>e_n</code> are known only by the prover. The <code>nizk</code> can be used to prove a relationship of the form,<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D-2">
<pre>J_O * e_0 = J_1 * e_1 + J_2 * e_2 + ... + J_n * e_n
</pre><a href="#appendix-D-2" class="pilcrow">¶</a>
</div>
<p id="appendix-D-3">While revealing nothing about the secret exponents (i.e., <code>e_1</code>, ..., <code>e_n</code>).<a href="#appendix-D-3" class="pilcrow">¶</a></p>
<p id="appendix-D-4">For BBS, let the prover be in possession of a BBS signature <code>(A, e)</code> on messages <code>msg_1, ..., msg_L</code> and a <code>domain</code> value (see <a href="#signature-generation-sign">Sign</a>). Let <code>A = B * (1/(e + SK))</code> where <code>SK</code> the signer's secret key and,<a href="#appendix-D-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D-5">
<pre>[1]    B = P1 + Q_1 * domain + H_1 * msg_1 + ... + H_L * msg_L
</pre><a href="#appendix-D-5" class="pilcrow">¶</a>
</div>
<p id="appendix-D-6">Let <code>(i1, ..., iR)</code> be the indexes of the messages the prover wants to disclose and <code>(j1, ..., jU)</code> be the indexes corresponding to undisclosed messages (i.e., <code>(j1, ..., jU) = range(1, L) \ (i1, ..., iR)</code>). To prove knowledge of a signature on the disclosed messages, work as follows;<a href="#appendix-D-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-7.1">
          <p id="appendix-D-7.1.1">Prove possession of a valid signature. As defined above, a signature <code>(A, e)</code>, on messages <code>msg_1, ..., msg_L</code> is valid, if <code>A = B * 1/(e + SK)</code>, where <code>B</code> as in [1]. However we cannot reveal neither <code>A</code>, <code>e</code> nor <code>B</code> to the verifier (signature is uniquely identifiable and <code>B</code> will reveal information about the signed messages, even the undisclosed ones). To get around this, we need to hide the signature <code>(A, e)</code> and the value of <code>B</code>, in a way that will allow proving knowledge of such ellements with the aformentioned relationship (i.e., that <code>A = B * 1/(e + SK)</code>), without revealing their value. We do this by randomizing them. To do that, take uniformly random <code>r1</code> in <code>[1, r-1]</code>, and calculate,<a href="#appendix-D-7.1.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D-7.1.2">
<pre>[2]    Abar = A * r1,
[3]    Bbar = B * r1 + Abar * (-e)
</pre><a href="#appendix-D-7.1.2" class="pilcrow">¶</a>
</div>
<p id="appendix-D-7.1.3">The values <code>(Abar, Bbar)</code> will be part of the proof and are used to prove possession of a BBS signature, without revealing the signature itself. Note that; if <code>Abar</code> and <code>Bbar</code> are constructed using a valid BBS signatures as above, then <code>Abar * SK = Bbar =&gt; e(Abar, PK) = e(Bbar, BP2)</code> where <code>SK</code>, <code>PK</code> the signer's secret and public key and <code>BP2</code> the base element in <code>G2</code> (used to create the signer’s <code>PK</code>, see <a href="#public-key" class="auto internal xref">Section 3.3.2</a>). This last equation is something that the verifier can check. This also serves to bind the proof to the signer's <code>PK</code>.<a href="#appendix-D-7.1.3" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-7.2">
          <p id="appendix-D-7.2.1">Prove that the disclosed messages are signed by that signature. Set the following,<a href="#appendix-D-7.2.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D-7.2.2">
<pre>[4]    D = P1 + Q_1 * domain + H_i1 * msg_i1 + ... + H_iR * msg_iR
[5]    r1' = r1 ^ -1 mod r
</pre><a href="#appendix-D-7.2.2" class="pilcrow">¶</a>
</div>
<p id="appendix-D-7.2.3">If the <code>Abar</code> and <code>Bbar</code> values are constructed using a valid BBS signature as in [2] and [3], then the following equation will hold,<a href="#appendix-D-7.2.3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D-7.2.4">
<pre>[6]    D = Bbar * r1' + Abar * (e * r1') - H_ji * msg_j1 - ...
                                                 ... - H_jU * msg_jU
</pre><a href="#appendix-D-7.2.4" class="pilcrow">¶</a>
</div>
</li>
      </ul>
<p id="appendix-D-8">Note that the verifier will know the elements in the left side of [6] (i.e., <code>D</code>, or rather they will know all the values needed to calculate <code>D</code>, as it depends on the public <code>doamin</code> value and the disclosed messages) but not the exponents in the right side (i.e., <code>r1'</code>, <code>e</code> and the undisclosed messages: <code>msg_j1, ..., msg_jU</code>). However, using a <code>nizk</code>, the prover can convince the verifier that they (the prover) know the exponents that satisfy that equation, without disclosing them.<a href="#appendix-D-8" class="pilcrow">¶</a></p>
<p id="appendix-D-9">If the above equation ([6]) holds, and <code>e(Abar, PK) = e(Bbar, BP2)</code>, one could solve [6] to get <code>B = Bbar * r1' + Abar * e * r1'</code> (where <code>B</code> as in [1]). Note that <code>B</code> will also contain the disclosed messages. Then, using the properties of pairings, one can see that,<a href="#appendix-D-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D-10">
<pre>e(Abar * r1', PK + BP2 * e) = (B, BP2)
</pre><a href="#appendix-D-10" class="pilcrow">¶</a>
</div>
<p id="appendix-D-11">which is exactly what <a href="#signature-verification-verify">Verify</a> checks for <code>A = Abar * r1'</code>. So seting <code>A = Abar * r1'</code>, the values <code>A</code>, <code>e</code>, <code>B</code> will format a valid BBS signature. Note that the verifier doesn't know <code>r1'</code>, <code>e</code> or all the values to compute <code>B</code>. However, they know that the prover knows them, and as we saw above, knowledge of those values means knowledge of a valid signature on (among others) the disclosed messages.<a href="#appendix-D-11" class="pilcrow">¶</a></p>
<p id="appendix-D-12">To sum up; in order to validate the proof, a verifier checks that <code>e(Abar, PK) = e(Bbar, BP2)</code> and verifies the <code>nizk</code>. Validating the proof, will guarantee the authenticity and integrity of the disclosed messages, as well as knowledge of the undisclosed messages and of the signature.<a href="#appendix-D-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-E">
      <h2 id="name-document-history">
<a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-E-1">-00<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-2.1">Initial version<a href="#appendix-E-2.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-3">-01<a href="#appendix-E-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-4.1">Populated fixtures<a href="#appendix-E-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-4.2">Added SHA-256 based ciphersuite<a href="#appendix-E-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-4.3">Fixed typo in ProofVerify<a href="#appendix-E-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-4.4">Clarify ASCII string usage in DST<a href="#appendix-E-4.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-4.5">Added MapMessageToScalar test vectors<a href="#appendix-E-4.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-4.6">Fix typo in ciphersuite name<a href="#appendix-E-4.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-5">-02<a href="#appendix-E-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-6.1">Variety of editiorial clarifications<a href="#appendix-E-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-6.2">Clarified integer endianness<a href="#appendix-E-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-6.3">Revised the encode for hash operation<a href="#appendix-E-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-6.4">Shifted to using CSPRNG instead of PRF<a href="#appendix-E-6.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-6.5">Removed total number of messages from proof verify operation<a href="#appendix-E-6.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-6.6">Added deterministic proof fixtures<a href="#appendix-E-6.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-6.7">Shifted to multiple CSPRNG calls to calculate random elements, instead of expand_message<a href="#appendix-E-6.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-6.8">Updated hash<em>to</em>scalar to a single output<a href="#appendix-E-6.8" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-7">-03<a href="#appendix-E-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-8.1">Updated core operation based on new <a href="https://eprint.iacr.org/2023/275">academic paper</a><a href="#appendix-E-8.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-8.2">Variety of editorial updates<a href="#appendix-E-8.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-8.3">Updated exception and error handling<a href="#appendix-E-8.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-8.4">Added extension point for the operation with which the generators are created, allowing ciphersuites to define different operations for creating the generator points.<a href="#appendix-E-8.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-8.5">Added extension point for the operation with which the input messages are mapped to scalar values, allowing ciphersuites to define different message-to-scalar mapping operations<a href="#appendix-E-8.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-8.6">Added signature/proof fixtures with an empty header or an empty presentation header input<a href="#appendix-E-8.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-8.7">Updated the fixtures to use variable length messages (one of which is now the empty message "")<a href="#appendix-E-8.7" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tobias Looker</span></div>
<div dir="auto" class="left"><span class="org">MATTR</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tobias.looker@mattr.global" class="email">tobias.looker@mattr.global</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Vasilis Kalos</span></div>
<div dir="auto" class="left"><span class="org">MATTR</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:vasilis.kalos@mattr.global" class="email">vasilis.kalos@mattr.global</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Andrew Whitehead</span></div>
<div dir="auto" class="left"><span class="org">Portage</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:andrew.whitehead@portagecybertech.com" class="email">andrew.whitehead@portagecybertech.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mike Lodder</span></div>
<div dir="auto" class="left"><span class="org">CryptID</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:redmike7@gmail.com" class="email">redmike7@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
